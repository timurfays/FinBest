[0m10:19:47.212751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc4bebccd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc4bebccfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc4bebccc10>]}


============================== 10:19:47.217361 | 61f78341-bde9-47f9-8b89-acab2a052553 ==============================
[0m10:19:47.217361 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:19:47.217924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:19:47.218284 [info ] [MainThread]: dbt version: 1.5.11
[0m10:19:47.218617 [info ] [MainThread]: python version: 3.7.17
[0m10:19:47.218990 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:19:47.219311 [info ] [MainThread]: os info: Linux-6.8.0-57-generic-x86_64-with-debian-11.7
[0m10:19:47.219627 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m10:19:47.219948 [info ] [MainThread]: Using dbt_project.yml file at /dbt_project/dbt_project.yml
[0m10:19:47.220258 [info ] [MainThread]: Configuration:
[0m10:19:47.262381 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:19:47.290028 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:19:47.290891 [info ] [MainThread]: Required dependencies:
[0m10:19:47.291556 [debug] [MainThread]: Executing "git --help"
[0m10:19:47.303973 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:19:47.305056 [info ] [MainThread]: Connection:
[0m10:19:47.305757 [info ] [MainThread]:   host: postgres
[0m10:19:47.306368 [info ] [MainThread]:   port: 5432
[0m10:19:47.306936 [info ] [MainThread]:   user: finbest
[0m10:19:47.307469 [info ] [MainThread]:   database: finbest
[0m10:19:47.308035 [info ] [MainThread]:   schema: mart
[0m10:19:47.308552 [info ] [MainThread]:   search_path: None
[0m10:19:47.309092 [info ] [MainThread]:   keepalives_idle: 0
[0m10:19:47.309614 [info ] [MainThread]:   sslmode: None
[0m10:19:47.310912 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m10:19:47.312147 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:19:47.312736 [debug] [MainThread]: Using postgres connection "debug"
[0m10:19:47.313243 [debug] [MainThread]: On debug: select 1 as id
[0m10:19:47.313653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:47.324719 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:19:47.326235 [debug] [MainThread]: On debug: Close
[0m10:19:47.326671 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:19:47.327322 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:19:47.327982 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m10:19:47.329388 [debug] [MainThread]: Command `dbt debug` failed at 10:19:47.329063 after 0.12 seconds
[0m10:19:47.330012 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:19:47.330564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc4bebccf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc4bede9e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc4bec04190>]}
[0m10:19:47.331221 [debug] [MainThread]: Flushing usage events
[0m10:19:51.484439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdf1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdf1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdf11d0>]}


============================== 10:19:51.488995 | fb777072-1891-491c-bfbd-c62cc1cb11be ==============================
[0m10:19:51.488995 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:19:51.489576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:19:51.546846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbe18690>]}
[0m10:19:51.561896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbe18350>]}
[0m10:19:51.562662 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m10:19:51.575256 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:19:51.575830 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:19:51.576399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad92cde10>]}
[0m10:19:52.131855 [debug] [MainThread]: 1699: static parser successfully parsed mart/fact_client_balance.sql
[0m10:19:52.144423 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_clients.sql
[0m10:19:52.148088 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions.sql
[0m10:19:52.151753 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_rates.sql
[0m10:19:52.155325 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_daily_transactions.sql
[0m10:19:52.220122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad7acad90>]}
[0m10:19:52.224933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad7a73510>]}
[0m10:19:52.225368 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:19:52.225730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad7a737d0>]}
[0m10:19:52.226979 [info ] [MainThread]: 
[0m10:19:52.227679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:52.229546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m10:19:52.240091 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m10:19:52.240456 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m10:19:52.240693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:52.246259 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:19:52.247482 [debug] [ThreadPool]: On list_finbest: Close
[0m10:19:52.249346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m10:19:52.256050 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m10:19:52.256515 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m10:19:52.256828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:52.261262 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.261613 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m10:19:52.261877 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m10:19:52.266335 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:19:52.267591 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m10:19:52.267981 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m10:19:52.273800 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:52.274191 [debug] [MainThread]: On master: BEGIN
[0m10:19:52.274441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:52.278985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.279338 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:52.279633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:52.284160 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:19:52.285260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdfb510>]}
[0m10:19:52.285663 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:52.286024 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:52.286273 [debug] [MainThread]: On master: BEGIN
[0m10:19:52.286612 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.286875 [debug] [MainThread]: On master: COMMIT
[0m10:19:52.287109 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:52.287329 [debug] [MainThread]: On master: COMMIT
[0m10:19:52.287617 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.287864 [debug] [MainThread]: On master: Close
[0m10:19:52.288401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:52.288802 [info ] [MainThread]: 
[0m10:19:52.293860 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m10:19:52.294321 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m10:19:52.295345 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m10:19:52.294898 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m10:19:52.295994 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m10:19:52.296561 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m10:19:52.297349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m10:19:52.298190 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m10:19:52.299198 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m10:19:52.299755 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m10:19:52.300111 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m10:19:52.300593 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m10:19:52.308044 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m10:19:52.309843 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m10:19:52.311425 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m10:19:52.312287 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 10:19:52.301008 => 10:19:52.312090
[0m10:19:52.312633 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m10:19:52.313064 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 10:19:52.308411 => 10:19:52.312865
[0m10:19:52.313571 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 10:19:52.310123 => 10:19:52.313305
[0m10:19:52.324356 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m10:19:52.329997 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m10:19:52.377680 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m10:19:52.378321 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m10:19:52.383203 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m10:19:52.384373 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:19:52.384778 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:19:52.385098 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m10:19:52.385486 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:19:52.385883 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m10:19:52.386175 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:19:52.386531 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m10:19:52.386901 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:19:52.387347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:52.391689 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.392161 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.392630 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:19:52.392994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.393300 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:19:52.393655 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m10:19:52.393993 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:19:52.394330 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m10:19:52.394667 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m10:19:52.398126 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m10:19:52.398581 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m10:19:52.404076 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:19:52.408345 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:19:52.409421 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:19:52.412380 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:19:52.412780 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m10:19:52.413213 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m10:19:52.413610 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m10:19:52.414315 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:19:52.414653 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:19:52.440616 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m10:19:52.440168 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m10:19:52.441162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:19:52.441545 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:19:52.441919 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:19:52.443825 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m10:19:52.444265 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m10:19:52.444677 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m10:19:52.445080 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:19:52.445582 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m10:19:52.446679 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.451433 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:19:52.451819 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.452189 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.452557 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m10:19:52.454737 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:19:52.457058 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:19:52.457495 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m10:19:52.457860 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:19:52.458225 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m10:19:52.459736 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 10:19:52.345079 => 10:19:52.459544
[0m10:19:52.460207 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m10:19:52.460563 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:19:52.460952 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:19:52.461554 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad7903290>]}
[0m10:19:52.462944 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 10:19:52.313965 => 10:19:52.462775
[0m10:19:52.464264 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 10:19:52.370660 => 10:19:52.464118
[0m10:19:52.464771 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.16s]
[0m10:19:52.465297 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m10:19:52.465660 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m10:19:52.466213 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m10:19:52.467075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad75d0fd0>]}
[0m10:19:52.467719 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad7a83850>]}
[0m10:19:52.468488 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.17s]
[0m10:19:52.469637 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m10:19:52.468999 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.17s]
[0m10:19:52.470323 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m10:19:52.470893 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m10:19:52.471392 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m10:19:52.472219 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m10:19:52.472543 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m10:19:52.475293 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m10:19:52.475885 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 10:19:52.472749 => 10:19:52.475691
[0m10:19:52.476288 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m10:19:52.480275 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m10:19:52.480811 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:19:52.481193 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m10:19:52.481478 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:19:52.486002 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.486443 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:19:52.486782 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m10:19:52.492943 [debug] [Thread-4  ]: SQL status: SELECT 586 in 0.0 seconds
[0m10:19:52.497659 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:19:52.498162 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m10:19:52.498786 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:19:52.500879 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m10:19:52.501246 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:19:52.501559 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m10:19:52.502639 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.505370 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:19:52.505988 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m10:19:52.506560 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:19:52.507801 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 10:19:52.476503 => 10:19:52.507635
[0m10:19:52.508139 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m10:19:52.508750 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad783c0d0>]}
[0m10:19:52.509325 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 586[0m in 0.04s]
[0m10:19:52.509947 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m10:19:52.510501 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m10:19:52.510910 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m10:19:52.511546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m10:19:52.511845 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m10:19:52.515029 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m10:19:52.515668 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 10:19:52.512040 => 10:19:52.515470
[0m10:19:52.516014 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m10:19:52.520194 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m10:19:52.520722 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:19:52.521037 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m10:19:52.521312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:52.525930 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.526375 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:19:52.526727 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m10:19:52.531810 [debug] [Thread-1  ]: SQL status: SELECT 586 in 0.0 seconds
[0m10:19:52.534893 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:19:52.535311 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m10:19:52.535877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:19:52.538305 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m10:19:52.538911 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:19:52.539290 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m10:19:52.540434 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.542881 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:19:52.543291 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m10:19:52.543718 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:19:52.544996 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 10:19:52.516222 => 10:19:52.544831
[0m10:19:52.545338 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m10:19:52.545966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb777072-1891-491c-bfbd-c62cc1cb11be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dad79e7690>]}
[0m10:19:52.546487 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 586[0m in 0.03s]
[0m10:19:52.547080 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m10:19:52.598942 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:52.599380 [debug] [MainThread]: On master: BEGIN
[0m10:19:52.599661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:52.604111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:52.604498 [debug] [MainThread]: On master: COMMIT
[0m10:19:52.604754 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:52.605016 [debug] [MainThread]: On master: COMMIT
[0m10:19:52.605341 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:52.605606 [debug] [MainThread]: On master: Close
[0m10:19:52.606218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:52.606495 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m10:19:52.606749 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m10:19:52.607005 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m10:19:52.607218 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m10:19:52.607487 [info ] [MainThread]: 
[0m10:19:52.607843 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:19:52.608948 [debug] [MainThread]: Command end result
[0m10:19:52.613492 [info ] [MainThread]: 
[0m10:19:52.614084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:52.614463 [info ] [MainThread]: 
[0m10:19:52.614835 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:19:52.615415 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:52.615323 after 1.14 seconds
[0m10:19:52.615718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdf1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdf1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dadbdf1310>]}
[0m10:19:52.616087 [debug] [MainThread]: Flushing usage events
[0m10:21:42.113311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a511f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a511f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a511f210>]}


============================== 10:21:42.119006 | ff6a8f9b-4a8a-45fc-b683-6c95104cab84 ==============================
[0m10:21:42.119006 [info ] [MainThread]: Running with dbt=1.5.11
[0m10:21:42.119544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:21:42.173633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a5151710>]}
[0m10:21:42.188139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a513dd50>]}
[0m10:21:42.188842 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m10:21:42.198994 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m10:21:42.214812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:42.215239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:42.220626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a2548710>]}
[0m10:21:42.225477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a2596ed0>]}
[0m10:21:42.226048 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:21:42.226386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a2596d10>]}
[0m10:21:42.227680 [info ] [MainThread]: 
[0m10:21:42.228387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:42.229671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m10:21:42.239777 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m10:21:42.240235 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m10:21:42.240595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:42.246187 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:21:42.247537 [debug] [ThreadPool]: On list_finbest: Close
[0m10:21:42.249292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m10:21:42.254682 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m10:21:42.255129 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m10:21:42.255546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:42.260113 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.260554 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m10:21:42.260948 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m10:21:42.262896 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:21:42.264084 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m10:21:42.264504 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m10:21:42.269772 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:42.270221 [debug] [MainThread]: On master: BEGIN
[0m10:21:42.270557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:42.274994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.275453 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:42.275857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:42.279736 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:21:42.280790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a0cb0dd0>]}
[0m10:21:42.281294 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:42.281803 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:42.282190 [debug] [MainThread]: On master: BEGIN
[0m10:21:42.282784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.283165 [debug] [MainThread]: On master: COMMIT
[0m10:21:42.283503 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:42.283831 [debug] [MainThread]: On master: COMMIT
[0m10:21:42.284288 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.284679 [debug] [MainThread]: On master: Close
[0m10:21:42.285338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:21:42.285688 [info ] [MainThread]: 
[0m10:21:42.290465 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m10:21:42.291025 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m10:21:42.291665 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m10:21:42.292314 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m10:21:42.293031 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m10:21:42.293739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m10:21:42.294292 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m10:21:42.295059 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m10:21:42.295516 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m10:21:42.296278 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m10:21:42.296753 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m10:21:42.303218 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m10:21:42.303686 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m10:21:42.306019 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m10:21:42.307753 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m10:21:42.308616 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 10:21:42.297082 => 10:21:42.308385
[0m10:21:42.309113 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m10:21:42.314804 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 10:21:42.306489 => 10:21:42.314568
[0m10:21:42.315250 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 10:21:42.304146 => 10:21:42.315052
[0m10:21:42.330925 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m10:21:42.346705 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m10:21:42.356359 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m10:21:42.360629 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m10:21:42.364577 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m10:21:42.365480 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:21:42.365990 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:21:42.366499 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m10:21:42.367069 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:21:42.367497 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m10:21:42.368024 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:21:42.368501 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m10:21:42.368987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:21:42.369524 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:21:42.373843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.374735 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:21:42.375166 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.375724 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.376205 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m10:21:42.376883 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:21:42.377355 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:21:42.377854 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m10:21:42.378297 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m10:21:42.381260 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m10:21:42.381858 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m10:21:42.387526 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:21:42.392351 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:21:42.394017 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:21:42.397463 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:21:42.397982 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m10:21:42.398457 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m10:21:42.398982 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m10:21:42.399762 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.400214 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.400705 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.403684 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:21:42.406478 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:21:42.409896 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:21:42.410727 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m10:21:42.411258 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m10:21:42.411632 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m10:21:42.412878 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.413438 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.424243 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.441568 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m10:21:42.443881 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m10:21:42.447348 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m10:21:42.447855 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:21:42.448335 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:21:42.448882 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:21:42.449299 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m10:21:42.449756 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m10:21:42.450283 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m10:21:42.451759 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.452178 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.452665 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.457724 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m10:21:42.460311 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m10:21:42.462635 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m10:21:42.463165 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m10:21:42.463603 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m10:21:42.463978 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m10:21:42.466278 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:21:42.467913 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 10:21:42.356847 => 10:21:42.467732
[0m10:21:42.468386 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:21:42.468857 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m10:21:42.469317 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:21:42.470644 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 10:21:42.309477 => 10:21:42.470491
[0m10:21:42.471384 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a0c8eb90>]}
[0m10:21:42.472841 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 10:21:42.347146 => 10:21:42.472659
[0m10:21:42.473322 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m10:21:42.473967 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.18s]
[0m10:21:42.474437 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m10:21:42.475246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a0c39d90>]}
[0m10:21:42.476024 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m10:21:42.476870 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m10:21:42.477607 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a0c33650>]}
[0m10:21:42.478420 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m10:21:42.479042 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.18s]
[0m10:21:42.479731 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m10:21:42.480293 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m10:21:42.480777 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m10:21:42.481493 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m10:21:42.481907 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m10:21:42.484770 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m10:21:42.485445 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 10:21:42.482199 => 10:21:42.485266
[0m10:21:42.485878 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m10:21:42.490036 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m10:21:42.490649 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:21:42.491080 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m10:21:42.491456 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:21:42.495928 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.496407 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:21:42.496814 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m10:21:42.500849 [debug] [Thread-4  ]: SQL status: SELECT 586 in 0.0 seconds
[0m10:21:42.504903 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:21:42.505395 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m10:21:42.506101 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.540649 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:21:42.541119 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m10:21:42.541949 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.544135 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m10:21:42.544587 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:21:42.544995 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m10:21:42.546399 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.548975 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m10:21:42.549396 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m10:21:42.551333 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:21:42.552650 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 10:21:42.486179 => 10:21:42.552501
[0m10:21:42.553109 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m10:21:42.553843 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a255c790>]}
[0m10:21:42.554514 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 586[0m in 0.07s]
[0m10:21:42.555107 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m10:21:42.555767 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m10:21:42.556328 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m10:21:42.556998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m10:21:42.557452 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m10:21:42.560201 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m10:21:42.560888 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 10:21:42.557747 => 10:21:42.560686
[0m10:21:42.561328 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m10:21:42.565421 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m10:21:42.566150 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:21:42.566605 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m10:21:42.567034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:21:42.572123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.572871 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:21:42.573509 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m10:21:42.578978 [debug] [Thread-1  ]: SQL status: SELECT 586 in 0.0 seconds
[0m10:21:42.582220 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:21:42.582692 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m10:21:42.583454 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.586264 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:21:42.586741 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m10:21:42.587435 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:21:42.589563 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m10:21:42.590004 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:21:42.590378 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m10:21:42.591613 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.594299 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m10:21:42.594787 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m10:21:42.596818 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:21:42.598202 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 10:21:42.561630 => 10:21:42.598037
[0m10:21:42.598621 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m10:21:42.599329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6a8f9b-4a8a-45fc-b683-6c95104cab84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a0338c10>]}
[0m10:21:42.599950 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 586[0m in 0.04s]
[0m10:21:42.600519 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m10:21:42.695666 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:42.696247 [debug] [MainThread]: On master: BEGIN
[0m10:21:42.696657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:42.702001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:21:42.702506 [debug] [MainThread]: On master: COMMIT
[0m10:21:42.702895 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:42.703260 [debug] [MainThread]: On master: COMMIT
[0m10:21:42.703678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:21:42.704055 [debug] [MainThread]: On master: Close
[0m10:21:42.704740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:42.705133 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m10:21:42.705481 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m10:21:42.705816 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m10:21:42.706223 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m10:21:42.706671 [info ] [MainThread]: 
[0m10:21:42.707045 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:21:42.708378 [debug] [MainThread]: Command end result
[0m10:21:42.714744 [info ] [MainThread]: 
[0m10:21:42.715442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:42.715836 [info ] [MainThread]: 
[0m10:21:42.716326 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:21:42.716869 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:42.716771 after 0.61 seconds
[0m10:21:42.717277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a033b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a033b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7221a02c8e90>]}
[0m10:21:42.717681 [debug] [MainThread]: Flushing usage events
[0m13:30:40.007553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e40410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e402d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e40990>]}


============================== 13:30:40.028038 | d947148e-1ae8-41e9-9b75-bd1194273c47 ==============================
[0m13:30:40.028038 [info ] [MainThread]: Running with dbt=1.5.11
[0m13:30:40.028551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'debug': 'True', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:30:40.081586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e6f710>]}
[0m13:30:40.096597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e40ad0>]}
[0m13:30:40.097540 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m13:30:40.107893 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m13:30:40.132009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:40.132467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:40.138210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24f5e5410>]}
[0m13:30:40.143018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24f301a50>]}
[0m13:30:40.143557 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:30:40.143914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24f301b90>]}
[0m13:30:40.145196 [info ] [MainThread]: 
[0m13:30:40.145835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:40.147077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m13:30:40.158139 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m13:30:40.158894 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m13:30:40.159261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:40.164905 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:30:40.166263 [debug] [ThreadPool]: On list_finbest: Close
[0m13:30:40.167937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m13:30:40.173686 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m13:30:40.174120 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m13:30:40.174457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:40.178810 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.179251 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m13:30:40.179626 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m13:30:40.183157 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:30:40.184409 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m13:30:40.184921 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m13:30:40.189749 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:40.190250 [debug] [MainThread]: On master: BEGIN
[0m13:30:40.190626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:40.195310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.195802 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:40.196243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:40.200249 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:40.201365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24d9cc610>]}
[0m13:30:40.201917 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:40.202416 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:40.202788 [debug] [MainThread]: On master: BEGIN
[0m13:30:40.203275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.203653 [debug] [MainThread]: On master: COMMIT
[0m13:30:40.204034 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:40.204400 [debug] [MainThread]: On master: COMMIT
[0m13:30:40.204984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.205409 [debug] [MainThread]: On master: Close
[0m13:30:40.206091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:40.206472 [info ] [MainThread]: 
[0m13:30:40.211236 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m13:30:40.211818 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m13:30:40.212450 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m13:30:40.213037 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m13:30:40.213765 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m13:30:40.214478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m13:30:40.215065 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m13:30:40.215807 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m13:30:40.216263 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m13:30:40.216997 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m13:30:40.217457 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m13:30:40.223892 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m13:30:40.224357 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m13:30:40.226573 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m13:30:40.228359 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m13:30:40.229041 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 13:30:40.217790 => 13:30:40.228834
[0m13:30:40.229680 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 13:30:40.224713 => 13:30:40.229491
[0m13:30:40.230124 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m13:30:40.230652 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m13:30:40.242047 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 13:30:40.227057 => 13:30:40.241801
[0m13:30:40.263107 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m13:30:40.282350 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m13:30:40.283047 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m13:30:40.287068 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m13:30:40.287911 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:30:40.288379 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m13:30:40.288869 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:30:40.289317 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:30:40.289774 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m13:30:40.290382 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:30:40.290957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:40.291482 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m13:30:40.292114 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:30:40.295428 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.296119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.296640 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:30:40.297071 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.297515 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:30:40.297978 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m13:30:40.298407 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:30:40.298834 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m13:30:40.299327 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m13:30:40.301542 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m13:30:40.307522 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:30:40.308046 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m13:30:40.312790 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:30:40.313530 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:30:40.317026 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:30:40.317615 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:30:40.318039 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m13:30:40.318473 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m13:30:40.319325 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:40.319790 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:40.320162 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:40.345284 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m13:30:40.347196 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m13:30:40.348993 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m13:30:40.349409 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:30:40.349873 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:30:40.350321 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:30:40.350729 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m13:30:40.351228 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m13:30:40.351695 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m13:30:40.353111 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.353573 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.354131 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.359278 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:30:40.361725 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:30:40.364025 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:30:40.364493 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m13:30:40.364989 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m13:30:40.365446 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m13:30:40.366250 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:40.366578 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:40.368094 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 13:30:40.252593 => 13:30:40.367940
[0m13:30:40.368689 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:40.370094 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 13:30:40.283537 => 13:30:40.369949
[0m13:30:40.370814 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m13:30:40.372134 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 13:30:40.230979 => 13:30:40.371993
[0m13:30:40.372607 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m13:30:40.373672 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24d991f10>]}
[0m13:30:40.374345 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m13:30:40.375123 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.16s]
[0m13:30:40.375896 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24d98e650>]}
[0m13:30:40.376660 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m13:30:40.377429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24f2ead50>]}
[0m13:30:40.378145 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.16s]
[0m13:30:40.378958 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.16s]
[0m13:30:40.379567 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m13:30:40.380176 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m13:30:40.380832 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m13:30:40.381428 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m13:30:40.382143 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m13:30:40.382550 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m13:30:40.385251 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m13:30:40.385905 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 13:30:40.382860 => 13:30:40.385697
[0m13:30:40.386319 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m13:30:40.390258 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m13:30:40.390858 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:30:40.391256 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m13:30:40.391631 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:30:40.396129 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.396609 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:30:40.397012 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m13:30:40.402063 [debug] [Thread-4  ]: SQL status: SELECT 499 in 0.0 seconds
[0m13:30:40.404941 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:30:40.405364 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m13:30:40.405936 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:40.407702 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m13:30:40.408111 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:30:40.408465 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m13:30:40.409457 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.411732 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:30:40.412157 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m13:30:40.412711 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:40.414007 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 13:30:40.386612 => 13:30:40.413840
[0m13:30:40.414391 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m13:30:40.415103 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24d91c690>]}
[0m13:30:40.415705 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 499[0m in 0.03s]
[0m13:30:40.416284 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m13:30:40.417178 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m13:30:40.417788 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m13:30:40.418424 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m13:30:40.418872 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m13:30:40.421492 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m13:30:40.422143 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 13:30:40.419154 => 13:30:40.421975
[0m13:30:40.422579 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m13:30:40.457555 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m13:30:40.458288 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:30:40.458713 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m13:30:40.459129 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:30:40.463524 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.464054 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:30:40.464453 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m13:30:40.469138 [debug] [Thread-3  ]: SQL status: SELECT 499 in 0.0 seconds
[0m13:30:40.471994 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:30:40.472408 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m13:30:40.473031 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:40.474787 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m13:30:40.475186 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:30:40.475559 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m13:30:40.476657 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.478918 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:30:40.479311 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m13:30:40.479857 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:40.481083 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 13:30:40.422886 => 13:30:40.480936
[0m13:30:40.481486 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m13:30:40.482190 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd947148e-1ae8-41e9-9b75-bd1194273c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c24d883190>]}
[0m13:30:40.482801 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 499[0m in 0.06s]
[0m13:30:40.483432 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m13:30:40.520671 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:40.521887 [debug] [MainThread]: On master: BEGIN
[0m13:30:40.522842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:40.533545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:40.534707 [debug] [MainThread]: On master: COMMIT
[0m13:30:40.535661 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:40.536467 [debug] [MainThread]: On master: COMMIT
[0m13:30:40.537378 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:40.538201 [debug] [MainThread]: On master: Close
[0m13:30:40.539417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:40.540046 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m13:30:40.540613 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m13:30:40.541154 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m13:30:40.541683 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m13:30:40.542188 [info ] [MainThread]: 
[0m13:30:40.542637 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m13:30:40.544063 [debug] [MainThread]: Command end result
[0m13:30:40.548331 [info ] [MainThread]: 
[0m13:30:40.548797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:40.549120 [info ] [MainThread]: 
[0m13:30:40.549462 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:30:40.549956 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:40.549874 after 0.55 seconds
[0m13:30:40.550337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e40910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e40750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c251e40f90>]}
[0m13:30:40.550738 [debug] [MainThread]: Flushing usage events
[0m14:31:21.623031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db0b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db0b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db0b8d0>]}


============================== 14:31:21.644096 | b9066cc4-3638-462c-9ddf-da79aadc106b ==============================
[0m14:31:21.644096 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:31:21.644624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:31:21.698575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287aa29510>]}
[0m14:31:21.712884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db3a250>]}
[0m14:31:21.713720 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:31:21.724905 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:31:21.751501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:21.751989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:21.757475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287af80c90>]}
[0m14:31:21.762201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287afcab50>]}
[0m14:31:21.762768 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:31:21.763144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287afcad50>]}
[0m14:31:21.764477 [info ] [MainThread]: 
[0m14:31:21.765156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:21.766381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:31:21.775947 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:31:21.776389 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:31:21.776764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:21.785904 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:31:21.787438 [debug] [ThreadPool]: On list_finbest: Close
[0m14:31:21.789431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m14:31:21.795110 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:31:21.795626 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:31:21.796011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:21.800456 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:31:21.800944 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:31:21.801313 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:31:21.805271 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:31:21.806417 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:31:21.806867 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:31:21.811534 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:21.811997 [debug] [MainThread]: On master: BEGIN
[0m14:31:21.812351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:21.816753 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:21.817207 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:21.817610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:21.821602 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:31:21.822657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287aecd910>]}
[0m14:31:21.823168 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:21.823604 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:21.823971 [debug] [MainThread]: On master: BEGIN
[0m14:31:21.824394 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:21.824751 [debug] [MainThread]: On master: COMMIT
[0m14:31:21.825098 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:21.825423 [debug] [MainThread]: On master: COMMIT
[0m14:31:21.825785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:31:21.826136 [debug] [MainThread]: On master: Close
[0m14:31:21.826780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:21.827133 [info ] [MainThread]: 
[0m14:31:21.831818 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:31:21.832227 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:31:21.832855 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:31:21.833511 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:31:21.834273 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:31:21.834855 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:31:21.835714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:31:21.836488 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m14:31:21.837321 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:31:21.837803 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:31:21.838232 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:31:21.838714 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:31:21.845069 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:31:21.847352 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:31:21.849106 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:31:21.850019 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:31:21.839072 => 14:31:21.849800
[0m14:31:21.850633 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:31:21.845433 => 14:31:21.850451
[0m14:31:21.851143 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:31:21.851671 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:31:21.893888 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:31:21.847782 => 14:31:21.893571
[0m14:31:21.918517 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:31:21.919374 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:31:21.920080 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:31:21.924286 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:31:21.925210 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:31:21.925750 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:31:21.926259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:31:21.926861 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:31:21.927328 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:31:21.927776 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:31:21.928260 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:31:21.928684 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:31:21.929188 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:31:21.931050 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:31:21.931600 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:31:21.932087 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:31:21.933449 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:31:21.933929 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:31:21.934362 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:31:21.934779 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:31:21.935201 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:31:21.935620 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:31:21.936030 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:31:21.942354 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:31:21.942884 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m14:31:21.943309 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:31:21.947108 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:31:21.947628 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:31:21.948235 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:31:21.950995 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:31:21.951466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:21.951991 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:31:21.952421 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:21.968402 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:21.970507 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:31:21.972500 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:31:21.974359 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:31:21.974829 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:31:21.975267 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:31:21.975735 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:31:21.976271 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:31:21.976695 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:31:21.977187 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:31:21.978397 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:31:21.983239 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:31:21.983928 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:31:21.984482 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:31:21.984921 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:31:21.987209 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:31:21.989365 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:31:21.989892 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:31:21.990397 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:21.990957 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:31:21.992472 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:31:21.862194 => 14:31:21.992315
[0m14:31:21.992979 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:21.993623 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:31:21.994079 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:21.995429 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:31:21.852023 => 14:31:21.995284
[0m14:31:21.996204 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287ab18890>]}
[0m14:31:21.997659 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:31:21.920677 => 14:31:21.997469
[0m14:31:21.998268 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:31:21.998937 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.16s]
[0m14:31:21.999464 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:31:22.000141 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:31:22.000888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287af2d9d0>]}
[0m14:31:22.002071 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287ab10c90>]}
[0m14:31:22.002762 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.17s]
[0m14:31:22.003476 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.17s]
[0m14:31:22.004153 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:31:22.004764 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:31:22.005717 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:31:22.006288 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:31:22.007021 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:31:22.007449 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:31:22.010262 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:31:22.010968 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:31:22.007753 => 14:31:22.010773
[0m14:31:22.011399 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:31:22.015519 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:31:22.016166 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:31:22.016579 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:31:22.016970 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:31:22.022612 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:31:22.023264 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:31:22.023721 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:31:22.032004 [debug] [Thread-4  ]: SQL status: SELECT 469 in 0.0 seconds
[0m14:31:22.035160 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:31:22.035634 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:31:22.036372 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:22.038262 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:31:22.038686 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:31:22.039078 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:31:22.040603 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:31:22.043016 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:31:22.043463 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:31:22.044190 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:22.045504 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:31:22.011700 => 14:31:22.045342
[0m14:31:22.045945 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:31:22.046799 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287aaf4f90>]}
[0m14:31:22.047436 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 469[0m in 0.04s]
[0m14:31:22.048262 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:31:22.048926 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m14:31:22.049567 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:31:22.050250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m14:31:22.050687 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m14:31:22.054276 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:31:22.055043 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 14:31:22.051003 => 14:31:22.054818
[0m14:31:22.055487 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m14:31:22.095124 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:31:22.095881 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:31:22.096341 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:31:22.096754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:31:22.101502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:31:22.102014 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:31:22.102428 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:31:22.108900 [debug] [Thread-1  ]: SQL status: SELECT 469 in 0.0 seconds
[0m14:31:22.113159 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:31:22.113686 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:31:22.114386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:22.116293 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:31:22.116718 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:31:22.117120 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:31:22.118556 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:31:22.121128 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:31:22.121564 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:31:22.122107 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:22.123429 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 14:31:22.055811 => 14:31:22.123265
[0m14:31:22.123872 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m14:31:22.124572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9066cc4-3638-462c-9ddf-da79aadc106b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287aa0b290>]}
[0m14:31:22.125184 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 469[0m in 0.07s]
[0m14:31:22.125751 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m14:31:22.133459 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:22.133902 [debug] [MainThread]: On master: BEGIN
[0m14:31:22.134266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:22.139048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:22.139626 [debug] [MainThread]: On master: COMMIT
[0m14:31:22.140111 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:22.140545 [debug] [MainThread]: On master: COMMIT
[0m14:31:22.141170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:31:22.141766 [debug] [MainThread]: On master: Close
[0m14:31:22.143057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:22.144024 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:31:22.144911 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:31:22.145632 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m14:31:22.146094 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:31:22.146573 [info ] [MainThread]: 
[0m14:31:22.147028 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m14:31:22.148439 [debug] [MainThread]: Command end result
[0m14:31:22.152871 [info ] [MainThread]: 
[0m14:31:22.153327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:22.153678 [info ] [MainThread]: 
[0m14:31:22.154075 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:31:22.154575 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:22.154475 after 0.54 seconds
[0m14:31:22.154959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db0b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db0b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b287db0b490>]}
[0m14:31:22.155357 [debug] [MainThread]: Flushing usage events
[0m14:46:30.174564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f40984190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f409840d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f409848d0>]}


============================== 14:46:30.199829 | fc400be5-474d-4d5d-a304-6e9125512c81 ==============================
[0m14:46:30.199829 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:46:30.200330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:46:30.253813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f413d1610>]}
[0m14:46:30.268522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3df1e290>]}
[0m14:46:30.269502 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:46:30.279956 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:46:30.305710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:30.306152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:30.311645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3ddf5f10>]}
[0m14:46:30.317104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3de43a50>]}
[0m14:46:30.317621 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:46:30.318012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3de43b90>]}
[0m14:46:30.319314 [info ] [MainThread]: 
[0m14:46:30.319984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:30.321321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:46:30.331896 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:46:30.332379 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:46:30.332728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:30.338571 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:46:30.339932 [debug] [ThreadPool]: On list_finbest: Close
[0m14:46:30.341658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m14:46:30.347905 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:46:30.348395 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:46:30.348774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:30.353269 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.353739 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:46:30.354142 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:46:30.358016 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:46:30.359310 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:46:30.359788 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:46:30.364728 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.365235 [debug] [MainThread]: On master: BEGIN
[0m14:46:30.365585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:30.370087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.370558 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.370986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:46:30.375082 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:46:30.376222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3e1285d0>]}
[0m14:46:30.376729 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:30.377191 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.377535 [debug] [MainThread]: On master: BEGIN
[0m14:46:30.377979 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.378317 [debug] [MainThread]: On master: COMMIT
[0m14:46:30.378647 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.378995 [debug] [MainThread]: On master: COMMIT
[0m14:46:30.379483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.379851 [debug] [MainThread]: On master: Close
[0m14:46:30.380515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:46:30.380877 [info ] [MainThread]: 
[0m14:46:30.386227 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:46:30.386823 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:46:30.387341 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:46:30.388093 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:46:30.388678 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:46:30.389225 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:46:30.389987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:46:30.390704 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m14:46:30.391520 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:46:30.392053 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:46:30.392496 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:46:30.392973 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:46:30.399636 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:46:30.401687 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:46:30.403588 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:46:30.404725 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:46:30.393327 => 14:46:30.404505
[0m14:46:30.405293 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:46:30.399913 => 14:46:30.405082
[0m14:46:30.405748 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:46:30.406347 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:46:30.438778 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:46:30.402181 => 14:46:30.438500
[0m14:46:30.444437 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:46:30.468954 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:46:30.470478 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:46:30.465037 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:46:30.471699 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:30.472196 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:30.472796 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:46:30.473319 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:30.473911 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:46:30.474384 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:46:30.474908 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:46:30.475412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:46:30.476069 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:46:30.480359 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.481259 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:30.481823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.482216 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:46:30.483194 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:30.483809 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.484299 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:46:30.484755 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:30.485274 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:46:30.487465 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:46:30.488024 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:46:30.488560 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m14:46:30.495023 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:30.498383 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:30.502130 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:30.502661 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:46:30.503072 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:46:30.503721 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:46:30.504590 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.505032 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.510682 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.533433 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:46:30.534393 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:46:30.536225 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:46:30.536845 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:30.537475 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:30.537958 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:30.538441 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:46:30.538975 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:46:30.539415 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:46:30.540878 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.541221 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.547117 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.548375 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:30.550918 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:30.553397 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:30.554124 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:46:30.554765 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:46:30.555201 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:46:30.555898 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:30.556208 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:30.556681 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:30.558461 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:46:30.406770 => 14:46:30.558187
[0m14:46:30.560863 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:46:30.422898 => 14:46:30.560646
[0m14:46:30.562461 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:46:30.465182 => 14:46:30.562257
[0m14:46:30.562994 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:46:30.563600 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:46:30.564192 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:46:30.565097 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3de4c290>]}
[0m14:46:30.565956 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3d8e98d0>]}
[0m14:46:30.566693 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m14:46:30.567404 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3de01110>]}
[0m14:46:30.568123 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.17s]
[0m14:46:30.568715 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:46:30.569505 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.18s]
[0m14:46:30.570185 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:46:30.571186 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:46:30.572033 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:46:30.572706 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:46:30.573496 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:46:30.573961 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:46:30.577069 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:46:30.577939 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:46:30.574300 => 14:46:30.577710
[0m14:46:30.578478 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:46:30.583276 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:46:30.584027 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:30.584501 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:46:30.584903 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:46:30.589548 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.590409 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:30.591150 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:46:30.598062 [debug] [Thread-4  ]: SQL status: SELECT 484 in 0.0 seconds
[0m14:46:30.601382 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:30.601903 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:46:30.602632 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.604601 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:46:30.605058 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:30.605462 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:46:30.606756 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.610769 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:30.611501 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:46:30.612398 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:30.614961 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:46:30.578938 => 14:46:30.614643
[0m14:46:30.615775 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:46:30.617152 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3d9dc790>]}
[0m14:46:30.618371 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 484[0m in 0.04s]
[0m14:46:30.619549 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:46:30.620645 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m14:46:30.621256 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:46:30.621930 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m14:46:30.622359 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m14:46:30.625977 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:46:30.626727 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 14:46:30.622676 => 14:46:30.626526
[0m14:46:30.627195 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m14:46:30.671122 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:46:30.672331 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:30.672846 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:46:30.673256 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:46:30.678086 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.678608 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:30.679031 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:46:30.686776 [debug] [Thread-3  ]: SQL status: SELECT 484 in 0.0 seconds
[0m14:46:30.690697 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:30.691227 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:46:30.692016 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.693939 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:46:30.694371 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:30.694771 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:46:30.695857 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.699009 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:30.699883 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:46:30.700610 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:30.702151 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 14:46:30.627521 => 14:46:30.701975
[0m14:46:30.702597 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m14:46:30.703374 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc400be5-474d-4d5d-a304-6e9125512c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f3ded8f50>]}
[0m14:46:30.704054 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 484[0m in 0.08s]
[0m14:46:30.704863 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m14:46:30.787917 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.788663 [debug] [MainThread]: On master: BEGIN
[0m14:46:30.789242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:30.794780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.795290 [debug] [MainThread]: On master: COMMIT
[0m14:46:30.795639 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.795983 [debug] [MainThread]: On master: COMMIT
[0m14:46:30.796424 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.796802 [debug] [MainThread]: On master: Close
[0m14:46:30.797470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:30.797825 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:46:30.798134 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m14:46:30.798465 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:46:30.798807 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:46:30.799191 [info ] [MainThread]: 
[0m14:46:30.799526 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:46:30.800610 [debug] [MainThread]: Command end result
[0m14:46:30.805587 [info ] [MainThread]: 
[0m14:46:30.806328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:30.806855 [info ] [MainThread]: 
[0m14:46:30.807266 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:46:30.807871 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:30.807772 after 0.65 seconds
[0m14:46:30.808300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f409845d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f40984850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795f40984f90>]}
[0m14:46:30.808718 [debug] [MainThread]: Flushing usage events
[0m14:54:19.860474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c023250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c0230d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c023950>]}


============================== 14:54:19.881051 | 2aa78adf-3621-478d-99dd-9ac789493500 ==============================
[0m14:54:19.881051 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:54:19.881594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:19.935156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c043710>]}
[0m14:54:19.949964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c055690>]}
[0m14:54:19.950863 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:54:19.961513 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:54:19.986089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:19.986553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:19.992115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48948c710>]}
[0m14:54:19.996720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac4894e4410>]}
[0m14:54:19.997259 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:54:19.997626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac4894e4950>]}
[0m14:54:19.999593 [info ] [MainThread]: 
[0m14:54:20.000302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:20.002117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:54:20.012260 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:54:20.012720 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:54:20.013117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:20.019078 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:54:20.020468 [debug] [ThreadPool]: On list_finbest: Close
[0m14:54:20.022187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m14:54:20.027842 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:54:20.028312 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:54:20.028692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:20.033977 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.034525 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:54:20.035016 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:54:20.038686 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:54:20.040222 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:54:20.040880 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:54:20.046530 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:20.047157 [debug] [MainThread]: On master: BEGIN
[0m14:54:20.047661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:20.054285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.055014 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:20.055668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:20.063252 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:54:20.065441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac487b7ed50>]}
[0m14:54:20.066496 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:20.067408 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:20.067997 [debug] [MainThread]: On master: BEGIN
[0m14:54:20.068714 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.069309 [debug] [MainThread]: On master: COMMIT
[0m14:54:20.069868 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:20.070416 [debug] [MainThread]: On master: COMMIT
[0m14:54:20.070986 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.071469 [debug] [MainThread]: On master: Close
[0m14:54:20.072291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:20.072729 [info ] [MainThread]: 
[0m14:54:20.077703 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:54:20.078136 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:54:20.078745 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:54:20.079495 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:54:20.080285 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:54:20.080827 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:54:20.081507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:54:20.082325 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m14:54:20.083056 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:54:20.083522 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:54:20.083990 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:54:20.084414 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:54:20.092831 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:54:20.095175 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:54:20.096948 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:54:20.097962 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:54:20.084746 => 14:54:20.097706
[0m14:54:20.098508 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:54:20.099217 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:54:20.093316 => 14:54:20.098989
[0m14:54:20.116057 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:54:20.127031 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:54:20.095564 => 14:54:20.126762
[0m14:54:20.137935 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:54:20.153160 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:54:20.157757 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:54:20.161064 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:54:20.162376 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:54:20.163145 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:54:20.163855 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:54:20.164587 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:54:20.165356 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:54:20.166205 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:54:20.167280 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:54:20.167982 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:54:20.168647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:54:20.171223 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.171757 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:54:20.172183 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:54:20.173520 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.174119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.174609 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:54:20.175100 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:54:20.175589 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m14:54:20.176099 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:54:20.176559 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:54:20.182937 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:54:20.183546 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:54:20.184511 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:20.190724 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:54:20.196385 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:54:20.200040 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:54:20.208249 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:54:20.211538 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:54:20.211992 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:54:20.212528 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:54:20.213126 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:54:20.213743 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:54:20.214309 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:20.214778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:20.216806 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:54:20.217241 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.219142 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:54:20.219643 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:54:20.224431 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:54:20.224909 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:54:20.225393 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:54:20.225881 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:54:20.226413 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:54:20.227308 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:20.228645 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:54:20.127476 => 14:54:20.228495
[0m14:54:20.229218 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:54:20.229689 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.230141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.230927 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac487b4c410>]}
[0m14:54:20.233467 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:54:20.235819 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:54:20.236515 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.15s]
[0m14:54:20.237064 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:54:20.237502 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:54:20.238131 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:54:20.238855 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:20.239231 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:20.240494 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:54:20.143415 => 14:54:20.240350
[0m14:54:20.241692 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:54:20.099680 => 14:54:20.241547
[0m14:54:20.242127 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:54:20.242562 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:54:20.243334 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac487af0a50>]}
[0m14:54:20.244038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac487b96810>]}
[0m14:54:20.244762 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.16s]
[0m14:54:20.245381 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.16s]
[0m14:54:20.245972 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:54:20.246546 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:54:20.247313 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:54:20.247888 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:54:20.248592 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:54:20.249003 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:54:20.251687 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:54:20.252399 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:54:20.249301 => 14:54:20.252222
[0m14:54:20.252827 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:54:20.256763 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:54:20.257403 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:54:20.257820 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:54:20.258198 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:54:20.262761 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.263335 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:54:20.263747 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:54:20.269241 [debug] [Thread-4  ]: SQL status: SELECT 484 in 0.0 seconds
[0m14:54:20.272256 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:54:20.272700 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:54:20.273522 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:20.275319 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:54:20.275702 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:54:20.276105 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:54:20.277240 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.279495 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:54:20.279915 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:54:20.280639 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:20.281922 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:54:20.253130 => 14:54:20.281751
[0m14:54:20.282379 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:54:20.283106 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac487b87890>]}
[0m14:54:20.283721 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 484[0m in 0.03s]
[0m14:54:20.284310 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:54:20.285002 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m14:54:20.285637 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:54:20.286261 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m14:54:20.286676 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m14:54:20.289275 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:54:20.289988 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 14:54:20.286992 => 14:54:20.289772
[0m14:54:20.290419 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m14:54:20.329778 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:54:20.330612 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:54:20.331090 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:54:20.331469 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:54:20.336096 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.336626 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:54:20.337052 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:54:20.342193 [debug] [Thread-3  ]: SQL status: SELECT 484 in 0.0 seconds
[0m14:54:20.345364 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:54:20.345843 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:54:20.346521 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:20.348347 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:54:20.348766 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:54:20.349128 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:54:20.350248 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.352587 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:54:20.352983 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:54:20.353628 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:54:20.354899 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 14:54:20.290715 => 14:54:20.354733
[0m14:54:20.355278 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m14:54:20.355986 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa78adf-3621-478d-99dd-9ac789493500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac487a45a50>]}
[0m14:54:20.356570 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 484[0m in 0.07s]
[0m14:54:20.357137 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m14:54:20.384281 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:20.386254 [debug] [MainThread]: On master: BEGIN
[0m14:54:20.388068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:20.399498 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:20.400650 [debug] [MainThread]: On master: COMMIT
[0m14:54:20.401771 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:20.402705 [debug] [MainThread]: On master: COMMIT
[0m14:54:20.403890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:20.404855 [debug] [MainThread]: On master: Close
[0m14:54:20.406117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:20.406747 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m14:54:20.407334 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:54:20.407938 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:54:20.408434 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:54:20.408922 [info ] [MainThread]: 
[0m14:54:20.409363 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:54:20.410771 [debug] [MainThread]: Command end result
[0m14:54:20.414998 [info ] [MainThread]: 
[0m14:54:20.415425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:20.415768 [info ] [MainThread]: 
[0m14:54:20.416105 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:54:20.416638 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:20.416550 after 0.57 seconds
[0m14:54:20.417063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c023d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c023e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac48c023710>]}
[0m14:54:20.417437 [debug] [MainThread]: Flushing usage events
[0m22:09:43.589142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f33fb81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f33ff9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f33fb8050>]}


============================== 22:09:43.610588 | 6ac0bb58-8cb7-4f85-aeb6-8d2618206c83 ==============================
[0m22:09:43.610588 [info ] [MainThread]: Running with dbt=1.5.11
[0m22:09:43.611139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:09:43.669192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f33fe80d0>]}
[0m22:09:43.684523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f33fb8ed0>]}
[0m22:09:43.685505 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m22:09:43.696073 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m22:09:43.724053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:09:43.724497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:09:43.730162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2fb41110>]}
[0m22:09:43.735198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f30f8ded0>]}
[0m22:09:43.735803 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:09:43.736186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f30f8db10>]}
[0m22:09:43.737547 [info ] [MainThread]: 
[0m22:09:43.738275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:09:43.739575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m22:09:43.749538 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m22:09:43.750037 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m22:09:43.750408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:43.756207 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:09:43.757541 [debug] [ThreadPool]: On list_finbest: Close
[0m22:09:43.759432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m22:09:43.765364 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:09:43.765856 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m22:09:43.766247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:43.772273 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:09:43.773067 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:09:43.773773 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m22:09:43.779404 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:09:43.781820 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m22:09:43.782770 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m22:09:43.791400 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:43.792178 [debug] [MainThread]: On master: BEGIN
[0m22:09:43.792780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:43.799067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:09:43.799574 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:43.800050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:09:43.804758 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:09:43.806712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2fb12ad0>]}
[0m22:09:43.807609 [debug] [MainThread]: On master: ROLLBACK
[0m22:09:43.808610 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:43.809461 [debug] [MainThread]: On master: BEGIN
[0m22:09:43.810515 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:09:43.811265 [debug] [MainThread]: On master: COMMIT
[0m22:09:43.811958 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:43.812623 [debug] [MainThread]: On master: COMMIT
[0m22:09:43.813358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:09:43.813940 [debug] [MainThread]: On master: Close
[0m22:09:43.814896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:43.815446 [info ] [MainThread]: 
[0m22:09:43.820898 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m22:09:43.821439 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m22:09:43.822032 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m22:09:43.822562 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m22:09:43.823267 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m22:09:43.823969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m22:09:43.824535 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m22:09:43.825242 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m22:09:43.825713 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m22:09:43.826541 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m22:09:43.827090 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m22:09:43.838024 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m22:09:43.839019 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m22:09:43.842026 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m22:09:43.844700 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m22:09:43.846344 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 22:09:43.827478 => 22:09:43.845967
[0m22:09:43.847303 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m22:09:43.869305 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 22:09:43.842699 => 22:09:43.869049
[0m22:09:43.869948 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 22:09:43.839522 => 22:09:43.869728
[0m22:09:43.870507 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m22:09:43.871061 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m22:09:43.909799 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m22:09:43.912087 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m22:09:43.916856 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m22:09:43.917734 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:09:43.918313 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:09:43.918990 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m22:09:43.919729 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:09:43.920459 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m22:09:43.921267 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:09:43.922149 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m22:09:43.922841 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:09:43.923611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:43.927870 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:09:43.928412 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:09:43.928910 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m22:09:43.929356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:09:43.929888 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:09:43.930337 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:09:43.930748 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:09:43.931623 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m22:09:43.932040 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m22:09:43.933422 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:09:43.939902 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m22:09:43.940257 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m22:09:43.939709 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:09:43.943491 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:09:43.947094 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:09:43.947736 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:09:43.948429 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m22:09:43.948921 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m22:09:43.949620 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:09:43.950072 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:09:43.950517 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:09:43.980444 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:09:43.982197 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:09:43.984233 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:09:43.984699 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:09:43.985235 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:09:43.985727 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:09:43.986156 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:09:43.986585 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:09:43.987017 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:09:43.988206 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:09:43.992986 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:09:43.993475 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:09:43.994041 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m22:09:43.994506 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:09:43.996757 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:09:43.999208 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:09:43.999655 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:09:44.000203 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m22:09:44.000656 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m22:09:44.002061 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 22:09:43.876578 => 22:09:44.001890
[0m22:09:44.002673 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m22:09:44.003197 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:09:44.003613 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:09:44.005059 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 22:09:43.897204 => 22:09:44.004871
[0m22:09:44.005958 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f30f8da90>]}
[0m22:09:44.007480 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 22:09:43.848136 => 22:09:44.007314
[0m22:09:44.007975 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m22:09:44.008628 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.18s]
[0m22:09:44.009113 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m22:09:44.009778 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m22:09:44.010540 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2f167b10>]}
[0m22:09:44.011547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2fb1a310>]}
[0m22:09:44.012323 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.19s]
[0m22:09:44.012856 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m22:09:44.013540 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m22:09:44.014184 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m22:09:44.014736 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m22:09:44.015364 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m22:09:44.016252 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m22:09:44.016836 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m22:09:44.019652 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m22:09:44.020346 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 22:09:44.017144 => 22:09:44.020164
[0m22:09:44.020765 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m22:09:44.024802 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m22:09:44.025443 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:09:44.025860 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m22:09:44.026234 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:09:44.030743 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m22:09:44.031230 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:09:44.031640 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m22:09:44.037649 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:09:44.040609 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:09:44.041071 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m22:09:44.041689 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:09:44.043534 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:09:44.043949 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:09:44.044316 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:09:44.045660 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m22:09:44.047829 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:09:44.048231 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m22:09:44.048758 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:09:44.050021 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 22:09:44.021079 => 22:09:44.049874
[0m22:09:44.050420 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m22:09:44.051258 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2f1f2cd0>]}
[0m22:09:44.052126 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.04s]
[0m22:09:44.052920 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m22:09:44.053638 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m22:09:44.054245 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m22:09:44.054871 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m22:09:44.055273 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m22:09:44.058600 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m22:09:44.059323 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 22:09:44.055568 => 22:09:44.059125
[0m22:09:44.059747 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m22:09:44.093890 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m22:09:44.094638 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:09:44.095056 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m22:09:44.095434 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:09:44.100285 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:09:44.100780 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:09:44.101201 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m22:09:44.106470 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:09:44.109270 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:09:44.109706 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m22:09:44.110339 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:09:44.112115 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:09:44.112531 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:09:44.112914 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:09:44.114033 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:09:44.116339 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:09:44.116740 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m22:09:44.117441 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:09:44.118686 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 22:09:44.060043 => 22:09:44.118538
[0m22:09:44.119106 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m22:09:44.119806 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac0bb58-8cb7-4f85-aeb6-8d2618206c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2f1810d0>]}
[0m22:09:44.120429 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.07s]
[0m22:09:44.120991 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m22:09:44.125837 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:44.126273 [debug] [MainThread]: On master: BEGIN
[0m22:09:44.126636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:44.131108 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:09:44.131579 [debug] [MainThread]: On master: COMMIT
[0m22:09:44.131964 [debug] [MainThread]: Using postgres connection "master"
[0m22:09:44.132333 [debug] [MainThread]: On master: COMMIT
[0m22:09:44.132761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:09:44.133149 [debug] [MainThread]: On master: Close
[0m22:09:44.133790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:44.134169 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m22:09:44.134513 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m22:09:44.134848 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m22:09:44.135157 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m22:09:44.135530 [info ] [MainThread]: 
[0m22:09:44.135874 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m22:09:44.136960 [debug] [MainThread]: Command end result
[0m22:09:44.141327 [info ] [MainThread]: 
[0m22:09:44.141874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:44.142238 [info ] [MainThread]: 
[0m22:09:44.142582 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:09:44.143096 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:44.143014 after 0.56 seconds
[0m22:09:44.143452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f2f1810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f31761210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765f317e9b50>]}
[0m22:09:44.143812 [debug] [MainThread]: Flushing usage events
[0m22:26:37.530312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bf050>]}


============================== 22:26:37.550323 | 87a3886d-3728-4845-8f55-62f048e0cf51 ==============================
[0m22:26:37.550323 [info ] [MainThread]: Running with dbt=1.5.11
[0m22:26:37.550906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:26:37.627322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bfb50>]}
[0m22:26:37.646188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a842d10>]}
[0m22:26:37.647251 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m22:26:37.660408 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m22:26:37.691972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:37.692474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:37.699165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a735e90>]}
[0m22:26:37.705434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a77ff10>]}
[0m22:26:37.706019 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:26:37.706369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a77fe90>]}
[0m22:26:37.708595 [info ] [MainThread]: 
[0m22:26:37.709290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:26:37.710602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m22:26:37.721519 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m22:26:37.722061 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m22:26:37.722418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:37.736400 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:26:37.737875 [debug] [ThreadPool]: On list_finbest: Close
[0m22:26:37.739839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m22:26:37.745716 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:26:37.746185 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m22:26:37.746548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:37.752013 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:37.752516 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:26:37.752904 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m22:26:37.758648 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:26:37.760175 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m22:26:37.760669 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m22:26:37.766932 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:37.767588 [debug] [MainThread]: On master: BEGIN
[0m22:26:37.768009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:37.772747 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:37.773244 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:37.773666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:26:37.780107 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:37.781416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a768bd0>]}
[0m22:26:37.781932 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:37.782427 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:37.782783 [debug] [MainThread]: On master: BEGIN
[0m22:26:37.783256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:37.783636 [debug] [MainThread]: On master: COMMIT
[0m22:26:37.783997 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:37.784329 [debug] [MainThread]: On master: COMMIT
[0m22:26:37.784852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:37.785247 [debug] [MainThread]: On master: Close
[0m22:26:37.786091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:37.786462 [info ] [MainThread]: 
[0m22:26:37.791486 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m22:26:37.792051 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m22:26:37.792816 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m22:26:37.793661 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m22:26:37.794086 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m22:26:37.794989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m22:26:37.795579 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m22:26:37.796267 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m22:26:37.796735 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m22:26:37.797494 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m22:26:37.798127 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m22:26:37.804787 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m22:26:37.805202 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m22:26:37.807720 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m22:26:37.809682 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m22:26:37.810443 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 22:26:37.798492 => 22:26:37.810231
[0m22:26:37.810921 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m22:26:37.833757 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 22:26:37.805733 => 22:26:37.833291
[0m22:26:37.839579 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m22:26:37.840024 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 22:26:37.808401 => 22:26:37.839839
[0m22:26:37.861681 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m22:26:37.871176 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m22:26:37.872152 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m22:26:37.880335 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m22:26:37.881703 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:26:37.882509 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m22:26:37.883729 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:26:37.884739 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:26:37.887417 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:26:37.888189 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m22:26:37.889356 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m22:26:37.890245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:26:37.891073 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:26:37.894254 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:26:37.895159 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:26:37.895906 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m22:26:37.896863 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:26:37.897457 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:26:37.897950 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:26:37.898370 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m22:26:37.898813 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:26:37.899643 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m22:26:37.907801 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m22:26:37.908432 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m22:26:37.914106 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:26:37.920992 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:26:37.921751 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:26:37.925461 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:26:37.925937 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m22:26:37.926398 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m22:26:37.926884 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:26:37.927593 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:37.928173 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:37.928642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:37.931578 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:26:37.935602 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:26:37.938781 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:26:37.939525 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m22:26:37.940133 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:26:37.940608 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m22:26:37.941494 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:37.942166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:37.947856 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:37.978708 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:26:37.982182 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:26:37.982784 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:26:37.985517 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:26:37.986058 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:26:37.986579 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:26:37.987158 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:26:37.987671 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:26:37.988157 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:26:37.988864 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:26:37.994038 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:26:37.994401 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:26:37.994964 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:26:37.995449 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m22:26:37.998254 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:26:38.001491 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:26:38.002201 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m22:26:38.002757 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m22:26:38.008808 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:38.009290 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:38.010004 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:38.011530 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 22:26:37.855418 => 22:26:38.011365
[0m22:26:38.013019 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 22:26:37.811255 => 22:26:38.012848
[0m22:26:38.014391 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 22:26:37.873118 => 22:26:38.014221
[0m22:26:38.015118 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m22:26:38.015776 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m22:26:38.016464 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m22:26:38.017712 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a39e8d0>]}
[0m22:26:38.018568 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a39ee90>]}
[0m22:26:38.019300 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.22s]
[0m22:26:38.020078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a3ab110>]}
[0m22:26:38.020784 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m22:26:38.021408 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m22:26:38.022045 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.23s]
[0m22:26:38.022684 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m22:26:38.023424 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m22:26:38.024263 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m22:26:38.024808 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m22:26:38.025511 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m22:26:38.025912 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m22:26:38.028721 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m22:26:38.029543 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 22:26:38.026206 => 22:26:38.029354
[0m22:26:38.029969 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m22:26:38.036228 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m22:26:38.037744 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:26:38.038203 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m22:26:38.038575 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:26:38.043333 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m22:26:38.043855 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:26:38.044275 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m22:26:38.051997 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:26:38.092574 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:26:38.093138 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m22:26:38.093827 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:38.096835 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:26:38.097490 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m22:26:38.098190 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:38.100962 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:26:38.101576 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:26:38.102071 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:26:38.103284 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m22:26:38.105720 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:26:38.106172 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m22:26:38.108037 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:38.109452 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 22:26:38.030282 => 22:26:38.109287
[0m22:26:38.109884 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m22:26:38.110677 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a347f50>]}
[0m22:26:38.111359 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.09s]
[0m22:26:38.111922 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m22:26:38.112563 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m22:26:38.113240 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m22:26:38.114401 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m22:26:38.114970 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m22:26:38.118458 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m22:26:38.119615 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 22:26:38.115280 => 22:26:38.119399
[0m22:26:38.120067 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m22:26:38.124203 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m22:26:38.125265 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:26:38.125687 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m22:26:38.126167 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:26:38.130883 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:26:38.131612 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:26:38.132117 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m22:26:38.137988 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:26:38.141245 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:26:38.141727 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m22:26:38.142470 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:38.145302 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:26:38.145756 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m22:26:38.146375 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:38.149125 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:26:38.149907 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:26:38.150357 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:26:38.151711 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:26:38.154336 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:26:38.154744 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m22:26:38.156776 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:38.158188 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 22:26:38.120369 => 22:26:38.158023
[0m22:26:38.158627 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m22:26:38.159362 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a3886d-3728-4845-8f55-62f048e0cf51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177a25fe10>]}
[0m22:26:38.160002 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.05s]
[0m22:26:38.160589 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m22:26:38.199895 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:38.201404 [debug] [MainThread]: On master: BEGIN
[0m22:26:38.202419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:38.211170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:38.211700 [debug] [MainThread]: On master: COMMIT
[0m22:26:38.212081 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:38.212428 [debug] [MainThread]: On master: COMMIT
[0m22:26:38.212850 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:38.213229 [debug] [MainThread]: On master: Close
[0m22:26:38.214090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:38.214728 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m22:26:38.215174 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m22:26:38.215624 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m22:26:38.215985 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m22:26:38.216557 [info ] [MainThread]: 
[0m22:26:38.216936 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m22:26:38.218125 [debug] [MainThread]: Command end result
[0m22:26:38.223396 [info ] [MainThread]: 
[0m22:26:38.223872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:38.224198 [info ] [MainThread]: 
[0m22:26:38.224531 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:26:38.225044 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:38.224962 after 0.71 seconds
[0m22:26:38.225428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bf7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177d2bf950>]}
[0m22:26:38.225827 [debug] [MainThread]: Flushing usage events
[0m22:35:21.375601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73201b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73201b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73201b990>]}


============================== 22:35:21.394867 | d390f89c-c61c-4168-aa6f-275632359fca ==============================
[0m22:35:21.394867 [info ] [MainThread]: Running with dbt=1.5.11
[0m22:35:21.395421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:35:21.456120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72f8c0590>]}
[0m22:35:21.472748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72f77ef10>]}
[0m22:35:21.473669 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m22:35:21.484406 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m22:35:21.513307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:21.513787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:21.520187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb7301ba990>]}
[0m22:35:21.525044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72f4da3d0>]}
[0m22:35:21.525569 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:35:21.525934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72f4dac10>]}
[0m22:35:21.527280 [info ] [MainThread]: 
[0m22:35:21.527970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:21.529479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m22:35:21.539980 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m22:35:21.540445 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m22:35:21.540798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:21.554562 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:35:21.556051 [debug] [ThreadPool]: On list_finbest: Close
[0m22:35:21.557761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m22:35:21.563909 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:35:21.564410 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m22:35:21.564765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:21.569640 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.570192 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:35:21.570582 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m22:35:21.578254 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:35:21.579940 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m22:35:21.580597 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m22:35:21.587255 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:21.587774 [debug] [MainThread]: On master: BEGIN
[0m22:35:21.588159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:21.592767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.593281 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:21.593695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:21.599688 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:35:21.600910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72f4e3990>]}
[0m22:35:21.601442 [debug] [MainThread]: On master: ROLLBACK
[0m22:35:21.601954 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:21.602310 [debug] [MainThread]: On master: BEGIN
[0m22:35:21.602807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.603241 [debug] [MainThread]: On master: COMMIT
[0m22:35:21.603592 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:21.603949 [debug] [MainThread]: On master: COMMIT
[0m22:35:21.604418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:35:21.604890 [debug] [MainThread]: On master: Close
[0m22:35:21.605599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:35:21.605993 [info ] [MainThread]: 
[0m22:35:21.610952 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m22:35:21.611518 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m22:35:21.612301 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m22:35:21.613136 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m22:35:21.613714 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m22:35:21.614279 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m22:35:21.615006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m22:35:21.615923 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m22:35:21.616914 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m22:35:21.617371 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m22:35:21.617885 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m22:35:21.618629 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m22:35:21.625052 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m22:35:21.627410 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m22:35:21.629254 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m22:35:21.630161 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 22:35:21.625427 => 22:35:21.629942
[0m22:35:21.630638 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m22:35:21.636366 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 22:35:21.619002 => 22:35:21.636099
[0m22:35:21.637081 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 22:35:21.627914 => 22:35:21.636765
[0m22:35:21.642941 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m22:35:21.648725 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m22:35:21.694313 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m22:35:21.697098 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m22:35:21.698932 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m22:35:21.699758 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:35:21.700323 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:35:21.700777 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m22:35:21.701269 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:35:21.701680 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m22:35:21.702094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:35:21.702531 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m22:35:21.702934 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:35:21.703436 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:35:21.710994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.711572 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.712066 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:35:21.712584 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.712946 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:35:21.713585 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m22:35:21.714065 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:35:21.714514 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m22:35:21.714994 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m22:35:21.723189 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m22:35:21.723782 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m22:35:21.724306 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:35:21.731021 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:35:21.734384 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:35:21.738022 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:35:21.738553 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m22:35:21.739089 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m22:35:21.739582 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:35:21.740586 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.741163 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.741632 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.744464 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:35:21.747767 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:35:21.751645 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:35:21.752279 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m22:35:21.752933 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:35:21.753484 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m22:35:21.754251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.754745 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.755084 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.787737 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:35:21.791145 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:35:21.794365 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:35:21.794851 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:35:21.795406 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:35:21.796038 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:35:21.796503 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:35:21.797071 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:35:21.797561 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:35:21.799234 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:35:21.799753 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:35:21.805623 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:35:21.806821 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:35:21.810525 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:35:21.814538 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:35:21.815570 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m22:35:21.816567 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m22:35:21.817623 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m22:35:21.822312 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:21.823572 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:21.824581 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:21.827205 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 22:35:21.631013 => 22:35:21.826892
[0m22:35:21.829640 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 22:35:21.674972 => 22:35:21.829461
[0m22:35:21.831131 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 22:35:21.659679 => 22:35:21.830972
[0m22:35:21.831852 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m22:35:21.832319 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m22:35:21.832823 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m22:35:21.833996 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72d157bd0>]}
[0m22:35:21.835079 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72d19b890>]}
[0m22:35:21.836073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72d186cd0>]}
[0m22:35:21.837018 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.22s]
[0m22:35:21.837675 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m22:35:21.838357 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m22:35:21.839019 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m22:35:21.839645 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m22:35:21.840245 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m22:35:21.841043 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m22:35:21.841676 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m22:35:21.842410 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m22:35:21.842873 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m22:35:21.845751 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m22:35:21.846459 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 22:35:21.843201 => 22:35:21.846270
[0m22:35:21.846899 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m22:35:21.852729 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m22:35:21.853494 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:35:21.853970 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m22:35:21.854355 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:35:21.858926 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.859433 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:35:21.859870 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m22:35:21.865987 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:35:21.903123 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:35:21.903639 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m22:35:21.904911 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.907595 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:35:21.908017 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m22:35:21.908596 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.910654 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:35:21.911149 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:35:21.911586 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:35:21.912936 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m22:35:21.915310 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:35:21.915722 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m22:35:21.917825 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:21.919329 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 22:35:21.847225 => 22:35:21.919145
[0m22:35:21.919804 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m22:35:21.920547 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72da5c850>]}
[0m22:35:21.921197 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.08s]
[0m22:35:21.921742 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m22:35:21.922568 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m22:35:21.923181 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m22:35:21.923831 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m22:35:21.924241 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m22:35:21.926969 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m22:35:21.927664 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 22:35:21.924544 => 22:35:21.927475
[0m22:35:21.928071 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m22:35:21.931813 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m22:35:21.932425 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:35:21.932863 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m22:35:21.933271 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:35:21.938136 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:35:21.938674 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:35:21.939102 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m22:35:21.944235 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:35:21.947380 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:35:21.947830 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m22:35:21.948529 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.951901 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:35:21.952386 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m22:35:21.953016 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:21.955017 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:35:21.955418 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:35:21.955800 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:35:21.957058 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:35:21.959357 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:35:21.959761 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m22:35:21.961772 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:21.963099 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 22:35:21.928346 => 22:35:21.962950
[0m22:35:21.963504 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m22:35:21.964220 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390f89c-c61c-4168-aa6f-275632359fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72d16fd90>]}
[0m22:35:21.964844 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.04s]
[0m22:35:21.965392 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m22:35:22.013366 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:22.014629 [debug] [MainThread]: On master: BEGIN
[0m22:35:22.015625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:22.026007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:22.027110 [debug] [MainThread]: On master: COMMIT
[0m22:35:22.027860 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:22.028424 [debug] [MainThread]: On master: COMMIT
[0m22:35:22.029119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:35:22.029717 [debug] [MainThread]: On master: Close
[0m22:35:22.030907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:22.031609 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m22:35:22.032232 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m22:35:22.032753 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m22:35:22.033163 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m22:35:22.033601 [info ] [MainThread]: 
[0m22:35:22.033957 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m22:35:22.035063 [debug] [MainThread]: Command end result
[0m22:35:22.040248 [info ] [MainThread]: 
[0m22:35:22.040726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:22.041081 [info ] [MainThread]: 
[0m22:35:22.041429 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:35:22.041981 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:22.041893 after 0.68 seconds
[0m22:35:22.042378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72ef2a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73201b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73201b690>]}
[0m22:35:22.042773 [debug] [MainThread]: Flushing usage events
[0m22:37:18.681011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ad181250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ad181150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ad181910>]}


============================== 22:37:18.686595 | 7da3f52b-c7c5-4700-8a32-cf891dc659ac ==============================
[0m22:37:18.686595 [info ] [MainThread]: Running with dbt=1.5.11
[0m22:37:18.687104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:37:18.755124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ad193290>]}
[0m22:37:18.779897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ad1b30d0>]}
[0m22:37:18.781229 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m22:37:18.793167 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m22:37:18.828436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:18.829623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:18.837442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa5bff10>]}
[0m22:37:18.844064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa5f9a50>]}
[0m22:37:18.845273 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:37:18.845815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa5f9cd0>]}
[0m22:37:18.847494 [info ] [MainThread]: 
[0m22:37:18.848370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:18.850505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m22:37:18.869164 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m22:37:18.869799 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m22:37:18.870278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:18.877694 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:37:18.880846 [debug] [ThreadPool]: On list_finbest: Close
[0m22:37:18.882863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m22:37:18.888950 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:37:18.889461 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m22:37:18.889940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:18.896352 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.897130 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:37:18.897614 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m22:37:18.900106 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:37:18.901546 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m22:37:18.902123 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m22:37:18.907763 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.908320 [debug] [MainThread]: On master: BEGIN
[0m22:37:18.908717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:18.914657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.915288 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.915779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:37:18.920162 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:37:18.921538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa4f5250>]}
[0m22:37:18.922205 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:18.922811 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.923219 [debug] [MainThread]: On master: BEGIN
[0m22:37:18.923726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.924129 [debug] [MainThread]: On master: COMMIT
[0m22:37:18.924495 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.924862 [debug] [MainThread]: On master: COMMIT
[0m22:37:18.925316 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:37:18.925704 [debug] [MainThread]: On master: Close
[0m22:37:18.926480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:18.926943 [info ] [MainThread]: 
[0m22:37:18.933574 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m22:37:18.934378 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m22:37:18.935036 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m22:37:18.936013 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m22:37:18.936636 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m22:37:18.937212 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m22:37:18.937980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m22:37:18.938855 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m22:37:18.939701 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m22:37:18.940242 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m22:37:18.940841 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m22:37:18.941326 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m22:37:18.949970 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m22:37:18.952754 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m22:37:18.955345 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m22:37:18.956562 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 22:37:18.941716 => 22:37:18.956294
[0m22:37:18.957273 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 22:37:18.950506 => 22:37:18.957033
[0m22:37:18.958011 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m22:37:18.958831 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m22:37:18.959761 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 22:37:18.953302 => 22:37:18.959452
[0m22:37:19.001248 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m22:37:19.074056 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m22:37:19.076355 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m22:37:19.079038 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m22:37:19.080067 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:37:19.080631 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:37:19.081083 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m22:37:19.081545 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m22:37:19.082015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:37:19.082477 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:37:19.082909 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:37:19.083449 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m22:37:19.084045 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:37:19.087519 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:37:19.088126 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:37:19.088598 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:37:19.089178 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m22:37:19.089570 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:37:19.090041 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:37:19.090641 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:37:19.091065 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m22:37:19.091479 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m22:37:19.095375 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m22:37:19.101298 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:37:19.102778 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:37:19.106387 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:37:19.106938 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m22:37:19.107371 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m22:37:19.107843 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:37:19.110731 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:37:19.111377 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m22:37:19.112272 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.113202 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.118477 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:37:19.119286 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.124806 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:37:19.125873 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m22:37:19.131300 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:37:19.132069 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:37:19.132841 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m22:37:19.133690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.140109 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.145921 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.172298 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:37:19.173090 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:37:19.176384 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:37:19.176842 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:37:19.177563 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:37:19.177967 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:37:19.178648 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:37:19.179288 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:37:19.179682 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:37:19.181503 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:37:19.181958 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:37:19.182498 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:37:19.187545 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:37:19.190186 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:37:19.192905 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:37:19.193490 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m22:37:19.194199 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m22:37:19.194805 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m22:37:19.197279 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.198005 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.199972 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 22:37:18.970478 => 22:37:19.199736
[0m22:37:19.200646 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.202234 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 22:37:19.012006 => 22:37:19.202045
[0m22:37:19.202953 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m22:37:19.204825 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 22:37:18.960223 => 22:37:19.204605
[0m22:37:19.205522 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m22:37:19.206237 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m22:37:19.207164 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa6fdc90>]}
[0m22:37:19.208444 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442a8342c10>]}
[0m22:37:19.209591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa5bfc90>]}
[0m22:37:19.210556 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.27s]
[0m22:37:19.211501 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.27s]
[0m22:37:19.212394 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.27s]
[0m22:37:19.213341 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m22:37:19.214103 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m22:37:19.214815 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m22:37:19.215736 [debug] [Thread-1  ]: Began running node model.finbest.int_daily_transactions
[0m22:37:19.216393 [info ] [Thread-1  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m22:37:19.217116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.int_daily_transactions)
[0m22:37:19.217563 [debug] [Thread-1  ]: Began compiling node model.finbest.int_daily_transactions
[0m22:37:19.221567 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m22:37:19.222320 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (compile): 22:37:19.217889 => 22:37:19.222116
[0m22:37:19.222741 [debug] [Thread-1  ]: Began executing node model.finbest.int_daily_transactions
[0m22:37:19.264248 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m22:37:19.265306 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:37:19.265843 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: BEGIN
[0m22:37:19.266228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:37:19.270894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:37:19.271441 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:37:19.271871 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m22:37:19.275906 [debug] [Thread-1  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:37:19.279420 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:37:19.280109 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m22:37:19.281108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.284728 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:37:19.285207 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m22:37:19.285823 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.287941 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:37:19.288358 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:37:19.288732 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:37:19.289986 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:37:19.292556 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:37:19.293008 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m22:37:19.295458 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.297259 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (execute): 22:37:19.223057 => 22:37:19.297031
[0m22:37:19.297769 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: Close
[0m22:37:19.299192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442aa5d0bd0>]}
[0m22:37:19.300169 [info ] [Thread-1  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.08s]
[0m22:37:19.300835 [debug] [Thread-1  ]: Finished running node model.finbest.int_daily_transactions
[0m22:37:19.301579 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m22:37:19.302193 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m22:37:19.302907 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m22:37:19.303339 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m22:37:19.306193 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m22:37:19.306935 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 22:37:19.303637 => 22:37:19.306714
[0m22:37:19.307366 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m22:37:19.311567 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m22:37:19.312463 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:37:19.313232 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m22:37:19.313942 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:37:19.319057 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:37:19.319569 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:37:19.319994 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m22:37:19.324738 [debug] [Thread-2  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:37:19.328017 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:37:19.328484 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m22:37:19.329519 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.333076 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:37:19.333577 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m22:37:19.334273 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:37:19.336381 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:37:19.336827 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:37:19.337228 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:37:19.338383 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:37:19.340853 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:37:19.341274 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m22:37:19.343190 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.344544 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 22:37:19.307665 => 22:37:19.344379
[0m22:37:19.345095 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m22:37:19.346229 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da3f52b-c7c5-4700-8a32-cf891dc659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442a83edf10>]}
[0m22:37:19.347060 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.04s]
[0m22:37:19.347820 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m22:37:19.360940 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:19.361710 [debug] [MainThread]: On master: BEGIN
[0m22:37:19.362513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:19.367727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:19.368224 [debug] [MainThread]: On master: COMMIT
[0m22:37:19.368574 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:19.368911 [debug] [MainThread]: On master: COMMIT
[0m22:37:19.369299 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:37:19.369656 [debug] [MainThread]: On master: Close
[0m22:37:19.370319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:19.370664 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m22:37:19.370981 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m22:37:19.371280 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m22:37:19.371642 [info ] [MainThread]: 
[0m22:37:19.372006 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:37:19.373118 [debug] [MainThread]: Command end result
[0m22:37:19.379093 [info ] [MainThread]: 
[0m22:37:19.379726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:19.380174 [info ] [MainThread]: 
[0m22:37:19.380869 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:37:19.381520 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:19.381413 after 0.71 seconds
[0m22:37:19.381999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442a8caaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442a8caa090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442a8caa750>]}
[0m22:37:19.382408 [debug] [MainThread]: Flushing usage events
[0m22:46:22.639453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb247f25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb247f2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb247f24d0>]}


============================== 22:46:22.658370 | e9ba5589-e525-4246-88da-d6e606d8a357 ==============================
[0m22:46:22.658370 [info ] [MainThread]: Running with dbt=1.5.11
[0m22:46:22.658882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'debug': 'True', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:46:22.713594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb24820310>]}
[0m22:46:22.728164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb247f27d0>]}
[0m22:46:22.729013 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m22:46:22.739685 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m22:46:22.768531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:46:22.769003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:46:22.774663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb20341490>]}
[0m22:46:22.779259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb2178d4d0>]}
[0m22:46:22.779810 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:46:22.780161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb2178d890>]}
[0m22:46:22.781479 [info ] [MainThread]: 
[0m22:46:22.782165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:22.783397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m22:46:22.793142 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m22:46:22.793588 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m22:46:22.793960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:22.805033 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:46:22.806884 [debug] [ThreadPool]: On list_finbest: Close
[0m22:46:22.809182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m22:46:22.816900 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:46:22.817885 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m22:46:22.818633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:22.825456 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:46:22.826130 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:46:22.826713 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m22:46:22.832617 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:46:22.834918 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m22:46:22.835863 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m22:46:22.843927 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:22.844772 [debug] [MainThread]: On master: BEGIN
[0m22:46:22.845513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:22.853089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:22.853724 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:22.854318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:46:22.860938 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:46:22.862077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb21d82650>]}
[0m22:46:22.862615 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:22.863219 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:22.863652 [debug] [MainThread]: On master: BEGIN
[0m22:46:22.864276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:22.864905 [debug] [MainThread]: On master: COMMIT
[0m22:46:22.865299 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:22.865648 [debug] [MainThread]: On master: COMMIT
[0m22:46:22.866090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:46:22.866449 [debug] [MainThread]: On master: Close
[0m22:46:22.867121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:22.867519 [info ] [MainThread]: 
[0m22:46:22.872910 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m22:46:22.873522 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m22:46:22.874169 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m22:46:22.874816 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m22:46:22.875385 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m22:46:22.875933 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m22:46:22.876640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m22:46:22.877434 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m22:46:22.878255 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m22:46:22.878770 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m22:46:22.879278 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m22:46:22.879715 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m22:46:22.886142 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m22:46:22.888338 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m22:46:22.890078 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m22:46:22.890905 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 22:46:22.888777 => 22:46:22.890694
[0m22:46:22.891442 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 22:46:22.886500 => 22:46:22.891248
[0m22:46:22.891968 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m22:46:22.892464 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m22:46:22.898091 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 22:46:22.880075 => 22:46:22.897877
[0m22:46:22.929971 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m22:46:22.954073 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m22:46:22.956606 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m22:46:22.960670 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m22:46:22.961670 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:46:22.962201 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:46:22.962716 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m22:46:22.963215 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m22:46:22.963641 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:46:22.964134 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:46:22.964822 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:46:22.965304 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m22:46:22.966032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:46:22.970004 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:46:22.970601 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:46:22.971054 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:46:22.971577 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:46:22.972023 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:46:22.972583 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m22:46:22.973114 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m22:46:22.973543 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:46:22.974078 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m22:46:22.983752 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m22:46:22.984198 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m22:46:22.984756 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:46:22.991468 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:46:22.994576 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:46:22.998145 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:46:22.998846 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m22:46:22.999335 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m22:46:22.999850 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:46:23.000693 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.001207 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.001646 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.004697 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:46:23.007584 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:46:23.010528 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:46:23.011126 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:46:23.011646 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m22:46:23.012093 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m22:46:23.012886 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.013326 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.013798 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.043541 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:46:23.045376 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:46:23.047544 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:46:23.047999 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:46:23.048457 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:46:23.049030 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:46:23.049466 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:46:23.049946 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:46:23.050399 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:46:23.052472 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:46:23.057404 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:46:23.057988 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m22:46:23.058604 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:46:23.059158 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:46:23.062798 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:46:23.063578 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:46:23.066163 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:46:23.066943 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m22:46:23.068587 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 22:46:22.957016 => 22:46:23.068430
[0m22:46:23.069141 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m22:46:23.069736 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m22:46:23.070897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb1f9490d0>]}
[0m22:46:23.071760 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m22:46:23.072413 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:46:23.073127 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m22:46:23.073695 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:46:23.075129 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 22:46:22.904012 => 22:46:23.074967
[0m22:46:23.076657 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 22:46:22.892812 => 22:46:23.076494
[0m22:46:23.077146 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m22:46:23.077605 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m22:46:23.078400 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb247f2e50>]}
[0m22:46:23.079191 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb202d6d10>]}
[0m22:46:23.079937 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.20s]
[0m22:46:23.080645 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.20s]
[0m22:46:23.081462 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m22:46:23.082269 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m22:46:23.083027 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m22:46:23.083640 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m22:46:23.084391 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m22:46:23.084818 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m22:46:23.087752 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m22:46:23.088502 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 22:46:23.085126 => 22:46:23.088301
[0m22:46:23.088936 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m22:46:23.094248 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m22:46:23.095009 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:46:23.095436 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m22:46:23.095815 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:46:23.100249 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m22:46:23.100744 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:46:23.101165 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m22:46:23.106744 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:46:23.140688 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:46:23.141204 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m22:46:23.142494 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.145135 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:46:23.145521 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m22:46:23.146317 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.148366 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:46:23.148783 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:46:23.149140 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:46:23.150246 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m22:46:23.152615 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:46:23.153036 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m22:46:23.154956 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:46:23.156269 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 22:46:23.089242 => 22:46:23.156120
[0m22:46:23.156673 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m22:46:23.157397 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb21d5e210>]}
[0m22:46:23.158017 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.07s]
[0m22:46:23.158596 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m22:46:23.159388 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m22:46:23.159992 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m22:46:23.160616 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m22:46:23.161029 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m22:46:23.163598 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m22:46:23.164293 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 22:46:23.161333 => 22:46:23.164128
[0m22:46:23.164726 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m22:46:23.168667 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m22:46:23.169266 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:46:23.169677 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m22:46:23.170059 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:46:23.174689 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:46:23.175217 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:46:23.175645 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m22:46:23.180510 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:46:23.184162 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:46:23.184612 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m22:46:23.185275 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.187993 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:46:23.188396 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m22:46:23.189027 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:46:23.191060 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:46:23.191492 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:46:23.191888 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:46:23.192983 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:46:23.195639 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:46:23.196060 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m22:46:23.197851 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:46:23.199189 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 22:46:23.165039 => 22:46:23.199042
[0m22:46:23.199579 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m22:46:23.200294 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9ba5589-e525-4246-88da-d6e606d8a357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb1f902c50>]}
[0m22:46:23.200929 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.04s]
[0m22:46:23.201494 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m22:46:23.275757 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:23.277104 [debug] [MainThread]: On master: BEGIN
[0m22:46:23.278220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:23.289817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:46:23.291047 [debug] [MainThread]: On master: COMMIT
[0m22:46:23.292119 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:23.293137 [debug] [MainThread]: On master: COMMIT
[0m22:46:23.294233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:46:23.295264 [debug] [MainThread]: On master: Close
[0m22:46:23.296970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:23.298030 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m22:46:23.298999 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m22:46:23.299940 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m22:46:23.300756 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m22:46:23.301704 [info ] [MainThread]: 
[0m22:46:23.302578 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:46:23.304686 [debug] [MainThread]: Command end result
[0m22:46:23.310990 [info ] [MainThread]: 
[0m22:46:23.311453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:23.311799 [info ] [MainThread]: 
[0m22:46:23.312170 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:46:23.312665 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:23.312586 after 0.70 seconds
[0m22:46:23.313041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb20295610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb20295210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adb20295a50>]}
[0m22:46:23.313422 [debug] [MainThread]: Flushing usage events
[0m22:55:31.249473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721701071390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216ff6ae1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7217010713d0>]}


============================== 22:55:31.268519 | 57924ef8-4ea7-4fbc-9e5a-a30f23801ae8 ==============================
[0m22:55:31.268519 [info ] [MainThread]: Running with dbt=1.5.11
[0m22:55:31.269066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:55:31.323108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fdf86150>]}
[0m22:55:31.337897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fe603750>]}
[0m22:55:31.338705 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m22:55:31.349855 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m22:55:31.378988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:31.379446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:31.385014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fe51e690>]}
[0m22:55:31.390347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fe531950>]}
[0m22:55:31.390907 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:55:31.391241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fe531210>]}
[0m22:55:31.392510 [info ] [MainThread]: 
[0m22:55:31.393179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:55:31.394436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m22:55:31.404158 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m22:55:31.404603 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m22:55:31.405007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:31.417210 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:55:31.418979 [debug] [ThreadPool]: On list_finbest: Close
[0m22:55:31.421380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m22:55:31.428306 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:55:31.428724 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m22:55:31.429071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:55:31.433994 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.434594 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m22:55:31.435112 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m22:55:31.440576 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:55:31.442499 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m22:55:31.443236 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m22:55:31.450725 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:31.451570 [debug] [MainThread]: On master: BEGIN
[0m22:55:31.452277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:31.459747 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.460380 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:31.460996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:55:31.468324 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:55:31.470290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fcc27d10>]}
[0m22:55:31.471124 [debug] [MainThread]: On master: ROLLBACK
[0m22:55:31.471883 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:31.472497 [debug] [MainThread]: On master: BEGIN
[0m22:55:31.473473 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.474197 [debug] [MainThread]: On master: COMMIT
[0m22:55:31.474687 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:31.475182 [debug] [MainThread]: On master: COMMIT
[0m22:55:31.475862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.476441 [debug] [MainThread]: On master: Close
[0m22:55:31.477327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:31.477706 [info ] [MainThread]: 
[0m22:55:31.482833 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m22:55:31.483391 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m22:55:31.484109 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m22:55:31.484722 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m22:55:31.485289 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m22:55:31.485856 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m22:55:31.486544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m22:55:31.487343 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m22:55:31.488141 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m22:55:31.488620 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m22:55:31.489096 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m22:55:31.489595 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m22:55:31.496020 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m22:55:31.498146 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m22:55:31.499871 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m22:55:31.500820 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 22:55:31.489957 => 22:55:31.500597
[0m22:55:31.501508 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 22:55:31.496367 => 22:55:31.501307
[0m22:55:31.502033 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m22:55:31.502548 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m22:55:31.503105 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 22:55:31.498522 => 22:55:31.502919
[0m22:55:31.559900 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m22:55:31.560523 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m22:55:31.561374 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m22:55:31.565357 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m22:55:31.565933 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:55:31.566684 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:55:31.567474 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m22:55:31.568034 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m22:55:31.568826 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:55:31.569264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:55:31.569755 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:55:31.570421 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m22:55:31.571296 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:55:31.576001 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.576610 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.577117 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:55:31.577665 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:55:31.578221 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.578739 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m22:55:31.579355 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m22:55:31.579996 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:55:31.580705 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m22:55:31.590132 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m22:55:31.590876 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m22:55:31.591672 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m22:55:31.599873 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:55:31.604153 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:55:31.608069 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:55:31.608670 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m22:55:31.609433 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m22:55:31.610046 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m22:55:31.610932 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.611472 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.614529 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:55:31.617470 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:55:31.617939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.618451 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m22:55:31.618892 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m22:55:31.621849 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:55:31.622561 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m22:55:31.623262 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.623834 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.629762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.666122 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:55:31.665512 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:55:31.667668 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:55:31.668224 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:55:31.668701 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:55:31.669152 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:55:31.669608 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m22:55:31.670165 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m22:55:31.670608 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m22:55:31.672395 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.672875 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.673345 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.678332 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m22:55:31.680857 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m22:55:31.683253 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m22:55:31.683803 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m22:55:31.684301 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m22:55:31.684743 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m22:55:31.688017 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:55:31.689503 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 22:55:31.519285 => 22:55:31.689349
[0m22:55:31.690092 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:55:31.690582 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:55:31.691141 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m22:55:31.692438 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 22:55:31.503509 => 22:55:31.692298
[0m22:55:31.693724 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 22:55:31.561788 => 22:55:31.693582
[0m22:55:31.694299 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m22:55:31.695082 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fca11c90>]}
[0m22:55:31.695665 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m22:55:31.696672 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.21s]
[0m22:55:31.697453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fcb6ebd0>]}
[0m22:55:31.698114 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m22:55:31.698896 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fcbeca90>]}
[0m22:55:31.699625 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.21s]
[0m22:55:31.700624 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.21s]
[0m22:55:31.701508 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m22:55:31.702265 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m22:55:31.703081 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m22:55:31.703677 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m22:55:31.704436 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m22:55:31.704859 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m22:55:31.707690 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m22:55:31.708744 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 22:55:31.705169 => 22:55:31.708543
[0m22:55:31.709161 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m22:55:31.714218 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m22:55:31.715303 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:55:31.715741 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m22:55:31.716116 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:55:31.720821 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.721330 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:55:31.721747 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m22:55:31.727289 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:55:31.761072 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:55:31.761556 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m22:55:31.762389 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.765037 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:55:31.765438 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m22:55:31.766132 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.768278 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:55:31.768673 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:55:31.769051 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m22:55:31.771112 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.773375 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m22:55:31.773774 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m22:55:31.775969 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:55:31.777226 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 22:55:31.709437 => 22:55:31.777081
[0m22:55:31.777620 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m22:55:31.778326 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fe8a9990>]}
[0m22:55:31.778928 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.07s]
[0m22:55:31.779485 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m22:55:31.780216 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m22:55:31.780809 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m22:55:31.781435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m22:55:31.781847 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m22:55:31.784509 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m22:55:31.785451 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 22:55:31.782153 => 22:55:31.785245
[0m22:55:31.785887 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m22:55:31.789869 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m22:55:31.791211 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:55:31.791592 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m22:55:31.791952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:55:31.796646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.797172 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:55:31.797613 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m22:55:31.803742 [debug] [Thread-1  ]: SQL status: SELECT 493 in 0.0 seconds
[0m22:55:31.807749 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:55:31.808223 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m22:55:31.809024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.811833 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:55:31.812250 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m22:55:31.812939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:55:31.814963 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:55:31.815364 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:55:31.815742 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m22:55:31.817170 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.819543 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m22:55:31.819982 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m22:55:31.821989 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:55:31.823272 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 22:55:31.786177 => 22:55:31.823126
[0m22:55:31.823669 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m22:55:31.824396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57924ef8-4ea7-4fbc-9e5a-a30f23801ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fe8a9a10>]}
[0m22:55:31.825043 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.04s]
[0m22:55:31.825593 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m22:55:31.886857 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:31.888091 [debug] [MainThread]: On master: BEGIN
[0m22:55:31.889094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:31.899654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:55:31.900935 [debug] [MainThread]: On master: COMMIT
[0m22:55:31.901942 [debug] [MainThread]: Using postgres connection "master"
[0m22:55:31.902933 [debug] [MainThread]: On master: COMMIT
[0m22:55:31.903999 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:55:31.904939 [debug] [MainThread]: On master: Close
[0m22:55:31.906486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:31.907408 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m22:55:31.908229 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m22:55:31.908981 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m22:55:31.909705 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m22:55:31.910551 [info ] [MainThread]: 
[0m22:55:31.911235 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:55:31.913068 [debug] [MainThread]: Command end result
[0m22:55:31.918934 [info ] [MainThread]: 
[0m22:55:31.919423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:55:31.919771 [info ] [MainThread]: 
[0m22:55:31.920101 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:55:31.920578 [debug] [MainThread]: Command `dbt run` succeeded at 22:55:31.920495 after 0.68 seconds
[0m22:55:31.920966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72170109f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216ff7592d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216fcad0950>]}
[0m22:55:31.921323 [debug] [MainThread]: Flushing usage events
[0m14:23:03.042111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55744510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55744b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55744410>]}


============================== 14:23:03.418959 | 1c70ed35-d6fb-453d-942c-f8a3ff4051ce ==============================
[0m14:23:03.418959 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:23:03.420237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:23:03.558083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55773910>]}
[0m14:23:03.586665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55766890>]}
[0m14:23:03.588181 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:23:03.606773 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:23:03.658954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:03.659528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:03.665684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf512a5390>]}
[0m14:23:03.671205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf526f1590>]}
[0m14:23:03.671883 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:23:03.672319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf526f16d0>]}
[0m14:23:03.673903 [info ] [MainThread]: 
[0m14:23:03.674770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:03.676235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:23:03.686988 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:23:03.687510 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:23:03.687889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:03.698607 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:23:03.700026 [debug] [ThreadPool]: On list_finbest: Close
[0m14:23:03.702039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m14:23:03.707912 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:23:03.708441 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:23:03.708830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:03.713427 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:23:03.714288 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:23:03.715008 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:23:03.722916 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:23:03.725220 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:23:03.726079 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:23:03.735440 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:03.736411 [debug] [MainThread]: On master: BEGIN
[0m14:23:03.737087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:03.742389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:03.742937 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:03.743403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:03.751375 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:23:03.752657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf52705b90>]}
[0m14:23:03.753250 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:03.753890 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:03.754310 [debug] [MainThread]: On master: BEGIN
[0m14:23:03.754846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:03.755229 [debug] [MainThread]: On master: COMMIT
[0m14:23:03.755584 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:03.755953 [debug] [MainThread]: On master: COMMIT
[0m14:23:03.756531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:03.756950 [debug] [MainThread]: On master: Close
[0m14:23:03.757680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:03.758070 [info ] [MainThread]: 
[0m14:23:03.762969 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:23:03.763600 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:23:03.764439 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:23:03.764994 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:23:03.765587 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:23:03.766335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:23:03.766914 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:23:03.767729 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m14:23:03.768181 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:23:03.768971 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:23:03.769485 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:23:03.775925 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:23:03.776445 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:23:03.778809 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:23:03.780834 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:23:03.781717 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:23:03.769819 => 14:23:03.781485
[0m14:23:03.782186 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:23:03.793158 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:23:03.776802 => 14:23:03.792803
[0m14:23:03.798976 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:23:03.820653 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:23:03.779347 => 14:23:03.820229
[0m14:23:03.832149 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:23:03.863004 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:23:03.867822 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:23:03.869939 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:23:03.870890 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:23:03.871719 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:23:03.872559 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:23:03.873191 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:23:03.873934 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:23:03.874548 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:23:03.875591 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:23:03.876252 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:23:03.877018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:03.880544 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:23:03.881188 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:23:03.881710 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:23:03.882755 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:23:03.883439 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:23:03.884119 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:23:03.884946 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:23:03.885533 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:23:03.885972 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:23:03.891766 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m14:23:03.892249 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:23:03.892794 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:23:03.899834 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:23:03.903558 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:23:03.907590 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:23:03.908124 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:23:03.908723 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:23:03.909216 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:23:03.910436 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:03.911023 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:03.914882 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:23:03.915592 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:03.919749 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:23:03.920644 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:23:03.925404 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:23:03.926241 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:23:03.927151 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:23:03.927892 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:03.934282 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:03.940371 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:03.966045 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:23:03.967647 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:23:03.968207 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:23:03.972804 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:23:03.973152 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:23:03.973790 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:23:03.974313 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:23:03.974883 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:23:03.975546 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:23:03.976218 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:23:03.981176 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:23:03.981739 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:23:03.982242 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:23:03.982746 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:23:03.985149 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:23:03.988861 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:23:03.989542 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:23:03.989905 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:23:03.990626 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:23:03.993237 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:23:03.838419 => 14:23:03.992897
[0m14:23:03.993937 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:23:03.994379 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:23:03.996247 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:23:03.804714 => 14:23:03.996030
[0m14:23:03.996843 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:23:03.997417 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:23:03.998473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf50a47750>]}
[0m14:23:04.000000 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:23:03.782559 => 14:23:03.999833
[0m14:23:04.001366 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf50a47f90>]}
[0m14:23:04.002078 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.23s]
[0m14:23:04.002644 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:23:04.003327 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.23s]
[0m14:23:04.003994 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:23:04.004669 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:23:04.005535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf501e8950>]}
[0m14:23:04.006485 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.24s]
[0m14:23:04.007253 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:23:04.007758 [debug] [Thread-1  ]: Began running node model.finbest.int_daily_transactions
[0m14:23:04.008286 [info ] [Thread-1  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:23:04.009010 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.int_daily_transactions)
[0m14:23:04.009432 [debug] [Thread-1  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:23:04.012221 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:23:04.012963 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:23:04.009733 => 14:23:04.012763
[0m14:23:04.013408 [debug] [Thread-1  ]: Began executing node model.finbest.int_daily_transactions
[0m14:23:04.019868 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:23:04.021191 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:23:04.022277 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:23:04.023213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:23:04.029720 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:23:04.030311 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:23:04.030748 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:23:04.039464 [debug] [Thread-1  ]: SQL status: SELECT 493 in 0.0 seconds
[0m14:23:04.083967 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:23:04.084488 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:23:04.085436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:04.088973 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:23:04.089630 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:23:04.090511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:04.092755 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:23:04.093178 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:23:04.093559 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:23:04.095420 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:23:04.097847 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:23:04.098231 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:23:04.100816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:23:04.102155 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:23:04.013719 => 14:23:04.102006
[0m14:23:04.102586 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: Close
[0m14:23:04.103295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf50a17e90>]}
[0m14:23:04.103905 [info ] [Thread-1  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.09s]
[0m14:23:04.104496 [debug] [Thread-1  ]: Finished running node model.finbest.int_daily_transactions
[0m14:23:04.105176 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m14:23:04.105792 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:23:04.106484 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m14:23:04.106998 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m14:23:04.110615 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:23:04.111432 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 14:23:04.107397 => 14:23:04.111205
[0m14:23:04.111874 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m14:23:04.115787 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:23:04.116445 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:23:04.116858 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:23:04.117237 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:23:04.121776 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:23:04.122284 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:23:04.122700 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:23:04.128401 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m14:23:04.131672 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:23:04.132179 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:23:04.132927 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:04.135625 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:23:04.136028 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:23:04.136713 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:04.138758 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:23:04.139182 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:23:04.139595 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:23:04.140795 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:23:04.144552 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:23:04.145047 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:23:04.149810 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:23:04.151384 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 14:23:04.112182 => 14:23:04.151202
[0m14:23:04.151838 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m14:23:04.152590 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c70ed35-d6fb-453d-942c-f8a3ff4051ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf50a37490>]}
[0m14:23:04.153564 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.05s]
[0m14:23:04.154575 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m14:23:04.184060 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:04.184642 [debug] [MainThread]: On master: BEGIN
[0m14:23:04.185029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:04.189608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:04.190119 [debug] [MainThread]: On master: COMMIT
[0m14:23:04.190508 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:04.190860 [debug] [MainThread]: On master: COMMIT
[0m14:23:04.191407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:04.191775 [debug] [MainThread]: On master: Close
[0m14:23:04.192421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:04.192808 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:23:04.193194 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:23:04.193641 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:23:04.194219 [info ] [MainThread]: 
[0m14:23:04.194827 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:23:04.196219 [debug] [MainThread]: Command end result
[0m14:23:04.201573 [info ] [MainThread]: 
[0m14:23:04.202070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:04.202429 [info ] [MainThread]: 
[0m14:23:04.202762 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:23:04.203251 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:04.203174 after 1.18 seconds
[0m14:23:04.203652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55744890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55744b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbf55744cd0>]}
[0m14:23:04.204060 [debug] [MainThread]: Flushing usage events
[0m14:46:05.316764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e57e5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e57e5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e57e5410>]}


============================== 14:46:05.337455 | 03de76ff-cb39-4998-9d17-f52de8f45431 ==============================
[0m14:46:05.337455 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:46:05.337991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:46:05.394477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e5b8ad90>]}
[0m14:46:05.410112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e5813910>]}
[0m14:46:05.411092 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:46:05.422184 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:46:05.449424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:05.449915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:05.455514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e2d79590>]}
[0m14:46:05.461340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e2790bd0>]}
[0m14:46:05.461929 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:46:05.462308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e2790f10>]}
[0m14:46:05.463700 [info ] [MainThread]: 
[0m14:46:05.464421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:05.465665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:46:05.475882 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:46:05.476361 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:46:05.476732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:05.487605 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:46:05.489259 [debug] [ThreadPool]: On list_finbest: Close
[0m14:46:05.491147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m14:46:05.497945 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:46:05.498620 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:46:05.499176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:05.506170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.506847 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:46:05.507498 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:46:05.513862 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:46:05.515213 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:46:05.515709 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:46:05.522696 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:05.523538 [debug] [MainThread]: On master: BEGIN
[0m14:46:05.524143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:05.530824 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.531867 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:05.532643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:46:05.539504 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:46:05.541932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e1350cd0>]}
[0m14:46:05.542967 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:05.543758 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:05.544346 [debug] [MainThread]: On master: BEGIN
[0m14:46:05.545240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.545774 [debug] [MainThread]: On master: COMMIT
[0m14:46:05.546160 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:05.546537 [debug] [MainThread]: On master: COMMIT
[0m14:46:05.547067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.547547 [debug] [MainThread]: On master: Close
[0m14:46:05.548237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:46:05.548613 [info ] [MainThread]: 
[0m14:46:05.553354 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:46:05.553906 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:46:05.554470 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:46:05.554946 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:46:05.555789 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:46:05.556715 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:46:05.557450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:46:05.558126 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m14:46:05.558910 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:46:05.559393 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:46:05.559810 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:46:05.560246 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:46:05.566740 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:46:05.569078 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:46:05.570796 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:46:05.572175 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:46:05.569456 => 14:46:05.571969
[0m14:46:05.572728 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:46:05.567223 => 14:46:05.572526
[0m14:46:05.573214 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:46:05.573857 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:46:05.560596 => 14:46:05.573694
[0m14:46:05.574295 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:46:05.585357 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:46:05.630872 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:46:05.631597 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:46:05.636423 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:46:05.637253 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:05.637756 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:46:05.638231 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:05.638661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:46:05.639188 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:05.639717 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:46:05.640329 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:46:05.640932 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:46:05.641393 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:46:05.644778 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.645449 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:05.645991 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:46:05.646482 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.647072 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:05.647526 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.647993 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:46:05.648457 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:05.648901 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:46:05.657120 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m14:46:05.657561 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:46:05.658222 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:46:05.664891 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:05.668330 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:05.672190 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:05.672796 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:46:05.673202 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:46:05.673818 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:46:05.675306 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.675936 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.676567 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.679642 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:05.682523 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:05.685725 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:05.686294 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:46:05.686851 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:46:05.687355 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:46:05.688115 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.688582 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.694222 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.730803 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:46:05.733123 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:46:05.735257 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:46:05.735735 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:05.736269 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:05.736690 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:05.737150 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:46:05.737698 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:46:05.738124 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:46:05.739689 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.740171 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.740801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.746171 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:46:05.749088 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:46:05.751811 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:46:05.752277 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:46:05.752780 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:46:05.753300 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:46:05.756420 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:05.758216 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:46:05.590994 => 14:46:05.758025
[0m14:46:05.758927 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:05.759604 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:46:05.760156 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:05.761631 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:46:05.574698 => 14:46:05.761468
[0m14:46:05.763147 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:46:05.606363 => 14:46:05.762975
[0m14:46:05.763963 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e1328b90>]}
[0m14:46:05.764464 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:46:05.764964 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:46:05.765660 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.21s]
[0m14:46:05.766436 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e1321f90>]}
[0m14:46:05.767284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e02d5150>]}
[0m14:46:05.767821 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:46:05.768579 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.21s]
[0m14:46:05.769088 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.21s]
[0m14:46:05.770121 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:46:05.770699 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:46:05.771419 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:46:05.772000 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:46:05.772872 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:46:05.773321 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:46:05.776239 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:46:05.776961 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:46:05.773643 => 14:46:05.776764
[0m14:46:05.777384 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:46:05.816372 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:46:05.817136 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:05.817590 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:46:05.817972 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:46:05.822431 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.822952 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:05.823392 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:46:05.829518 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m14:46:05.832744 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:05.833210 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:46:05.834101 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.836952 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:05.837396 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:46:05.837998 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.840268 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:46:05.840686 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:05.841048 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:46:05.842244 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.844672 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:46:05.845087 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:46:05.846876 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:05.848158 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:46:05.777686 => 14:46:05.848009
[0m14:46:05.848578 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:46:05.849296 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e2f171d0>]}
[0m14:46:05.849922 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.08s]
[0m14:46:05.850540 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:46:05.851303 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m14:46:05.851863 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:46:05.852489 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m14:46:05.852906 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m14:46:05.855583 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:46:05.856303 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 14:46:05.853210 => 14:46:05.856108
[0m14:46:05.856719 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m14:46:05.861365 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:46:05.862107 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:05.862565 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:46:05.862949 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:46:05.867604 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.868127 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:05.868590 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:46:05.876260 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m14:46:05.882254 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:05.883143 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:46:05.884399 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.888203 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:05.888732 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:46:05.889458 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:05.891802 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:46:05.892239 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:05.892792 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:46:05.894351 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.897162 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:46:05.897693 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:46:05.899695 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:05.901182 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 14:46:05.857029 => 14:46:05.901005
[0m14:46:05.901673 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m14:46:05.902699 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de76ff-cb39-4998-9d17-f52de8f45431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e02b4890>]}
[0m14:46:05.903595 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.05s]
[0m14:46:05.904430 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m14:46:05.958202 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:05.959559 [debug] [MainThread]: On master: BEGIN
[0m14:46:05.960521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:05.971483 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:05.972649 [debug] [MainThread]: On master: COMMIT
[0m14:46:05.973613 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:05.974554 [debug] [MainThread]: On master: COMMIT
[0m14:46:05.975743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:46:05.976782 [debug] [MainThread]: On master: Close
[0m14:46:05.978118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:05.978880 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:46:05.979585 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m14:46:05.980099 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:46:05.980609 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:46:05.981200 [info ] [MainThread]: 
[0m14:46:05.981779 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:46:05.983300 [debug] [MainThread]: Command end result
[0m14:46:05.988551 [info ] [MainThread]: 
[0m14:46:05.989016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:05.989390 [info ] [MainThread]: 
[0m14:46:05.989742 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:46:05.990257 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:05.990179 after 0.69 seconds
[0m14:46:05.990627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e57e57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e57e5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab2e2d72690>]}
[0m14:46:05.990997 [debug] [MainThread]: Flushing usage events
[0m04:53:10.719470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e207e43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e207e4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e207e4410>]}


============================== 04:53:10.752388 | 53694393-6e39-47c9-8584-68b505ee8503 ==============================
[0m04:53:10.752388 [info ] [MainThread]: Running with dbt=1.5.11
[0m04:53:10.753331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:53:10.842720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e20812890>]}
[0m04:53:10.859591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e207e4dd0>]}
[0m04:53:10.860779 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m04:53:10.872101 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m04:53:10.902707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:53:10.903164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:53:10.910185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1c38c290>]}
[0m04:53:10.916001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1d7d0f90>]}
[0m04:53:10.916805 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m04:53:10.917396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1d7d0890>]}
[0m04:53:10.919399 [info ] [MainThread]: 
[0m04:53:10.920495 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:53:10.922751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m04:53:10.933722 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m04:53:10.934229 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m04:53:10.934604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:53:10.946291 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m04:53:10.947780 [debug] [ThreadPool]: On list_finbest: Close
[0m04:53:10.949610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m04:53:10.956473 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m04:53:10.957657 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m04:53:10.958225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:53:10.962758 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m04:53:10.963222 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m04:53:10.963592 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m04:53:10.972210 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m04:53:10.974813 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m04:53:10.975488 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m04:53:10.981029 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:10.981541 [debug] [MainThread]: On master: BEGIN
[0m04:53:10.981933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:53:10.986300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:53:10.986780 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:10.987271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:53:10.994236 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m04:53:10.995495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1d78e5d0>]}
[0m04:53:10.996040 [debug] [MainThread]: On master: ROLLBACK
[0m04:53:10.996522 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:10.996880 [debug] [MainThread]: On master: BEGIN
[0m04:53:10.997342 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:53:10.997719 [debug] [MainThread]: On master: COMMIT
[0m04:53:10.998053 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:10.998386 [debug] [MainThread]: On master: COMMIT
[0m04:53:10.998777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:53:10.999122 [debug] [MainThread]: On master: Close
[0m04:53:10.999787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:53:11.000140 [info ] [MainThread]: 
[0m04:53:11.005518 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m04:53:11.006287 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m04:53:11.007147 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m04:53:11.008134 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m04:53:11.008917 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m04:53:11.009701 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m04:53:11.010470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m04:53:11.011280 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m04:53:11.012043 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m04:53:11.012519 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m04:53:11.012970 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m04:53:11.013426 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m04:53:11.020015 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m04:53:11.022713 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m04:53:11.025012 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m04:53:11.025893 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 04:53:11.020408 => 04:53:11.025673
[0m04:53:11.026362 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m04:53:11.038474 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 04:53:11.023435 => 04:53:11.038004
[0m04:53:11.044474 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 04:53:11.013794 => 04:53:11.044182
[0m04:53:11.050254 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m04:53:11.066029 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m04:53:11.069965 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m04:53:11.075929 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m04:53:11.080525 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m04:53:11.081644 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m04:53:11.082168 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m04:53:11.082587 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m04:53:11.083157 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m04:53:11.083625 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m04:53:11.084084 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m04:53:11.084551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:53:11.084988 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m04:53:11.085533 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:53:11.087195 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m04:53:11.087964 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m04:53:11.088738 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m04:53:11.090173 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m04:53:11.090883 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m04:53:11.091471 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m04:53:11.091985 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m04:53:11.092513 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m04:53:11.093023 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m04:53:11.103218 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m04:53:11.103761 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m04:53:11.111210 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m04:53:11.111622 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m04:53:11.114545 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m04:53:11.115088 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m04:53:11.118884 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m04:53:11.119875 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m04:53:11.120629 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m04:53:11.121189 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.125713 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m04:53:11.126317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.126919 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m04:53:11.127443 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.130308 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m04:53:11.133429 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m04:53:11.133956 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.134605 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m04:53:11.135233 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m04:53:11.156618 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.158183 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m04:53:11.160739 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m04:53:11.161188 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.161652 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m04:53:11.162108 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m04:53:11.164218 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m04:53:11.164680 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m04:53:11.165132 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m04:53:11.165659 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m04:53:11.166278 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m04:53:11.167115 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m04:53:11.172935 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m04:53:11.173647 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:53:11.174036 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m04:53:11.176592 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m04:53:11.178995 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m04:53:11.179612 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m04:53:11.180561 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m04:53:11.181152 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m04:53:11.184563 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m04:53:11.186091 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 04:53:11.026732 => 04:53:11.185917
[0m04:53:11.186447 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m04:53:11.187106 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m04:53:11.187679 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m04:53:11.189967 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 04:53:11.070567 => 04:53:11.189783
[0m04:53:11.191729 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 04:53:11.076679 => 04:53:11.191556
[0m04:53:11.192294 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m04:53:11.193271 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1c366310>]}
[0m04:53:11.193923 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m04:53:11.194655 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.18s]
[0m04:53:11.195389 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e18aafc10>]}
[0m04:53:11.196208 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m04:53:11.196955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1c3588d0>]}
[0m04:53:11.197702 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.18s]
[0m04:53:11.198699 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m04:53:11.199363 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m04:53:11.199980 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m04:53:11.200728 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m04:53:11.201254 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m04:53:11.201956 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m04:53:11.202366 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m04:53:11.205473 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m04:53:11.206659 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 04:53:11.202668 => 04:53:11.206407
[0m04:53:11.207197 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m04:53:11.211634 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m04:53:11.212355 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m04:53:11.212802 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m04:53:11.213198 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:53:11.217733 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m04:53:11.218244 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m04:53:11.218678 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m04:53:11.225530 [debug] [Thread-4  ]: SQL status: SELECT 493 in 0.0 seconds
[0m04:53:11.229981 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m04:53:11.230494 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m04:53:11.231149 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.270579 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m04:53:11.271083 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m04:53:11.272136 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.274830 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m04:53:11.275339 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m04:53:11.275740 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m04:53:11.277073 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m04:53:11.279640 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m04:53:11.280061 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m04:53:11.282185 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m04:53:11.283554 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 04:53:11.207574 => 04:53:11.283405
[0m04:53:11.283967 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m04:53:11.284683 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1d796690>]}
[0m04:53:11.285308 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 493[0m in 0.08s]
[0m04:53:11.285878 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m04:53:11.286586 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m04:53:11.287074 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m04:53:11.287729 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m04:53:11.288174 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m04:53:11.291652 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m04:53:11.292460 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 04:53:11.288667 => 04:53:11.292235
[0m04:53:11.292899 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m04:53:11.297062 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m04:53:11.297736 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m04:53:11.298165 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m04:53:11.298552 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m04:53:11.303091 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m04:53:11.303636 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m04:53:11.304207 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m04:53:11.310313 [debug] [Thread-3  ]: SQL status: SELECT 493 in 0.0 seconds
[0m04:53:11.313565 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m04:53:11.314045 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m04:53:11.314704 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.317572 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m04:53:11.318043 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m04:53:11.318601 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:11.320580 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m04:53:11.320990 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m04:53:11.321380 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m04:53:11.322668 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m04:53:11.326180 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m04:53:11.326667 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m04:53:11.328694 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m04:53:11.330032 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 04:53:11.293202 => 04:53:11.329883
[0m04:53:11.330462 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m04:53:11.331227 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53694393-6e39-47c9-8584-68b505ee8503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e189dfbd0>]}
[0m04:53:11.332003 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 493[0m in 0.04s]
[0m04:53:11.332595 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m04:53:11.419912 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:11.421124 [debug] [MainThread]: On master: BEGIN
[0m04:53:11.422161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:53:11.431350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:53:11.431887 [debug] [MainThread]: On master: COMMIT
[0m04:53:11.432292 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:11.432650 [debug] [MainThread]: On master: COMMIT
[0m04:53:11.433085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:53:11.433467 [debug] [MainThread]: On master: Close
[0m04:53:11.434306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:53:11.434865 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m04:53:11.435376 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m04:53:11.435830 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m04:53:11.436223 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m04:53:11.436626 [info ] [MainThread]: 
[0m04:53:11.436967 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m04:53:11.438124 [debug] [MainThread]: Command end result
[0m04:53:11.444237 [info ] [MainThread]: 
[0m04:53:11.444779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:53:11.445168 [info ] [MainThread]: 
[0m04:53:11.445556 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:53:11.446163 [debug] [MainThread]: Command `dbt run` succeeded at 04:53:11.446051 after 0.74 seconds
[0m04:53:11.446587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e207e47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e207e4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e1d7ba910>]}
[0m04:53:11.446985 [debug] [MainThread]: Flushing usage events
[0m05:30:26.529054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563e590>]}


============================== 05:30:26.543770 | fa8c8f93-f121-48d7-8099-cc9851219b5a ==============================
[0m05:30:26.543770 [info ] [MainThread]: Running with dbt=1.5.11
[0m05:30:26.544371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:30:26.596333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f2548690>]}
[0m05:30:26.611057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563e790>]}
[0m05:30:26.611860 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m05:30:26.621802 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m05:30:26.645447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:30:26.645888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:30:26.651286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f1199a90>]}
[0m05:30:26.657393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f25eaa90>]}
[0m05:30:26.657926 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m05:30:26.658291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f25ea290>]}
[0m05:30:26.659606 [info ] [MainThread]: 
[0m05:30:26.660272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:30:26.661583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m05:30:26.671179 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m05:30:26.671592 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m05:30:26.671940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:26.677852 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m05:30:26.679168 [debug] [ThreadPool]: On list_finbest: Close
[0m05:30:26.680864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m05:30:26.686353 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m05:30:26.686776 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m05:30:26.687116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:26.691461 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.691927 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m05:30:26.692294 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m05:30:26.694474 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:30:26.695616 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m05:30:26.696101 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m05:30:26.700835 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:26.701286 [debug] [MainThread]: On master: BEGIN
[0m05:30:26.701639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:30:26.706218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.706774 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:26.707211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:30:26.711331 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m05:30:26.712819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f25f3090>]}
[0m05:30:26.713558 [debug] [MainThread]: On master: ROLLBACK
[0m05:30:26.714216 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:26.714671 [debug] [MainThread]: On master: BEGIN
[0m05:30:26.715187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.715658 [debug] [MainThread]: On master: COMMIT
[0m05:30:26.716078 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:26.716489 [debug] [MainThread]: On master: COMMIT
[0m05:30:26.716952 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:30:26.717314 [debug] [MainThread]: On master: Close
[0m05:30:26.717975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:30:26.718366 [info ] [MainThread]: 
[0m05:30:26.723118 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m05:30:26.723531 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m05:30:26.724147 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m05:30:26.724850 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m05:30:26.725646 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m05:30:26.726231 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m05:30:26.726922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m05:30:26.727737 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m05:30:26.728506 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m05:30:26.728979 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m05:30:26.729456 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m05:30:26.729907 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m05:30:26.736796 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m05:30:26.738526 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m05:30:26.740165 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m05:30:26.740986 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 05:30:26.730268 => 05:30:26.740789
[0m05:30:26.741679 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m05:30:26.742304 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 05:30:26.737164 => 05:30:26.742057
[0m05:30:26.753576 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m05:30:26.754187 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 05:30:26.738967 => 05:30:26.753979
[0m05:30:26.775063 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m05:30:26.794652 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m05:30:26.797985 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m05:30:26.802123 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m05:30:26.802989 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m05:30:26.803396 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m05:30:26.803893 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m05:30:26.805116 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m05:30:26.805787 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m05:30:26.806476 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m05:30:26.807064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:26.807773 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:30:26.808431 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:30:26.815543 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.816428 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.816917 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m05:30:26.817426 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.817960 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m05:30:26.818438 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m05:30:26.818866 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m05:30:26.819324 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m05:30:26.819847 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m05:30:26.822794 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m05:30:26.829169 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m05:30:26.829594 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m05:30:26.830019 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m05:30:26.833603 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m05:30:26.834394 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m05:30:26.837117 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m05:30:26.837675 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m05:30:26.838343 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m05:30:26.838824 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:30:26.844734 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:30:26.864485 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m05:30:26.866869 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m05:30:26.867358 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m05:30:26.867912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:30:26.868348 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m05:30:26.868810 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m05:30:26.870779 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m05:30:26.871258 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m05:30:26.871798 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m05:30:26.872335 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m05:30:26.872740 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m05:30:26.873171 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m05:30:26.878100 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m05:30:26.878570 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m05:30:26.880879 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m05:30:26.881384 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m05:30:26.883579 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m05:30:26.884052 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m05:30:26.884626 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m05:30:26.885085 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m05:30:26.886779 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 05:30:26.785750 => 05:30:26.886624
[0m05:30:26.887231 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m05:30:26.887780 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m05:30:26.888294 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m05:30:26.889639 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 05:30:26.764664 => 05:30:26.889495
[0m05:30:26.890880 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 05:30:26.742506 => 05:30:26.890738
[0m05:30:26.891649 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f1174090>]}
[0m05:30:26.892138 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m05:30:26.892702 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m05:30:26.893373 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.16s]
[0m05:30:26.894081 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m05:30:26.894870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f0932f90>]}
[0m05:30:26.895752 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f1174550>]}
[0m05:30:26.896652 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.17s]
[0m05:30:26.897202 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m05:30:26.897854 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.17s]
[0m05:30:26.898463 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m05:30:26.899008 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m05:30:26.899636 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m05:30:26.900485 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m05:30:26.901007 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m05:30:26.903800 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m05:30:26.904538 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 05:30:26.901355 => 05:30:26.904315
[0m05:30:26.904984 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m05:30:26.909052 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m05:30:26.909780 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m05:30:26.910298 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m05:30:26.910763 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:30:26.915968 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.916542 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m05:30:26.917017 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m05:30:26.921304 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m05:30:26.924453 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m05:30:26.924979 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m05:30:26.925714 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:30:26.927690 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m05:30:26.928118 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m05:30:26.928557 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m05:30:26.929837 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m05:30:26.932888 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m05:30:26.933327 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m05:30:26.933989 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m05:30:26.935224 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 05:30:26.905318 => 05:30:26.935078
[0m05:30:26.935628 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m05:30:26.936331 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f08dda10>]}
[0m05:30:26.936958 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.04s]
[0m05:30:26.937563 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m05:30:26.938373 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m05:30:26.938927 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m05:30:26.939564 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m05:30:26.939985 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m05:30:26.973190 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m05:30:26.973981 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 05:30:26.940301 => 05:30:26.973755
[0m05:30:26.974422 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m05:30:26.978127 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m05:30:26.978753 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m05:30:26.979138 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m05:30:26.979507 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m05:30:26.984217 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m05:30:26.984745 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m05:30:26.985165 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m05:30:26.990042 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m05:30:26.992837 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m05:30:26.993254 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m05:30:26.993847 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:30:26.995685 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m05:30:26.996083 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m05:30:26.996476 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m05:30:26.997517 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m05:30:26.999819 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m05:30:27.000255 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m05:30:27.001062 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m05:30:27.003147 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 05:30:26.974710 => 05:30:27.002981
[0m05:30:27.003607 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m05:30:27.004325 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa8c8f93-f121-48d7-8099-cc9851219b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f08dd4d0>]}
[0m05:30:27.004936 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.06s]
[0m05:30:27.005683 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m05:30:27.026395 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:27.027183 [debug] [MainThread]: On master: BEGIN
[0m05:30:27.027832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:30:27.036490 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:27.037615 [debug] [MainThread]: On master: COMMIT
[0m05:30:27.038521 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:27.039367 [debug] [MainThread]: On master: COMMIT
[0m05:30:27.040362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:30:27.041352 [debug] [MainThread]: On master: Close
[0m05:30:27.042991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:27.043943 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m05:30:27.044798 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m05:30:27.045636 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m05:30:27.046383 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m05:30:27.047103 [info ] [MainThread]: 
[0m05:30:27.047784 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m05:30:27.049668 [debug] [MainThread]: Command end result
[0m05:30:27.054545 [info ] [MainThread]: 
[0m05:30:27.055013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:30:27.055383 [info ] [MainThread]: 
[0m05:30:27.055755 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:30:27.056293 [debug] [MainThread]: Command `dbt run` succeeded at 05:30:27.056201 after 0.54 seconds
[0m05:30:27.056669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c35f563e990>]}
[0m05:30:27.057040 [debug] [MainThread]: Flushing usage events
[0m07:31:11.707473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee255290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee255110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee255950>]}


============================== 07:31:11.712425 | 45ae4630-8b2c-4160-9898-ba78532d3f85 ==============================
[0m07:31:11.712425 [info ] [MainThread]: Running with dbt=1.5.11
[0m07:31:11.712949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:31:11.765596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee287710>]}
[0m07:31:11.779991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee24bcd0>]}
[0m07:31:11.780783 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m07:31:11.790909 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m07:31:11.815968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:11.816420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:11.821975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e9eabf90>]}
[0m07:31:11.826524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e9ee2610>]}
[0m07:31:11.827021 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m07:31:11.827396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e9ee2f10>]}
[0m07:31:11.828748 [info ] [MainThread]: 
[0m07:31:11.829431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:11.830752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m07:31:11.840636 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m07:31:11.841084 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m07:31:11.841462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:11.848391 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m07:31:11.849780 [debug] [ThreadPool]: On list_finbest: Close
[0m07:31:11.851716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m07:31:11.857627 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m07:31:11.858092 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m07:31:11.858470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:11.863360 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:31:11.864012 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m07:31:11.864608 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m07:31:11.867502 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m07:31:11.869161 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m07:31:11.869899 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m07:31:11.876372 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:11.877047 [debug] [MainThread]: On master: BEGIN
[0m07:31:11.877626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:11.884109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:31:11.884832 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:11.885432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:11.890509 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:31:11.892062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e9e92e10>]}
[0m07:31:11.892876 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:11.893758 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:11.894442 [debug] [MainThread]: On master: BEGIN
[0m07:31:11.895226 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:31:11.895755 [debug] [MainThread]: On master: COMMIT
[0m07:31:11.896215 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:11.896666 [debug] [MainThread]: On master: COMMIT
[0m07:31:11.897279 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:31:11.897753 [debug] [MainThread]: On master: Close
[0m07:31:11.898454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:11.898829 [info ] [MainThread]: 
[0m07:31:11.903702 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m07:31:11.904271 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m07:31:11.905056 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m07:31:11.905583 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m07:31:11.906182 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m07:31:11.906877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m07:31:11.907450 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m07:31:11.908157 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m07:31:11.908661 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m07:31:11.909388 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m07:31:11.909880 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m07:31:11.917627 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m07:31:11.918204 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m07:31:11.920479 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m07:31:11.922375 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m07:31:11.923302 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 07:31:11.910250 => 07:31:11.923051
[0m07:31:11.923822 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m07:31:11.935725 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 07:31:11.920985 => 07:31:11.935478
[0m07:31:11.941590 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m07:31:11.963063 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 07:31:11.918627 => 07:31:11.962803
[0m07:31:11.968770 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m07:31:11.973734 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m07:31:11.977962 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m07:31:11.980116 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m07:31:11.980953 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m07:31:11.981495 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m07:31:11.982005 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m07:31:11.982508 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:31:11.983019 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m07:31:11.983479 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m07:31:11.984033 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m07:31:11.984494 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:31:11.984975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:31:11.988644 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:31:11.989212 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m07:31:11.989762 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m07:31:11.990259 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:31:11.990890 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:31:11.991363 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m07:31:11.991930 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m07:31:11.992478 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m07:31:11.993059 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m07:31:11.996154 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m07:31:11.996683 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m07:31:12.002299 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m07:31:12.007130 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m07:31:12.009361 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m07:31:12.013106 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m07:31:12.013631 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m07:31:12.014092 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m07:31:12.014688 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m07:31:12.015555 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.018716 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m07:31:12.019330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.019812 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m07:31:12.020346 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.023061 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m07:31:12.026077 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m07:31:12.026570 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.027139 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m07:31:12.027646 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m07:31:12.043937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.049139 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m07:31:12.049965 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.052422 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m07:31:12.052920 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m07:31:12.055113 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m07:31:12.055697 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m07:31:12.056255 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m07:31:12.056745 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m07:31:12.057248 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m07:31:12.057768 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m07:31:12.059174 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m07:31:12.064098 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m07:31:12.064623 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m07:31:12.065191 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m07:31:12.065539 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m07:31:12.068148 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m07:31:12.070977 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m07:31:12.071432 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:31:12.071921 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m07:31:12.072519 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m07:31:12.073878 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 07:31:11.942014 => 07:31:12.073726
[0m07:31:12.074513 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m07:31:12.075506 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e8d71510>]}
[0m07:31:12.076019 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:31:12.076703 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:31:12.077461 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.17s]
[0m07:31:12.079088 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 07:31:11.974132 => 07:31:12.078916
[0m07:31:12.080653 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 07:31:11.924212 => 07:31:12.080490
[0m07:31:12.081300 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m07:31:12.081827 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m07:31:12.082343 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m07:31:12.083557 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e8c281d0>]}
[0m07:31:12.084754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e8d74fd0>]}
[0m07:31:12.085482 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m07:31:12.086155 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.18s]
[0m07:31:12.086828 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m07:31:12.087472 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m07:31:12.088121 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m07:31:12.088704 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m07:31:12.089519 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m07:31:12.090188 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m07:31:12.092989 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m07:31:12.093698 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 07:31:12.090518 => 07:31:12.093512
[0m07:31:12.094131 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m07:31:12.098469 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m07:31:12.099124 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m07:31:12.099549 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m07:31:12.099932 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:31:12.104499 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m07:31:12.104991 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m07:31:12.105420 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m07:31:12.109325 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m07:31:12.113510 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m07:31:12.113990 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m07:31:12.114736 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.147236 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m07:31:12.147759 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m07:31:12.148522 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.150517 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m07:31:12.150933 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m07:31:12.151312 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m07:31:12.152556 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m07:31:12.154880 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m07:31:12.155283 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m07:31:12.156974 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:31:12.158250 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 07:31:12.094458 => 07:31:12.158097
[0m07:31:12.158715 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m07:31:12.159439 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e8c7d150>]}
[0m07:31:12.160073 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.07s]
[0m07:31:12.160676 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m07:31:12.161571 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m07:31:12.162188 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m07:31:12.162854 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m07:31:12.163301 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m07:31:12.165972 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m07:31:12.166822 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 07:31:12.163615 => 07:31:12.166518
[0m07:31:12.167259 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m07:31:12.171126 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m07:31:12.171835 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m07:31:12.172306 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m07:31:12.172705 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m07:31:12.177400 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:31:12.177954 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m07:31:12.178396 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m07:31:12.183321 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m07:31:12.186611 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m07:31:12.187075 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m07:31:12.187828 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.190647 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m07:31:12.191112 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m07:31:12.191864 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:31:12.193956 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m07:31:12.194375 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m07:31:12.194781 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m07:31:12.196003 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m07:31:12.198338 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m07:31:12.198743 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m07:31:12.200651 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:31:12.201946 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 07:31:12.167566 => 07:31:12.201796
[0m07:31:12.202369 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m07:31:12.203084 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ae4630-8b2c-4160-9898-ba78532d3f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0e9ddb090>]}
[0m07:31:12.203762 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m07:31:12.204346 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m07:31:12.208608 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:12.209030 [debug] [MainThread]: On master: BEGIN
[0m07:31:12.209388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:12.214137 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:31:12.214608 [debug] [MainThread]: On master: COMMIT
[0m07:31:12.214971 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:12.215329 [debug] [MainThread]: On master: COMMIT
[0m07:31:12.215744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:31:12.216120 [debug] [MainThread]: On master: Close
[0m07:31:12.216781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:12.217138 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m07:31:12.217469 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m07:31:12.217782 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m07:31:12.218092 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m07:31:12.218480 [info ] [MainThread]: 
[0m07:31:12.218838 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:31:12.219965 [debug] [MainThread]: Command end result
[0m07:31:12.224927 [info ] [MainThread]: 
[0m07:31:12.225424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:12.225785 [info ] [MainThread]: 
[0m07:31:12.226140 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:31:12.226676 [debug] [MainThread]: Command `dbt run` succeeded at 07:31:12.226589 after 0.53 seconds
[0m07:31:12.227074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee255a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee255590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a0ee255410>]}
[0m07:31:12.227479 [debug] [MainThread]: Flushing usage events
[0m08:02:25.031368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07cbe57250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07cbe57290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07cbe57990>]}


============================== 08:02:25.036374 | f1ab341e-ca05-44e0-8c36-75cc9257f64e ==============================
[0m08:02:25.036374 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:02:25.036865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:02:25.090079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07cbe896d0>]}
[0m08:02:25.106796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c7b13510>]}
[0m08:02:25.107680 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:02:25.119273 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:02:25.144686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:25.145148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:25.150992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c7a9cf50>]}
[0m08:02:25.155770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c7ae34d0>]}
[0m08:02:25.156333 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:02:25.156696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c7ae3610>]}
[0m08:02:25.158012 [info ] [MainThread]: 
[0m08:02:25.158688 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:02:25.159988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:02:25.170134 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:02:25.170630 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:02:25.170985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:25.177483 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:02:25.178866 [debug] [ThreadPool]: On list_finbest: Close
[0m08:02:25.180772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m08:02:25.186757 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:02:25.187227 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:02:25.187593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:25.192237 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.192700 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:02:25.193066 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:02:25.196527 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:02:25.197831 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:02:25.198340 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:02:25.203791 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:25.204282 [debug] [MainThread]: On master: BEGIN
[0m08:02:25.204672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:02:25.209248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.209741 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:25.210198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:02:25.214077 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:02:25.215164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c7197ad0>]}
[0m08:02:25.215726 [debug] [MainThread]: On master: ROLLBACK
[0m08:02:25.216301 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:25.216730 [debug] [MainThread]: On master: BEGIN
[0m08:02:25.217440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.217921 [debug] [MainThread]: On master: COMMIT
[0m08:02:25.218414 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:25.218938 [debug] [MainThread]: On master: COMMIT
[0m08:02:25.219489 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.219917 [debug] [MainThread]: On master: Close
[0m08:02:25.220620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:02:25.221000 [info ] [MainThread]: 
[0m08:02:25.226028 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:02:25.226532 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:02:25.227410 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:02:25.227870 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:02:25.228537 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:02:25.229298 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:02:25.230085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:02:25.231131 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m08:02:25.232232 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:02:25.233006 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:02:25.233623 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:02:25.234238 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:02:25.241501 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:02:25.243880 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:02:25.245607 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:02:25.246502 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:02:25.234833 => 08:02:25.246286
[0m08:02:25.247006 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:02:25.247637 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:02:25.241933 => 08:02:25.247371
[0m08:02:25.248142 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:02:25.244287 => 08:02:25.247939
[0m08:02:25.258699 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:02:25.264741 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:02:25.317675 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:02:25.320534 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:02:25.316094 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:02:25.321742 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:02:25.322121 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:02:25.322667 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:02:25.323162 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:02:25.323477 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:02:25.324318 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:02:25.324886 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:02:25.325393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:02:25.326231 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:02:25.331110 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.331560 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.332299 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:02:25.332750 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.333275 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:02:25.333743 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:02:25.334211 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:02:25.334668 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:02:25.335199 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:02:25.342604 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:02:25.343257 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:02:25.348953 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:02:25.351139 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:02:25.354181 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:02:25.358170 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:02:25.359306 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:02:25.359985 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:02:25.360852 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:02:25.361758 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.362345 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.362796 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.365888 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:02:25.369026 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:02:25.371937 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:02:25.372463 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:02:25.373074 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:02:25.373743 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:02:25.375164 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.376004 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.381737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.413630 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:02:25.416395 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:02:25.419611 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:02:25.420494 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:02:25.421175 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:02:25.421662 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:02:25.422146 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:02:25.422637 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:02:25.423088 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:02:25.424495 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.425115 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.431389 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:02:25.434021 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:02:25.434577 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:02:25.435063 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.435559 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:02:25.438083 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:02:25.438567 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:02:25.439118 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:02:25.440587 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:02:25.270343 => 08:02:25.440385
[0m08:02:25.441310 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:02:25.442386 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:02:25.444491 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:02:25.280543 => 08:02:25.444303
[0m08:02:25.445119 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:02:25.445757 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:02:25.446583 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c71b2290>]}
[0m08:02:25.448284 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:02:25.248413 => 08:02:25.448103
[0m08:02:25.449110 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c71a0fd0>]}
[0m08:02:25.449837 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.22s]
[0m08:02:25.450427 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:02:25.451160 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m08:02:25.451868 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:02:25.452509 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:02:25.453289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c7af7550>]}
[0m08:02:25.454256 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m08:02:25.454910 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:02:25.455393 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m08:02:25.456032 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:02:25.456774 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m08:02:25.457196 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:02:25.461417 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:02:25.462289 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:02:25.457568 => 08:02:25.462054
[0m08:02:25.462759 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m08:02:25.468022 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:02:25.468701 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:02:25.469130 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:02:25.469530 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:02:25.474528 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.475614 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:02:25.476210 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:02:25.481193 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:02:25.521780 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:02:25.522314 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:02:25.523191 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.527114 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:02:25.527718 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:02:25.528597 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.530874 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:02:25.531355 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:02:25.531765 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:02:25.533026 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.535593 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:02:25.536029 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:02:25.537946 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:02:25.539334 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:02:25.463070 => 08:02:25.539164
[0m08:02:25.539775 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m08:02:25.540506 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c68688d0>]}
[0m08:02:25.541236 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m08:02:25.542212 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m08:02:25.543289 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m08:02:25.544017 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:02:25.544726 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m08:02:25.545170 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m08:02:25.548158 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:02:25.548898 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 08:02:25.545525 => 08:02:25.548704
[0m08:02:25.549338 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m08:02:25.553421 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:02:25.554038 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:02:25.554458 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:02:25.554831 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:02:25.560478 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.561094 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:02:25.561589 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:02:25.566627 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:02:25.569905 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:02:25.570364 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:02:25.571056 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.573837 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:02:25.574326 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:02:25.575346 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:02:25.577975 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:02:25.578544 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:02:25.578942 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:02:25.580163 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.582725 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:02:25.583156 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:02:25.584939 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:02:25.586299 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 08:02:25.549658 => 08:02:25.586133
[0m08:02:25.586725 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m08:02:25.587454 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ab341e-ca05-44e0-8c36-75cc9257f64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c68c1890>]}
[0m08:02:25.588092 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m08:02:25.588684 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m08:02:25.633191 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:25.633900 [debug] [MainThread]: On master: BEGIN
[0m08:02:25.634307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:02:25.638806 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:02:25.639306 [debug] [MainThread]: On master: COMMIT
[0m08:02:25.639686 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:25.640097 [debug] [MainThread]: On master: COMMIT
[0m08:02:25.640516 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:02:25.640928 [debug] [MainThread]: On master: Close
[0m08:02:25.641724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:25.642285 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m08:02:25.642759 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m08:02:25.643164 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:02:25.643498 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:02:25.643910 [info ] [MainThread]: 
[0m08:02:25.644273 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m08:02:25.645382 [debug] [MainThread]: Command end result
[0m08:02:25.650694 [info ] [MainThread]: 
[0m08:02:25.651193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:25.651564 [info ] [MainThread]: 
[0m08:02:25.651916 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:02:25.652451 [debug] [MainThread]: Command `dbt run` succeeded at 08:02:25.652363 after 0.63 seconds
[0m08:02:25.652848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07cbe68590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07cb53ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d07c71bd390>]}
[0m08:02:25.653256 [debug] [MainThread]: Flushing usage events
[0m08:12:54.987590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aee84a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aec12c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aee84a250>]}


============================== 08:12:54.993007 | 4e998e33-34c5-4c3f-8133-372d42355548 ==============================
[0m08:12:54.993007 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:12:54.993532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:12:55.050758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aee87b610>]}
[0m08:12:55.066368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aee866610>]}
[0m08:12:55.067405 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:12:55.078828 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:12:55.106664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:55.107163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:55.113152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aea4a2bd0>]}
[0m08:12:55.118097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aea4d5ed0>]}
[0m08:12:55.118716 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:12:55.119098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aea4d57d0>]}
[0m08:12:55.120530 [info ] [MainThread]: 
[0m08:12:55.121248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:12:55.122526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:12:55.133105 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:12:55.133639 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:12:55.134014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:55.139903 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:12:55.141434 [debug] [ThreadPool]: On list_finbest: Close
[0m08:12:55.143280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m08:12:55.149082 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:12:55.149530 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:12:55.149881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:55.154318 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.154762 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:12:55.155124 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:12:55.157189 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:12:55.158504 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:12:55.158984 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:12:55.164303 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:55.164750 [debug] [MainThread]: On master: BEGIN
[0m08:12:55.165117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:55.169535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.170025 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:55.170468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:12:55.174359 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:12:55.175586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aea4df490>]}
[0m08:12:55.176257 [debug] [MainThread]: On master: ROLLBACK
[0m08:12:55.176848 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:55.177292 [debug] [MainThread]: On master: BEGIN
[0m08:12:55.177817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.178250 [debug] [MainThread]: On master: COMMIT
[0m08:12:55.178673 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:55.179017 [debug] [MainThread]: On master: COMMIT
[0m08:12:55.179402 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.179749 [debug] [MainThread]: On master: Close
[0m08:12:55.180414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:12:55.180773 [info ] [MainThread]: 
[0m08:12:55.185602 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:12:55.186157 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:12:55.186920 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:12:55.187480 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:12:55.187960 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:12:55.188859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:12:55.189396 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:12:55.190108 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m08:12:55.190679 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:12:55.191435 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:12:55.191894 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:12:55.198328 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:12:55.198682 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:12:55.201064 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:12:55.202961 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:12:55.203824 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:12:55.192283 => 08:12:55.203614
[0m08:12:55.204381 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:12:55.199243 => 08:12:55.204191
[0m08:12:55.204849 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:12:55.205331 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:12:55.236687 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:12:55.201638 => 08:12:55.236387
[0m08:12:55.283243 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:12:55.288238 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:12:55.291215 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:12:55.295660 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:12:55.296831 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:12:55.297337 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:12:55.297765 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:12:55.298349 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:12:55.299002 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:12:55.299471 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:12:55.300018 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:12:55.300566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:12:55.301266 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:12:55.303446 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.304109 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:12:55.304844 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:12:55.306194 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.306702 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:12:55.307287 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:12:55.307793 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.308456 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:12:55.308955 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:12:55.309523 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:12:55.316614 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:12:55.317161 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:12:55.321158 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:12:55.316376 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:12:55.324950 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:12:55.325504 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:12:55.326141 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:12:55.326682 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:12:55.327475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.327785 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.331524 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:12:55.332158 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.335093 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:12:55.335682 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:12:55.339029 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:12:55.339566 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:12:55.340135 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:12:55.340579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.346500 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.367543 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.370452 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:12:55.372757 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:12:55.374436 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:12:55.374862 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:12:55.375352 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:12:55.375806 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:12:55.376212 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:12:55.376758 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:12:55.377286 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:12:55.378808 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.379146 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.379503 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.384656 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:12:55.387258 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:12:55.389680 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:12:55.390125 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:12:55.390662 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:12:55.391227 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:12:55.393329 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:12:55.393714 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:12:55.394250 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:12:55.395792 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:12:55.210939 => 08:12:55.395621
[0m08:12:55.397205 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:12:55.205825 => 08:12:55.397045
[0m08:12:55.398840 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:12:55.291597 => 08:12:55.398677
[0m08:12:55.399335 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:12:55.399791 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:12:55.400239 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:12:55.401119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aea4a3410>]}
[0m08:12:55.401973 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aece06e90>]}
[0m08:12:55.402751 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784ae935e750>]}
[0m08:12:55.403540 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.21s]
[0m08:12:55.404226 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.21s]
[0m08:12:55.404987 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.21s]
[0m08:12:55.405705 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:12:55.406315 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:12:55.406919 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:12:55.407910 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m08:12:55.408464 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:12:55.409210 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m08:12:55.409651 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:12:55.412634 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:12:55.413377 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:12:55.409961 => 08:12:55.413171
[0m08:12:55.413807 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m08:12:55.418953 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:12:55.419656 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:12:55.420089 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:12:55.420490 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:12:55.425128 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.425709 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:12:55.426186 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:12:55.430138 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:12:55.463736 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:12:55.464251 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:12:55.465044 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.467817 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:12:55.468325 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:12:55.468998 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.471015 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:12:55.471432 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:12:55.471827 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:12:55.496017 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.500331 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:12:55.500955 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:12:55.503147 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:12:55.504940 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:12:55.414124 => 08:12:55.504723
[0m08:12:55.505529 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m08:12:55.506474 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aea5073d0>]}
[0m08:12:55.507192 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.10s]
[0m08:12:55.507781 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m08:12:55.508646 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m08:12:55.509143 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:12:55.509903 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m08:12:55.510350 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m08:12:55.512969 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:12:55.513670 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 08:12:55.510659 => 08:12:55.513479
[0m08:12:55.514086 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m08:12:55.518014 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:12:55.518662 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:12:55.519081 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:12:55.519465 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:12:55.524185 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.524746 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:12:55.525150 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:12:55.529760 [debug] [Thread-2  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:12:55.533010 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:12:55.533464 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:12:55.534165 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.536837 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:12:55.537264 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:12:55.537927 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:12:55.540066 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:12:55.540503 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:12:55.540899 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:12:55.542075 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.544458 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:12:55.544964 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:12:55.546935 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:12:55.548275 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 08:12:55.514396 => 08:12:55.548107
[0m08:12:55.548714 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m08:12:55.549445 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e998e33-34c5-4c3f-8133-372d42355548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784ae92e3650>]}
[0m08:12:55.550055 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m08:12:55.550628 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m08:12:55.593959 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:55.595389 [debug] [MainThread]: On master: BEGIN
[0m08:12:55.596397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:12:55.605959 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:12:55.607127 [debug] [MainThread]: On master: COMMIT
[0m08:12:55.607685 [debug] [MainThread]: Using postgres connection "master"
[0m08:12:55.608036 [debug] [MainThread]: On master: COMMIT
[0m08:12:55.609214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:12:55.609590 [debug] [MainThread]: On master: Close
[0m08:12:55.610232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:55.610615 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:12:55.610944 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m08:12:55.611267 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m08:12:55.611581 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:12:55.611955 [info ] [MainThread]: 
[0m08:12:55.612305 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m08:12:55.613402 [debug] [MainThread]: Command end result
[0m08:12:55.618556 [info ] [MainThread]: 
[0m08:12:55.619050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:55.619651 [info ] [MainThread]: 
[0m08:12:55.620288 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:12:55.621207 [debug] [MainThread]: Command `dbt run` succeeded at 08:12:55.621063 after 0.64 seconds
[0m08:12:55.621821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aebdda410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aebdda850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784ae92f8290>]}
[0m08:12:55.622325 [debug] [MainThread]: Flushing usage events
[0m08:16:45.498606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dae3fc150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dae3fc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dae3fc910>]}


============================== 08:16:45.503878 | 92820669-9bce-4537-a0af-337e9ede090d ==============================
[0m08:16:45.503878 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:16:45.504522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:16:45.563072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dae4295d0>]}
[0m08:16:45.577924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dabbdf190>]}
[0m08:16:45.578881 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:16:45.589706 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:16:45.614428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:16:45.614882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:16:45.620560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721daa04ff90>]}
[0m08:16:45.625236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721daa08aed0>]}
[0m08:16:45.625745 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:16:45.626092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721daa08a7d0>]}
[0m08:16:45.627374 [info ] [MainThread]: 
[0m08:16:45.628006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:16:45.629276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:16:45.639213 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:16:45.639712 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:16:45.640073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:45.646504 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:16:45.647856 [debug] [ThreadPool]: On list_finbest: Close
[0m08:16:45.649573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m08:16:45.655309 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:16:45.655778 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:16:45.656157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:45.660720 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.661179 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:16:45.661600 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:16:45.664045 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:16:45.665325 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:16:45.665850 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:16:45.671647 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:45.672102 [debug] [MainThread]: On master: BEGIN
[0m08:16:45.672461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:16:45.676747 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.677191 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:45.677594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:16:45.681518 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:16:45.682591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721daa09fdd0>]}
[0m08:16:45.683116 [debug] [MainThread]: On master: ROLLBACK
[0m08:16:45.683604 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:45.683959 [debug] [MainThread]: On master: BEGIN
[0m08:16:45.684418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.684790 [debug] [MainThread]: On master: COMMIT
[0m08:16:45.685132 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:45.685479 [debug] [MainThread]: On master: COMMIT
[0m08:16:45.685930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:16:45.686311 [debug] [MainThread]: On master: Close
[0m08:16:45.686943 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:16:45.687298 [info ] [MainThread]: 
[0m08:16:45.692335 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:16:45.692887 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:16:45.693690 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:16:45.694243 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:16:45.694820 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:16:45.695523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:16:45.696091 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:16:45.696798 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m08:16:45.697274 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:16:45.698004 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:16:45.698495 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:16:45.705144 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:16:45.705825 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:16:45.708978 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:16:45.711808 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:16:45.713224 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:16:45.698856 => 08:16:45.712807
[0m08:16:45.714195 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:16:45.725420 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:16:45.706486 => 08:16:45.725130
[0m08:16:45.731210 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:16:45.709595 => 08:16:45.730982
[0m08:16:45.741876 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:16:45.747613 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:16:45.762437 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:16:45.766821 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:16:45.771029 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:16:45.772010 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:16:45.772516 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:16:45.773031 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:16:45.773473 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:16:45.774300 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:16:45.774747 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:16:45.775179 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:16:45.775592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:16:45.776110 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:16:45.780714 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.781343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.781849 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:16:45.782362 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.782805 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:16:45.783318 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:16:45.783802 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:16:45.784280 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:16:45.784801 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:16:45.788572 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:16:45.789167 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:16:45.794731 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:16:45.796009 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:16:45.799122 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:16:45.802696 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:16:45.803321 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:16:45.803965 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:16:45.804534 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:16:45.806552 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.807163 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.811021 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:16:45.814225 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:16:45.814833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.815511 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:16:45.816079 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:16:45.819845 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:16:45.820825 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:16:45.821615 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.822434 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.828436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.858602 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:16:45.860730 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:16:45.862945 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:16:45.863474 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:16:45.863945 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:16:45.864507 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:16:45.864978 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:16:45.865564 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:16:45.866031 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:16:45.867331 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:16:45.867667 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:16:45.868219 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:16:45.873603 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:16:45.876250 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:16:45.878720 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:16:45.879419 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:16:45.880154 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:16:45.880678 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:16:45.882984 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:16:45.883388 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:16:45.884018 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:16:45.885558 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:16:45.753405 => 08:16:45.885389
[0m08:16:45.887205 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:16:45.763029 => 08:16:45.887031
[0m08:16:45.888571 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:16:45.714876 => 08:16:45.888412
[0m08:16:45.889041 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:16:45.889539 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:16:45.889983 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:16:45.890861 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721da86e40d0>]}
[0m08:16:45.891795 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721da8677550>]}
[0m08:16:45.892770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721da9747c90>]}
[0m08:16:45.893494 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.19s]
[0m08:16:45.894192 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.19s]
[0m08:16:45.894806 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m08:16:45.895468 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:16:45.896105 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:16:45.896708 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:16:45.897532 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m08:16:45.898039 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:16:45.898754 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m08:16:45.899158 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:16:45.901983 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:16:45.902687 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:16:45.899470 => 08:16:45.902506
[0m08:16:45.903123 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m08:16:45.907355 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:16:45.907991 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:16:45.908414 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:16:45.908789 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:16:45.913304 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.913806 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:16:45.914218 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:16:45.918724 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:16:45.923009 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:16:45.923493 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:16:45.924206 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.958299 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:16:45.958808 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:16:45.959672 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:45.961711 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:16:45.962121 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:16:45.962520 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:16:45.963747 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m08:16:45.966067 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:16:45.966480 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:16:45.968490 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:16:45.969803 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:16:45.903489 => 08:16:45.969656
[0m08:16:45.970209 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m08:16:45.971055 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721da85de550>]}
[0m08:16:45.971697 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.07s]
[0m08:16:45.972270 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m08:16:45.972927 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m08:16:45.973576 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:16:45.974194 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m08:16:45.974620 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m08:16:45.977210 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:16:45.977906 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 08:16:45.974921 => 08:16:45.977717
[0m08:16:45.978403 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m08:16:45.982225 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:16:45.982864 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:16:45.983293 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:16:45.983653 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:16:45.988237 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:16:45.988737 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:16:45.989136 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:16:45.993976 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:16:45.997154 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:16:45.997772 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:16:45.998545 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:46.002441 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:16:46.003038 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:16:46.003747 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:16:46.006331 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:16:46.006790 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:16:46.007177 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:16:46.008918 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:16:46.011278 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:16:46.011685 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:16:46.013685 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:16:46.014998 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 08:16:45.978705 => 08:16:46.014851
[0m08:16:46.015413 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m08:16:46.016116 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92820669-9bce-4537-a0af-337e9ede090d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721da85de550>]}
[0m08:16:46.016759 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m08:16:46.017326 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m08:16:46.099559 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:46.100812 [debug] [MainThread]: On master: BEGIN
[0m08:16:46.101839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:16:46.113077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:16:46.114306 [debug] [MainThread]: On master: COMMIT
[0m08:16:46.115299 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:46.116220 [debug] [MainThread]: On master: COMMIT
[0m08:16:46.117291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:16:46.118297 [debug] [MainThread]: On master: Close
[0m08:16:46.119971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:46.120835 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m08:16:46.121478 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m08:16:46.122105 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:16:46.122729 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:16:46.123458 [info ] [MainThread]: 
[0m08:16:46.123963 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m08:16:46.125480 [debug] [MainThread]: Command end result
[0m08:16:46.130678 [info ] [MainThread]: 
[0m08:16:46.131111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:16:46.131467 [info ] [MainThread]: 
[0m08:16:46.131796 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:16:46.132285 [debug] [MainThread]: Command `dbt run` succeeded at 08:16:46.132199 after 0.65 seconds
[0m08:16:46.132696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dad471dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dadaa2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721da8649150>]}
[0m08:16:46.133087 [debug] [MainThread]: Flushing usage events
[0m08:20:56.516214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efffd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efffd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efffd910>]}


============================== 08:20:56.521886 | 2b3a3a37-91e5-489d-9ca9-b4ca7f041d37 ==============================
[0m08:20:56.521886 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:20:56.522480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:20:56.585907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f002f050>]}
[0m08:20:56.602727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6efffd290>]}
[0m08:20:56.603686 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:20:56.616254 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:20:56.645694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:56.647016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:56.653805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ebc43590>]}
[0m08:20:56.658916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ebc8a810>]}
[0m08:20:56.659556 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:20:56.659963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ebc8ab90>]}
[0m08:20:56.661867 [info ] [MainThread]: 
[0m08:20:56.663258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:20:56.664989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:20:56.675402 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:20:56.675846 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:20:56.676220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:56.682963 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:20:56.684451 [debug] [ThreadPool]: On list_finbest: Close
[0m08:20:56.686333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m08:20:56.692192 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:20:56.692653 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:20:56.693118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:56.698639 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.699209 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:20:56.699623 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:20:56.701825 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:20:56.703135 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:20:56.703629 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:20:56.708971 [debug] [MainThread]: Using postgres connection "master"
[0m08:20:56.709475 [debug] [MainThread]: On master: BEGIN
[0m08:20:56.709875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:20:56.715987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.716592 [debug] [MainThread]: Using postgres connection "master"
[0m08:20:56.717130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:20:56.722022 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:20:56.723253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eb351c10>]}
[0m08:20:56.723785 [debug] [MainThread]: On master: ROLLBACK
[0m08:20:56.724332 [debug] [MainThread]: Using postgres connection "master"
[0m08:20:56.724738 [debug] [MainThread]: On master: BEGIN
[0m08:20:56.725232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.725634 [debug] [MainThread]: On master: COMMIT
[0m08:20:56.726020 [debug] [MainThread]: Using postgres connection "master"
[0m08:20:56.726475 [debug] [MainThread]: On master: COMMIT
[0m08:20:56.727040 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:20:56.727555 [debug] [MainThread]: On master: Close
[0m08:20:56.728485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:20:56.728907 [info ] [MainThread]: 
[0m08:20:56.734765 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:20:56.735380 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:20:56.736118 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:20:56.736578 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:20:56.737252 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:20:56.737938 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:20:56.738672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:20:56.739409 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m08:20:56.740168 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:20:56.740644 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:20:56.741120 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:20:56.741582 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:20:56.748816 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:20:56.751281 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:20:56.753057 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:20:56.753996 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:20:56.741940 => 08:20:56.753757
[0m08:20:56.754790 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:20:56.749253 => 08:20:56.754496
[0m08:20:56.755365 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:20:56.755844 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:20:56.756426 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:20:56.751728 => 08:20:56.756231
[0m08:20:56.827452 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:20:56.830195 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:20:56.830875 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:20:56.835978 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:20:56.836709 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:20:56.837257 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:20:56.837754 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:20:56.838252 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:20:56.838722 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:20:56.839209 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:20:56.839959 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:20:56.840564 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:20:56.841180 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:20:56.845270 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.846804 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:20:56.847429 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:20:56.847946 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.848557 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.849245 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:20:56.849734 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:20:56.850195 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:20:56.850669 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:20:56.852197 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:20:56.858268 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:20:56.858621 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:20:56.859723 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:20:56.864786 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:20:56.867918 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:20:56.868512 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:20:56.869276 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:20:56.870011 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:20:56.870856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:56.871205 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:56.871806 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:56.874799 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:20:56.878728 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:20:56.882344 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:20:56.882910 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:20:56.883468 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:20:56.883909 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:20:56.884678 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:56.885229 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:56.890894 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:56.919390 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:20:56.921026 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:20:56.923924 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:20:56.924584 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:20:56.925224 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:20:56.925835 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:20:56.926366 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:20:56.927117 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:20:56.927924 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:20:56.929432 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:20:56.929943 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:20:56.930486 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:20:56.935766 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:20:56.938875 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:20:56.941609 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:20:56.942152 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:20:56.942752 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:20:56.943233 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:20:56.945892 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:20:56.947789 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:20:56.767118 => 08:20:56.947618
[0m08:20:56.948267 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:20:56.949082 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eb352d90>]}
[0m08:20:56.949733 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.21s]
[0m08:20:56.950324 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:20:56.966425 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:20:56.967122 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:20:56.968612 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:20:56.756766 => 08:20:56.968450
[0m08:20:56.970039 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:20:56.831821 => 08:20:56.969873
[0m08:20:56.970529 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:20:56.971002 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:20:56.971890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eab12890>]}
[0m08:20:56.972695 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eb332f10>]}
[0m08:20:56.973336 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.23s]
[0m08:20:56.974189 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.23s]
[0m08:20:56.974876 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:20:56.975651 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:20:56.976433 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m08:20:56.977279 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:20:56.978096 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m08:20:56.978607 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:20:56.981736 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:20:56.982510 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:20:56.978932 => 08:20:56.982298
[0m08:20:56.982951 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m08:20:56.988286 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:20:56.988986 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:20:56.989438 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:20:56.989820 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:20:56.994529 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m08:20:56.995235 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:20:56.995959 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:20:57.000704 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:20:57.037028 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:20:57.037760 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:20:57.038583 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:57.041401 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:20:57.041835 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:20:57.042617 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:57.044958 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:20:57.045740 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:20:57.046237 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:20:57.047985 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m08:20:57.050752 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:20:57.051296 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:20:57.053446 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:20:57.054959 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:20:56.983266 => 08:20:57.054798
[0m08:20:57.055411 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m08:20:57.056148 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eaab5b90>]}
[0m08:20:57.056836 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m08:20:57.057423 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m08:20:57.058308 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m08:20:57.058910 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:20:57.059611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m08:20:57.060064 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m08:20:57.062814 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:20:57.063660 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 08:20:57.060387 => 08:20:57.063406
[0m08:20:57.064120 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m08:20:57.068501 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:20:57.069290 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:20:57.069752 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:20:57.070166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:20:57.075027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:20:57.075556 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:20:57.075982 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:20:57.081651 [debug] [Thread-1  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:20:57.084892 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:20:57.085374 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:20:57.086091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:57.088920 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:20:57.089378 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:20:57.089991 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:20:57.092102 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:20:57.092575 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:20:57.092987 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:20:57.094449 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:20:57.097042 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:20:57.097507 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:20:57.099315 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:20:57.100738 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 08:20:57.064464 => 08:20:57.100567
[0m08:20:57.101188 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m08:20:57.102149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3a3a37-91e5-489d-9ca9-b4ca7f041d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ea9fddd0>]}
[0m08:20:57.103092 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m08:20:57.103959 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m08:20:57.144301 [debug] [MainThread]: Using postgres connection "master"
[0m08:20:57.145309 [debug] [MainThread]: On master: BEGIN
[0m08:20:57.146077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:20:57.153972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:20:57.155282 [debug] [MainThread]: On master: COMMIT
[0m08:20:57.155823 [debug] [MainThread]: Using postgres connection "master"
[0m08:20:57.156362 [debug] [MainThread]: On master: COMMIT
[0m08:20:57.156959 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:20:57.157375 [debug] [MainThread]: On master: Close
[0m08:20:57.158347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:57.159060 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m08:20:57.159721 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:20:57.160484 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m08:20:57.161085 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:20:57.161731 [info ] [MainThread]: 
[0m08:20:57.162325 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m08:20:57.164270 [debug] [MainThread]: Command end result
[0m08:20:57.174529 [info ] [MainThread]: 
[0m08:20:57.175245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:57.175772 [info ] [MainThread]: 
[0m08:20:57.176170 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:20:57.176857 [debug] [MainThread]: Command `dbt run` succeeded at 08:20:57.176748 after 0.67 seconds
[0m08:20:57.177597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eaad6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eaad6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6eaad6fd0>]}
[0m08:20:57.178147 [debug] [MainThread]: Flushing usage events
[0m08:23:58.644379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095281b4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095281b4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095281b4990>]}


============================== 08:23:58.650395 | a785032d-99f4-419a-bb2b-1ae18aea8532 ==============================
[0m08:23:58.650395 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:23:58.650881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:23:58.733161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095281e6650>]}
[0m08:23:58.749016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709525770c50>]}
[0m08:23:58.749921 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:23:58.761188 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:23:58.789240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:58.789762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:58.796542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709523e00450>]}
[0m08:23:58.801833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709523e41ad0>]}
[0m08:23:58.802428 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:23:58.802807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709523e413d0>]}
[0m08:23:58.804259 [info ] [MainThread]: 
[0m08:23:58.805001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:23:58.806355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:23:58.817761 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:23:58.818369 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:23:58.818810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:58.825520 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:23:58.827183 [debug] [ThreadPool]: On list_finbest: Close
[0m08:23:58.829893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m08:23:58.836215 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:23:58.836716 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:23:58.837194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:58.842114 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:23:58.842608 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:23:58.842978 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:23:58.846476 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:23:58.848086 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:23:58.848784 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:23:58.854656 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:58.855091 [debug] [MainThread]: On master: BEGIN
[0m08:23:58.855494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:58.860044 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:58.860584 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:58.861008 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:23:58.866141 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:58.867431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709523d39610>]}
[0m08:23:58.867970 [debug] [MainThread]: On master: ROLLBACK
[0m08:23:58.868491 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:58.868890 [debug] [MainThread]: On master: BEGIN
[0m08:23:58.869374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:58.869741 [debug] [MainThread]: On master: COMMIT
[0m08:23:58.870074 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:58.870404 [debug] [MainThread]: On master: COMMIT
[0m08:23:58.870814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:23:58.871158 [debug] [MainThread]: On master: Close
[0m08:23:58.871814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:23:58.872196 [info ] [MainThread]: 
[0m08:23:58.876909 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:23:58.877509 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:23:58.878621 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:23:58.879462 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:23:58.880276 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:23:58.881012 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:23:58.881960 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:23:58.882832 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m08:23:58.883641 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:23:58.884179 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:23:58.884676 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:23:58.885148 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:23:58.891823 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:23:58.894565 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:23:58.897040 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:23:58.898234 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:23:58.885537 => 08:23:58.897990
[0m08:23:58.898805 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:23:58.892206 => 08:23:58.898608
[0m08:23:58.899343 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:23:58.895115 => 08:23:58.899156
[0m08:23:58.899797 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:23:58.900285 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:23:58.900746 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:23:58.982366 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:23:58.984746 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:23:58.987223 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:23:58.987998 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:23:58.988551 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:23:58.989041 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:23:58.989503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:23:58.989977 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:23:58.990448 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:23:58.991017 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:23:58.991554 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:23:58.992027 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:23:58.996497 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:58.997484 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:58.998030 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:23:58.998534 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:58.999007 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:23:58.999465 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:23:58.999910 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:23:59.000490 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:23:59.000977 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:23:59.020234 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:23:59.026773 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:23:59.027940 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:23:59.028477 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:23:59.032957 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:23:59.033513 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:23:59.037022 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:23:59.037540 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:23:59.038155 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:23:59.038904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.039608 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.040054 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.043386 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:23:59.047340 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:23:59.050356 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:23:59.050884 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:23:59.051520 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:23:59.052004 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:23:59.052970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.053371 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.053848 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.076759 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:23:59.079836 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:23:59.082169 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:23:59.082766 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:23:59.083303 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:23:59.083767 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:23:59.084235 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:23:59.084760 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:23:59.085208 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:23:59.086447 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:23:59.092061 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:23:59.092748 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:23:59.091707 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:23:59.096148 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:23:59.098878 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:23:59.099566 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:23:59.100234 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:23:59.100650 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:23:59.103692 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:23:59.104251 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:23:59.105718 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:23:58.938064 => 08:23:59.105548
[0m08:23:59.106264 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:23:59.107637 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:23:58.901113 => 08:23:59.107478
[0m08:23:59.108127 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:23:59.109544 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:23:58.912609 => 08:23:59.109386
[0m08:23:59.110037 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:23:59.110773 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:23:59.111721 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709523369850>]}
[0m08:23:59.113170 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.23s]
[0m08:23:59.114369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095234fced0>]}
[0m08:23:59.115082 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095233698d0>]}
[0m08:23:59.115682 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:23:59.116401 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.23s]
[0m08:23:59.117229 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.23s]
[0m08:23:59.118201 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:23:59.118914 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:23:59.119521 [debug] [Thread-1  ]: Began running node model.finbest.int_daily_transactions
[0m08:23:59.120155 [info ] [Thread-1  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:23:59.120817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.int_daily_transactions)
[0m08:23:59.121232 [debug] [Thread-1  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:23:59.124014 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:23:59.124720 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:23:59.121546 => 08:23:59.124528
[0m08:23:59.125138 [debug] [Thread-1  ]: Began executing node model.finbest.int_daily_transactions
[0m08:23:59.131324 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:23:59.132368 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:23:59.132823 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:23:59.133208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:23:59.137689 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:59.138192 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:23:59.138632 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:23:59.142435 [debug] [Thread-1  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:23:59.185851 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:23:59.186495 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:23:59.187385 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.190316 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:23:59.190761 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:23:59.191521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.193931 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:23:59.194677 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:23:59.195369 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:23:59.196871 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:23:59.199697 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:23:59.200178 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:23:59.202247 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:23:59.203717 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:23:59.125463 => 08:23:59.203551
[0m08:23:59.204164 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: Close
[0m08:23:59.204907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095233c03d0>]}
[0m08:23:59.205538 [info ] [Thread-1  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m08:23:59.206111 [debug] [Thread-1  ]: Finished running node model.finbest.int_daily_transactions
[0m08:23:59.206778 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m08:23:59.207376 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:23:59.208040 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m08:23:59.208492 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m08:23:59.211792 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:23:59.212798 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 08:23:59.208906 => 08:23:59.212561
[0m08:23:59.213365 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m08:23:59.217997 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:23:59.218770 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:23:59.219218 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:23:59.219617 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:23:59.224184 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:59.224835 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:23:59.225278 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:23:59.230518 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:23:59.234159 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:23:59.234663 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:23:59.235350 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.238140 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:23:59.238650 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:23:59.239201 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:23:59.241520 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:23:59.241956 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:23:59.242357 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:23:59.243430 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:23:59.246503 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:23:59.247153 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:23:59.249468 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:23:59.250983 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 08:23:59.213709 => 08:23:59.250817
[0m08:23:59.251447 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m08:23:59.252184 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a785032d-99f4-419a-bb2b-1ae18aea8532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095234c14d0>]}
[0m08:23:59.252831 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m08:23:59.253434 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m08:23:59.287282 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:59.287838 [debug] [MainThread]: On master: BEGIN
[0m08:23:59.288205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:23:59.292821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:59.293349 [debug] [MainThread]: On master: COMMIT
[0m08:23:59.293769 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:59.294129 [debug] [MainThread]: On master: COMMIT
[0m08:23:59.294910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:23:59.295583 [debug] [MainThread]: On master: Close
[0m08:23:59.296599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:59.297221 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:23:59.297567 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m08:23:59.297883 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:23:59.298273 [info ] [MainThread]: 
[0m08:23:59.298636 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m08:23:59.299753 [debug] [MainThread]: Command end result
[0m08:23:59.304970 [info ] [MainThread]: 
[0m08:23:59.305476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:23:59.305834 [info ] [MainThread]: 
[0m08:23:59.306184 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:23:59.306711 [debug] [MainThread]: Command `dbt run` succeeded at 08:23:59.306626 after 0.67 seconds
[0m08:23:59.307112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709523e91e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70952789af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095233e9390>]}
[0m08:23:59.307519 [debug] [MainThread]: Flushing usage events
[0m08:27:26.187093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b38220b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b38220b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b38220b8d0>]}


============================== 08:27:26.192294 | f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54 ==============================
[0m08:27:26.192294 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:27:26.192904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:27:26.247287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b382200f90>]}
[0m08:27:26.261683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37f9f4450>]}
[0m08:27:26.262485 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:27:26.272843 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:27:26.298514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:27:26.299006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:27:26.304691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37de57f10>]}
[0m08:27:26.309532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37de98fd0>]}
[0m08:27:26.310119 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:27:26.310521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37de98dd0>]}
[0m08:27:26.311857 [info ] [MainThread]: 
[0m08:27:26.312536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:27:26.313835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:27:26.323485 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:27:26.323938 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:27:26.324329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:26.330109 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:27:26.331517 [debug] [ThreadPool]: On list_finbest: Close
[0m08:27:26.333371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m08:27:26.339115 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:27:26.339565 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:27:26.339930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:26.344448 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.345040 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:27:26.345598 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:27:26.348714 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:27:26.350624 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:27:26.351482 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:27:26.359714 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:26.360667 [debug] [MainThread]: On master: BEGIN
[0m08:27:26.361487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:26.368780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.369437 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:26.370090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:27:26.375680 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:27:26.377510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37dd9ab10>]}
[0m08:27:26.378479 [debug] [MainThread]: On master: ROLLBACK
[0m08:27:26.379279 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:26.379878 [debug] [MainThread]: On master: BEGIN
[0m08:27:26.380618 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.381206 [debug] [MainThread]: On master: COMMIT
[0m08:27:26.381771 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:26.382294 [debug] [MainThread]: On master: COMMIT
[0m08:27:26.382802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.383196 [debug] [MainThread]: On master: Close
[0m08:27:26.383905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:27:26.384317 [info ] [MainThread]: 
[0m08:27:26.389438 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:27:26.390015 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:27:26.390727 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:27:26.391306 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:27:26.391911 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:27:26.392476 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:27:26.393183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:27:26.393887 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m08:27:26.394672 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:27:26.395153 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:27:26.395626 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:27:26.396071 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:27:26.402976 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:27:26.405948 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:27:26.408461 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:27:26.409946 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:27:26.396459 => 08:27:26.409564
[0m08:27:26.410746 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:27:26.403487 => 08:27:26.410378
[0m08:27:26.412072 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:27:26.413109 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:27:26.414201 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:27:26.406549 => 08:27:26.413839
[0m08:27:26.457232 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:27:26.486058 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:27:26.486785 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:27:26.491096 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:27:26.492118 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:27:26.492786 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:27:26.493432 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:27:26.494019 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:27:26.494593 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:27:26.495122 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:27:26.495626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:27:26.496282 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:27:26.497014 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:27:26.500643 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.501272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.501841 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:27:26.502322 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.502784 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:27:26.503304 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:27:26.503813 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:27:26.504276 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:27:26.504794 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:27:26.537005 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:27:26.538604 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:27:26.545330 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:27:26.569816 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:27:26.574753 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:27:26.575535 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:27:26.565903 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:27:26.576371 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:27:26.577233 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:27:26.578317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.578994 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.579641 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.583323 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:27:26.586209 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:27:26.589415 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:27:26.590010 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:27:26.590929 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:27:26.591760 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:27:26.592901 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.598707 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.609458 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.627823 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:27:26.628593 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:27:26.630614 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:27:26.631342 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:27:26.625063 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:27:26.632138 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:27:26.632892 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:27:26.633555 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:27:26.634237 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:27:26.634875 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.641430 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.641180 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:27:26.644305 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:27:26.644823 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.645323 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:27:26.645807 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:27:26.648369 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:27:26.649133 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:27:26.650760 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:27:26.651573 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:27:26.652304 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:27:26.654187 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:27:26.425246 => 08:27:26.653974
[0m08:27:26.655992 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:27:26.414861 => 08:27:26.655775
[0m08:27:26.657963 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:27:26.487282 => 08:27:26.657735
[0m08:27:26.658667 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:27:26.659357 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:27:26.660096 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:27:26.661769 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37dd94590>]}
[0m08:27:26.663518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37ddbfa50>]}
[0m08:27:26.664719 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37cbf7950>]}
[0m08:27:26.665662 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.27s]
[0m08:27:26.666445 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.27s]
[0m08:27:26.667230 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.27s]
[0m08:27:26.668034 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:27:26.668862 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:27:26.669722 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:27:26.670813 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m08:27:26.671628 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:27:26.672671 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m08:27:26.673307 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:27:26.676946 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:27:26.677660 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:27:26.673790 => 08:27:26.677477
[0m08:27:26.678095 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m08:27:26.713992 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:27:26.714759 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:27:26.715176 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:27:26.715558 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:27:26.720216 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.720747 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:27:26.721187 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:27:26.725324 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:27:26.728442 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:27:26.728875 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:27:26.729607 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.732327 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:27:26.732767 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:27:26.733368 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.735546 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:27:26.735987 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:27:26.736402 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:27:26.737347 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.739757 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:27:26.740172 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:27:26.741957 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:27:26.743228 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:27:26.678439 => 08:27:26.743081
[0m08:27:26.743694 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m08:27:26.744421 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37cc1ded0>]}
[0m08:27:26.745036 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.07s]
[0m08:27:26.745635 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m08:27:26.746417 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m08:27:26.747025 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:27:26.747665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m08:27:26.748095 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m08:27:26.750734 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:27:26.751426 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 08:27:26.748412 => 08:27:26.751239
[0m08:27:26.751857 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m08:27:26.755894 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:27:26.756509 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:27:26.756938 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:27:26.757333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:27:26.762025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.762659 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:27:26.763205 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:27:26.770357 [debug] [Thread-1  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:27:26.775361 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:27:26.776291 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:27:26.777663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.782339 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:27:26.782938 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:27:26.783808 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:27:26.786219 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:27:26.786657 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:27:26.787076 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:27:26.788232 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.790569 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:27:26.791028 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:27:26.792899 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:27:26.794184 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 08:27:26.752169 => 08:27:26.794036
[0m08:27:26.794620 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m08:27:26.795368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a958fc-38f3-4dac-96b3-5fe8bd5a4d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37cc20f10>]}
[0m08:27:26.796017 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.05s]
[0m08:27:26.796625 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m08:27:26.814458 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:26.815222 [debug] [MainThread]: On master: BEGIN
[0m08:27:26.815902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:27:26.825945 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:27:26.827049 [debug] [MainThread]: On master: COMMIT
[0m08:27:26.827989 [debug] [MainThread]: Using postgres connection "master"
[0m08:27:26.828902 [debug] [MainThread]: On master: COMMIT
[0m08:27:26.829985 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:27:26.830917 [debug] [MainThread]: On master: Close
[0m08:27:26.832500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:26.833294 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m08:27:26.833921 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:27:26.834550 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m08:27:26.835148 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:27:26.835855 [info ] [MainThread]: 
[0m08:27:26.836381 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m08:27:26.837981 [debug] [MainThread]: Command end result
[0m08:27:26.843373 [info ] [MainThread]: 
[0m08:27:26.843858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:27:26.844218 [info ] [MainThread]: 
[0m08:27:26.844588 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:27:26.845122 [debug] [MainThread]: Command `dbt run` succeeded at 08:27:26.845030 after 0.67 seconds
[0m08:27:26.845545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37cd0c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37cd0c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b37cd0c910>]}
[0m08:27:26.845938 [debug] [MainThread]: Flushing usage events
[0m08:32:00.925573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b20071f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b20071f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b20071f9d0>]}


============================== 08:32:00.930558 | f299ebcb-2a8e-4d1b-91c5-39f3559f85c0 ==============================
[0m08:32:00.930558 [info ] [MainThread]: Running with dbt=1.5.11
[0m08:32:00.931089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:32:00.986908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b20071fed0>]}
[0m08:32:01.001805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fecd1f50>]}
[0m08:32:01.003759 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m08:32:01.014914 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m08:32:01.040630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:32:01.041795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:32:01.047468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fc372c10>]}
[0m08:32:01.051970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fc3ab610>]}
[0m08:32:01.052484 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:32:01.052829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fc3ab7d0>]}
[0m08:32:01.054104 [info ] [MainThread]: 
[0m08:32:01.054746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:32:01.055988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m08:32:01.065895 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m08:32:01.066323 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m08:32:01.066672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:01.073505 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:32:01.074877 [debug] [ThreadPool]: On list_finbest: Close
[0m08:32:01.076721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m08:32:01.082454 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:32:01.082889 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m08:32:01.083235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:01.087985 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.088615 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m08:32:01.089167 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m08:32:01.092066 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:32:01.093701 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m08:32:01.094359 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m08:32:01.100574 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:01.101033 [debug] [MainThread]: On master: BEGIN
[0m08:32:01.101420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:32:01.106113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.106623 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:01.107091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:32:01.110925 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:32:01.111937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fc35d710>]}
[0m08:32:01.112440 [debug] [MainThread]: On master: ROLLBACK
[0m08:32:01.112906 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:01.113290 [debug] [MainThread]: On master: BEGIN
[0m08:32:01.113763 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.114132 [debug] [MainThread]: On master: COMMIT
[0m08:32:01.114504 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:01.114866 [debug] [MainThread]: On master: COMMIT
[0m08:32:01.115273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.115647 [debug] [MainThread]: On master: Close
[0m08:32:01.116318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:32:01.116703 [info ] [MainThread]: 
[0m08:32:01.121804 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m08:32:01.122367 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m08:32:01.123083 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m08:32:01.123544 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m08:32:01.124337 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m08:32:01.124869 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m08:32:01.125586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m08:32:01.126282 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m08:32:01.127022 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m08:32:01.127512 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m08:32:01.127958 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m08:32:01.128404 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m08:32:01.136063 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m08:32:01.138286 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m08:32:01.140250 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m08:32:01.141591 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 08:32:01.133902 => 08:32:01.141278
[0m08:32:01.142389 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 08:32:01.136583 => 08:32:01.142122
[0m08:32:01.143022 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m08:32:01.143676 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m08:32:01.154707 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 08:32:01.128765 => 08:32:01.154473
[0m08:32:01.196632 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m08:32:01.201452 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m08:32:01.205706 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m08:32:01.206455 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m08:32:01.207217 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:32:01.207754 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m08:32:01.208238 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:32:01.208892 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:32:01.209360 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m08:32:01.209894 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:32:01.210394 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:32:01.211000 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m08:32:01.211549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:32:01.213352 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.213873 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:32:01.214288 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m08:32:01.215568 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.216239 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:32:01.216784 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.217523 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m08:32:01.217987 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:32:01.218506 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m08:32:01.219144 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m08:32:01.226664 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m08:32:01.226404 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:32:01.227367 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m08:32:01.230621 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:32:01.231527 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m08:32:01.236195 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:32:01.236879 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m08:32:01.237491 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:32:01.237968 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.241120 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:32:01.241470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.242213 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.242680 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m08:32:01.245600 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:32:01.249221 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:32:01.250118 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m08:32:01.250830 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.251547 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:32:01.257879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.279816 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.284902 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:32:01.287340 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:32:01.291137 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:32:01.291645 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:32:01.292193 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:32:01.292689 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:32:01.293209 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m08:32:01.293762 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m08:32:01.294285 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m08:32:01.295917 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.296408 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.296934 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.302021 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m08:32:01.304525 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m08:32:01.306872 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m08:32:01.307356 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m08:32:01.307834 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m08:32:01.308336 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m08:32:01.311385 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:32:01.311956 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:32:01.312523 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:32:01.314206 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 08:32:01.201856 => 08:32:01.314022
[0m08:32:01.315907 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 08:32:01.144244 => 08:32:01.315704
[0m08:32:01.317530 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 08:32:01.170454 => 08:32:01.317334
[0m08:32:01.318099 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m08:32:01.318711 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m08:32:01.319277 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m08:32:01.320457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1f89cfcd0>]}
[0m08:32:01.322095 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fba73250>]}
[0m08:32:01.323588 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fc2d3350>]}
[0m08:32:01.324762 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m08:32:01.325570 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.20s]
[0m08:32:01.326363 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.20s]
[0m08:32:01.327207 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m08:32:01.327995 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m08:32:01.328779 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m08:32:01.329869 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m08:32:01.330666 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m08:32:01.331707 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m08:32:01.332337 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m08:32:01.337472 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m08:32:01.338990 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 08:32:01.332874 => 08:32:01.338638
[0m08:32:01.339736 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m08:32:01.346040 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m08:32:01.346729 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:32:01.347190 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m08:32:01.347626 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:32:01.352368 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.352905 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:32:01.353351 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m08:32:01.357255 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:32:01.391676 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:32:01.392472 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m08:32:01.393271 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.396090 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:32:01.396630 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m08:32:01.397377 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.399507 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:32:01.399913 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:32:01.400345 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m08:32:01.401572 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.404908 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m08:32:01.405677 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m08:32:01.407733 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:32:01.409185 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 08:32:01.340280 => 08:32:01.409024
[0m08:32:01.409671 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m08:32:01.410473 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1f8936190>]}
[0m08:32:01.411136 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m08:32:01.411773 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m08:32:01.412588 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m08:32:01.413227 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m08:32:01.413861 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m08:32:01.414274 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m08:32:01.416994 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m08:32:01.417745 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 08:32:01.414586 => 08:32:01.417564
[0m08:32:01.418175 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m08:32:01.422601 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m08:32:01.423333 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:32:01.423767 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m08:32:01.424149 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:32:01.428951 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.429496 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:32:01.429913 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m08:32:01.435108 [debug] [Thread-2  ]: SQL status: SELECT 669 in 0.0 seconds
[0m08:32:01.438459 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:32:01.438899 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m08:32:01.439656 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.442321 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:32:01.442735 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m08:32:01.443508 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:32:01.445582 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:32:01.445983 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:32:01.446376 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m08:32:01.447560 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.449907 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m08:32:01.450346 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m08:32:01.452117 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:32:01.453519 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 08:32:01.418495 => 08:32:01.453358
[0m08:32:01.453944 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m08:32:01.454673 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f299ebcb-2a8e-4d1b-91c5-39f3559f85c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1f892fa90>]}
[0m08:32:01.455300 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m08:32:01.455892 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m08:32:01.528414 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:01.529334 [debug] [MainThread]: On master: BEGIN
[0m08:32:01.530059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:32:01.536852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:32:01.537489 [debug] [MainThread]: On master: COMMIT
[0m08:32:01.538000 [debug] [MainThread]: Using postgres connection "master"
[0m08:32:01.538486 [debug] [MainThread]: On master: COMMIT
[0m08:32:01.539045 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:32:01.539559 [debug] [MainThread]: On master: Close
[0m08:32:01.540336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:32:01.540743 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m08:32:01.541114 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m08:32:01.541483 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m08:32:01.541837 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m08:32:01.542278 [info ] [MainThread]: 
[0m08:32:01.542693 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m08:32:01.543851 [debug] [MainThread]: Command end result
[0m08:32:01.548697 [info ] [MainThread]: 
[0m08:32:01.549176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:32:01.549536 [info ] [MainThread]: 
[0m08:32:01.549884 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:32:01.550531 [debug] [MainThread]: Command `dbt run` succeeded at 08:32:01.550361 after 0.63 seconds
[0m08:32:01.550916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fc395cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1fffbf5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b1f891b210>]}
[0m08:32:01.551350 [debug] [MainThread]: Flushing usage events
[0m11:09:54.344398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa7910>]}


============================== 11:09:54.350244 | 64d637a5-f7cd-4d24-9419-698247ee210d ==============================
[0m11:09:54.350244 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:09:54.350835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:09:54.408834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa7250>]}
[0m11:09:54.424082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b7076ff90>]}
[0m11:09:54.424992 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:09:54.436033 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:09:54.466206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:54.466652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:54.472527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b70727190>]}
[0m11:09:54.477375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b7073bf10>]}
[0m11:09:54.477938 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:09:54.478317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b706f0a50>]}
[0m11:09:54.479692 [info ] [MainThread]: 
[0m11:09:54.480402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:54.481778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:09:54.492207 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:09:54.492701 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:09:54.493049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:54.501898 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:09:54.503301 [debug] [ThreadPool]: On list_finbest: Close
[0m11:09:54.505015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m11:09:54.510843 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:09:54.511326 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:09:54.511679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:54.517151 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.517710 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:09:54.518428 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:09:54.522442 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:09:54.523908 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:09:54.524446 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:09:54.529860 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:54.530416 [debug] [MainThread]: On master: BEGIN
[0m11:09:54.530863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:54.535935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.536461 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:54.536996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:54.541587 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:09:54.542803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b7062b3d0>]}
[0m11:09:54.543346 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:54.543880 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:54.544312 [debug] [MainThread]: On master: BEGIN
[0m11:09:54.544855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.545252 [debug] [MainThread]: On master: COMMIT
[0m11:09:54.545629 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:54.545975 [debug] [MainThread]: On master: COMMIT
[0m11:09:54.546451 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.546855 [debug] [MainThread]: On master: Close
[0m11:09:54.547550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:54.547911 [info ] [MainThread]: 
[0m11:09:54.553054 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:09:54.553503 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:09:54.554259 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:09:54.555214 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:09:54.556024 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:09:54.556618 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:09:54.557366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:09:54.558037 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m11:09:54.558832 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:09:54.559334 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:09:54.559817 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:09:54.560291 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:09:54.566763 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:09:54.568994 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:09:54.570773 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:09:54.571732 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:09:54.560667 => 11:09:54.571534
[0m11:09:54.572227 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:09:54.572800 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:09:54.569440 => 11:09:54.572602
[0m11:09:54.578448 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:09:54.567135 => 11:09:54.578244
[0m11:09:54.578957 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:09:54.585422 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:09:54.630453 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:09:54.630982 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:09:54.634846 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:09:54.636118 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:09:54.636599 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:09:54.637072 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:09:54.637546 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:09:54.637992 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:09:54.638411 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:09:54.638890 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:09:54.639393 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:09:54.639804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:54.644888 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.645814 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.646369 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:09:54.646901 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:09:54.647403 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.647888 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:09:54.648382 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:09:54.648838 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:09:54.649429 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:09:54.653543 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m11:09:54.660324 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:09:54.660909 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:09:54.661449 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:09:54.661909 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:09:54.665236 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:09:54.669097 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:09:54.669579 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.670088 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:09:54.670637 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:09:54.673557 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:09:54.674179 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:09:54.674553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.674983 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.678553 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:09:54.679083 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.681895 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:09:54.682376 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:09:54.693080 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:09:54.703250 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:09:54.703878 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:09:54.704359 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.704792 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.705298 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:09:54.707605 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:09:54.709889 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:09:54.710451 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:09:54.710926 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:09:54.711482 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:09:54.711955 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:09:54.725712 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.726127 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.726681 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.732134 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:09:54.734739 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:09:54.737533 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:09:54.738049 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:09:54.738550 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:09:54.739018 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:09:54.741483 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:09:54.742001 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:09:54.742371 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:09:54.743872 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:09:54.573153 => 11:09:54.743700
[0m11:09:54.745507 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:09:54.611327 => 11:09:54.745342
[0m11:09:54.746830 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:09:54.596069 => 11:09:54.746670
[0m11:09:54.747334 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:09:54.747823 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:09:54.748257 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:09:54.749296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b706f0210>]}
[0m11:09:54.750356 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b6fdf2790>]}
[0m11:09:54.751120 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m11:09:54.751919 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b6f5c8d90>]}
[0m11:09:54.752588 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.19s]
[0m11:09:54.753235 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:09:54.753833 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.19s]
[0m11:09:54.754489 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:09:54.755108 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:09:54.755848 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:09:54.756357 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:09:54.757062 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:09:54.757498 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:09:54.760548 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:09:54.761451 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:09:54.757818 => 11:09:54.761199
[0m11:09:54.762091 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:09:54.770194 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:09:54.771333 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:09:54.771969 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:09:54.772520 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:09:54.778366 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.779237 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:09:54.779962 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:09:54.784931 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m11:09:54.841625 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:09:54.842249 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:09:54.843329 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.846375 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:09:54.846850 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:09:54.847715 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.850588 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:09:54.851063 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:09:54.851469 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:09:54.852526 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.855040 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:09:54.855547 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:09:54.857604 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:09:54.859071 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:09:54.762584 => 11:09:54.858880
[0m11:09:54.859697 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:09:54.860723 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b6f5cf310>]}
[0m11:09:54.861395 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.10s]
[0m11:09:54.861991 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:09:54.862711 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m11:09:54.863213 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:09:54.863841 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m11:09:54.864248 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m11:09:54.867253 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:09:54.868378 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 11:09:54.864592 => 11:09:54.868170
[0m11:09:54.868805 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m11:09:54.872963 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:09:54.874092 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:09:54.874541 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:09:54.874914 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:09:54.879811 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.880371 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:09:54.880797 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:09:54.886638 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m11:09:54.889820 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:09:54.890291 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:09:54.890922 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.893614 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:09:54.894053 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:09:54.894674 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:09:54.896710 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:09:54.897247 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:09:54.897920 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:09:54.899437 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.902737 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:09:54.903211 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:09:54.905196 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:09:54.906613 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 11:09:54.869123 => 11:09:54.906449
[0m11:09:54.907044 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m11:09:54.907780 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d637a5-f7cd-4d24-9419-698247ee210d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b6f4ca650>]}
[0m11:09:54.908407 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m11:09:54.908972 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m11:09:54.957034 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:54.958228 [debug] [MainThread]: On master: BEGIN
[0m11:09:54.959213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:54.969848 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:54.971077 [debug] [MainThread]: On master: COMMIT
[0m11:09:54.972108 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:54.973132 [debug] [MainThread]: On master: COMMIT
[0m11:09:54.974587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:09:54.975578 [debug] [MainThread]: On master: Close
[0m11:09:54.977438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:54.978675 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m11:09:54.979629 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m11:09:54.980483 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:09:54.981104 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:09:54.981722 [info ] [MainThread]: 
[0m11:09:54.982180 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:09:54.983793 [debug] [MainThread]: Command end result
[0m11:09:54.989575 [info ] [MainThread]: 
[0m11:09:54.990274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:54.990758 [info ] [MainThread]: 
[0m11:09:54.991143 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:09:54.991904 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:54.991781 after 0.66 seconds
[0m11:09:54.992338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b74aa7e50>]}
[0m11:09:54.992767 [debug] [MainThread]: Flushing usage events
[0m11:54:24.070987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4272a12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4272a1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4272a1610>]}


============================== 11:54:24.089614 | a346e95a-1faf-4151-9844-67c07ee62eb2 ==============================
[0m11:54:24.089614 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:54:24.090193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:54:24.151146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4272a1e50>]}
[0m11:54:24.167605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4247f5ad0>]}
[0m11:54:24.168658 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:54:24.179205 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:54:24.208616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:54:24.209244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:54:24.215238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d422e02210>]}
[0m11:54:24.221212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d42424b0d0>]}
[0m11:54:24.221806 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:54:24.222203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d42424bbd0>]}
[0m11:54:24.223602 [info ] [MainThread]: 
[0m11:54:24.224376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:54:24.225886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:54:24.236355 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:54:24.236853 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:54:24.237271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:24.248216 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:54:24.249819 [debug] [ThreadPool]: On list_finbest: Close
[0m11:54:24.251520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m11:54:24.257301 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:54:24.257752 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:54:24.258112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:24.262352 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.262834 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:54:24.263235 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:54:24.268738 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:54:24.270235 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:54:24.270754 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:54:24.276485 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:24.276949 [debug] [MainThread]: On master: BEGIN
[0m11:54:24.277371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:24.282075 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.282618 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:24.283077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:24.289056 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:54:24.290215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d42425fe50>]}
[0m11:54:24.290737 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:24.291204 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:24.291580 [debug] [MainThread]: On master: BEGIN
[0m11:54:24.292055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.292454 [debug] [MainThread]: On master: COMMIT
[0m11:54:24.292810 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:24.293184 [debug] [MainThread]: On master: COMMIT
[0m11:54:24.293609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.294026 [debug] [MainThread]: On master: Close
[0m11:54:24.294750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:24.295132 [info ] [MainThread]: 
[0m11:54:24.299937 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:54:24.300428 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:54:24.301205 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:54:24.301892 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:54:24.302623 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:54:24.303180 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:54:24.303897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:54:24.304709 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m11:54:24.305509 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:54:24.305989 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:54:24.306449 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:54:24.306944 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:54:24.314202 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:54:24.316299 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:54:24.318147 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:54:24.319031 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:54:24.307456 => 11:54:24.318797
[0m11:54:24.319525 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:54:24.320075 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:54:24.314646 => 11:54:24.319869
[0m11:54:24.332138 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:54:24.316741 => 11:54:24.331822
[0m11:54:24.342834 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:54:24.354094 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:54:24.367454 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:54:24.371497 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:54:24.375845 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:54:24.376720 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:54:24.377365 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:54:24.377905 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:54:24.378228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:24.378662 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:54:24.379218 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:54:24.380198 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:54:24.380664 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:54:24.381184 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:54:24.384270 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.384809 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:54:24.385266 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:54:24.385883 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.386473 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.386991 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:54:24.387540 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:54:24.387997 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:54:24.388538 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:54:24.392569 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m11:54:24.392972 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:54:24.398770 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:54:24.400507 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:54:24.404352 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:54:24.407367 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:54:24.407901 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:54:24.408486 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:54:24.409024 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:54:24.409826 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.410393 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.413719 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:54:24.414285 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.417754 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:54:24.418374 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:54:24.421480 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:54:24.422022 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:54:24.422670 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:54:24.423175 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.428982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.439799 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.465131 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:54:24.468192 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:54:24.469005 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:54:24.471438 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:54:24.471998 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:54:24.472664 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:54:24.473247 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:54:24.473818 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:54:24.474607 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:54:24.476963 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.484638 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:54:24.485224 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.485798 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:54:24.486189 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.488546 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:54:24.491808 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:54:24.492426 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:54:24.493101 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:54:24.493560 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:54:24.495529 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:54:24.320443 => 11:54:24.495223
[0m11:54:24.496288 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:54:24.496984 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:54:24.498593 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:54:24.359692 => 11:54:24.498414
[0m11:54:24.499099 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:54:24.499696 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:54:24.500521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d422ddb1d0>]}
[0m11:54:24.502170 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:54:24.371960 => 11:54:24.501980
[0m11:54:24.503161 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d422444450>]}
[0m11:54:24.503928 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m11:54:24.504518 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:54:24.505195 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.20s]
[0m11:54:24.505882 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:54:24.506747 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:54:24.507718 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d422dc9d90>]}
[0m11:54:24.509292 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.20s]
[0m11:54:24.510222 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:54:24.510894 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:54:24.511469 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:54:24.512225 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:54:24.512640 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:54:24.515463 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:54:24.516176 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:54:24.512946 => 11:54:24.515983
[0m11:54:24.516595 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:54:24.561212 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:54:24.562031 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:54:24.562506 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:54:24.562898 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:54:24.567846 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.568439 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:54:24.568870 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:54:24.574951 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m11:54:24.578290 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:54:24.578772 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:54:24.579507 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.582777 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:54:24.583496 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:54:24.584248 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.586566 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:54:24.586989 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:54:24.587391 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:54:24.588587 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.591489 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:54:24.591991 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:54:24.593986 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:54:24.595487 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:54:24.516911 => 11:54:24.595336
[0m11:54:24.595911 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:54:24.596857 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4224d2410>]}
[0m11:54:24.597935 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m11:54:24.598947 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:54:24.600028 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m11:54:24.600637 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:54:24.601300 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m11:54:24.601718 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m11:54:24.604391 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:54:24.605152 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 11:54:24.602038 => 11:54:24.604945
[0m11:54:24.605565 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m11:54:24.609890 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:54:24.610628 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:54:24.611116 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:54:24.611500 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:24.616736 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.617428 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:54:24.617891 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:54:24.623462 [debug] [Thread-2  ]: SQL status: SELECT 669 in 0.0 seconds
[0m11:54:24.627057 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:54:24.627569 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:54:24.628262 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.631381 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:54:24.632112 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:54:24.633216 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:24.635548 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:54:24.635988 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:54:24.636382 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:54:24.637647 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.640250 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:54:24.640687 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:54:24.642880 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:54:24.644316 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 11:54:24.605877 => 11:54:24.644146
[0m11:54:24.644756 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m11:54:24.645516 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a346e95a-1faf-4151-9844-67c07ee62eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4271e33d0>]}
[0m11:54:24.646200 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m11:54:24.646805 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m11:54:24.706825 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:24.708039 [debug] [MainThread]: On master: BEGIN
[0m11:54:24.708995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:24.720606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:24.721778 [debug] [MainThread]: On master: COMMIT
[0m11:54:24.722739 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:24.723643 [debug] [MainThread]: On master: COMMIT
[0m11:54:24.724600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:54:24.725097 [debug] [MainThread]: On master: Close
[0m11:54:24.725815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:24.726225 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m11:54:24.726594 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:54:24.726979 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m11:54:24.727366 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:54:24.727811 [info ] [MainThread]: 
[0m11:54:24.728275 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:54:24.729457 [debug] [MainThread]: Command end result
[0m11:54:24.734694 [info ] [MainThread]: 
[0m11:54:24.735183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:24.735532 [info ] [MainThread]: 
[0m11:54:24.735880 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:54:24.736429 [debug] [MainThread]: Command `dbt run` succeeded at 11:54:24.736337 after 0.68 seconds
[0m11:54:24.736831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d42423cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4280b3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d422e08e10>]}
[0m11:54:24.737261 [debug] [MainThread]: Flushing usage events
[0m11:59:54.568159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01fe5a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01fe5aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01fe5a390>]}


============================== 11:59:54.576162 | 91e34781-d674-4277-8fd0-00da24ee2226 ==============================
[0m11:59:54.576162 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:59:54.576819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:59:54.632098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01fe5a950>]}
[0m11:59:54.647543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01fe5acd0>]}
[0m11:59:54.648391 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:59:54.658852 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:59:54.675363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:54.676085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:54.683145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01baaac10>]}
[0m11:59:54.688335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01bae7590>]}
[0m11:59:54.688952 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:59:54.689324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01bae7610>]}
[0m11:59:54.690742 [info ] [MainThread]: 
[0m11:59:54.691640 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:54.693544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:59:54.705007 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:59:54.705544 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:59:54.705945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:54.712849 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:59:54.714627 [debug] [ThreadPool]: On list_finbest: Close
[0m11:59:54.716398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m11:59:54.722025 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:59:54.722503 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:59:54.722946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:54.728105 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:54.728782 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:59:54.729290 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:59:54.731792 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:59:54.733116 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:59:54.733618 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:59:54.738816 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:54.739373 [debug] [MainThread]: On master: BEGIN
[0m11:59:54.739743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:54.744656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:54.745339 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:54.745841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:59:54.750253 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:54.751429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01b9e02d0>]}
[0m11:59:54.751973 [debug] [MainThread]: On master: ROLLBACK
[0m11:59:54.752433 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:54.752803 [debug] [MainThread]: On master: BEGIN
[0m11:59:54.753261 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:54.753760 [debug] [MainThread]: On master: COMMIT
[0m11:59:54.754109 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:54.754445 [debug] [MainThread]: On master: COMMIT
[0m11:59:54.754917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:54.755331 [debug] [MainThread]: On master: Close
[0m11:59:54.756022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:54.756389 [info ] [MainThread]: 
[0m11:59:54.761648 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:59:54.762200 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:59:54.762884 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:59:54.763786 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:59:54.764626 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:59:54.765147 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:59:54.765870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:59:54.766623 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m11:59:54.767361 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:59:54.767848 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:59:54.768266 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:59:54.768721 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:59:54.775287 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:59:54.778916 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:59:54.780822 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:59:54.781734 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:59:54.769101 => 11:59:54.781516
[0m11:59:54.782134 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:59:54.775958 => 11:59:54.781947
[0m11:59:54.782571 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:59:54.779409 => 11:59:54.782384
[0m11:59:54.783257 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:59:54.783921 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:59:54.784401 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:59:54.852759 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:59:54.853409 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:59:54.858972 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:59:54.860543 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:59:54.861397 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:59:54.861972 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:59:54.862479 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:59:54.863035 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:59:54.863531 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:59:54.864181 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:59:54.864671 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:59:54.865147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:59:54.867081 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:59:54.867799 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:59:54.868253 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:59:54.870370 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:59:54.870952 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:59:54.871433 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:59:54.871965 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m11:59:54.872451 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:59:54.872961 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:59:54.881173 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:59:54.881849 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:59:54.882408 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:59:54.883289 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:54.887572 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:59:54.888152 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:59:54.888677 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:59:54.889186 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:59:54.892863 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:59:54.897325 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:59:54.897878 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:54.898492 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:59:54.899022 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:59:54.920238 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:54.921582 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:59:54.925120 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:59:54.925902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:54.926972 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:59:54.927607 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:59:54.930817 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:59:54.931329 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:59:54.931930 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:59:54.932379 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:54.934839 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:59:54.935392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:54.935822 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:59:54.936274 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:59:54.938542 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:59:54.939017 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:59:54.945295 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:59:54.946075 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:59:54.946723 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:59:54.947171 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:59:54.947784 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:59:54.950300 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:59:54.950907 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:59:54.951453 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:54.951958 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:59:54.954453 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:59:54.956047 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:59:54.794988 => 11:59:54.955861
[0m11:59:54.956611 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:59:54.957188 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:59:54.958540 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01b1a3fd0>]}
[0m11:59:54.959226 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:54.959948 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.19s]
[0m11:59:54.960657 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:54.962601 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:59:54.841376 => 11:59:54.962421
[0m11:59:54.963272 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:59:54.964704 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:59:54.784747 => 11:59:54.964530
[0m11:59:54.965176 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:59:54.965783 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:59:54.966595 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01baadcd0>]}
[0m11:59:54.967229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01b14a690>]}
[0m11:59:54.968150 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.20s]
[0m11:59:54.968800 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m11:59:54.969432 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:59:54.970039 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:59:54.970872 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:59:54.971451 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:59:54.972171 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:59:54.972591 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:59:54.975998 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:59:54.977153 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:59:54.972902 => 11:59:54.976876
[0m11:59:54.977721 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:59:55.021784 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:59:55.022551 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:59:55.023097 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:59:55.023495 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:59:55.028777 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:59:55.029561 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:59:55.030060 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:59:55.036422 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m11:59:55.039706 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:59:55.040178 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:59:55.040969 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:55.044541 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:59:55.045352 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:59:55.046267 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:55.048687 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:59:55.049118 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:59:55.049506 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:59:55.050967 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:59:55.053353 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:59:55.053833 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:59:55.056133 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:55.057470 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:59:54.978216 => 11:59:55.057308
[0m11:59:55.057927 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:59:55.058960 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01baadcd0>]}
[0m11:59:55.059686 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.09s]
[0m11:59:55.060362 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:59:55.061219 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m11:59:55.061868 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:59:55.062625 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m11:59:55.063047 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m11:59:55.065781 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:59:55.066469 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 11:59:55.063382 => 11:59:55.066282
[0m11:59:55.066911 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m11:59:55.071094 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:59:55.071846 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:59:55.072285 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:59:55.072679 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:59:55.077995 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:59:55.078634 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:59:55.079099 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:59:55.084305 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m11:59:55.087588 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:59:55.088063 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:59:55.088767 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:55.092023 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:59:55.092545 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:59:55.093428 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:55.096327 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:59:55.096901 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:59:55.097319 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:59:55.098544 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:59:55.101207 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:59:55.101655 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:59:55.103623 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:55.104984 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 11:59:55.067224 => 11:59:55.104822
[0m11:59:55.105411 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m11:59:55.106215 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e34781-d674-4277-8fd0-00da24ee2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01b1a4590>]}
[0m11:59:55.106851 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m11:59:55.107442 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m11:59:55.165193 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:55.166601 [debug] [MainThread]: On master: BEGIN
[0m11:59:55.167608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:55.179023 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:55.180464 [debug] [MainThread]: On master: COMMIT
[0m11:59:55.181571 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:55.182542 [debug] [MainThread]: On master: COMMIT
[0m11:59:55.183797 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:55.184893 [debug] [MainThread]: On master: Close
[0m11:59:55.186505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:55.187430 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m11:59:55.188263 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m11:59:55.189112 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:59:55.189757 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:59:55.190487 [info ] [MainThread]: 
[0m11:59:55.191192 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:59:55.193325 [debug] [MainThread]: Command end result
[0m11:59:55.199575 [info ] [MainThread]: 
[0m11:59:55.200095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:55.200445 [info ] [MainThread]: 
[0m11:59:55.200810 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:59:55.201333 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:55.201244 after 0.64 seconds
[0m11:59:55.201752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01bad0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01d3def50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b01b01dd50>]}
[0m11:59:55.202153 [debug] [MainThread]: Flushing usage events
[0m12:05:01.999106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e27390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e27350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e27990>]}


============================== 12:05:02.004412 | 7fbe3374-26a6-428b-b0ad-0b11842544eb ==============================
[0m12:05:02.004412 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:05:02.005306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:05:02.082118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e59650>]}
[0m12:05:02.096594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e44790>]}
[0m12:05:02.097360 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:05:02.108250 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:05:02.123730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:02.124221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:02.129797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39da646d0>]}
[0m12:05:02.134361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39dab3fd0>]}
[0m12:05:02.134941 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:05:02.135314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39dab3c90>]}
[0m12:05:02.136657 [info ] [MainThread]: 
[0m12:05:02.137358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:02.138698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m12:05:02.148593 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m12:05:02.149080 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m12:05:02.149459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:02.154804 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:05:02.156145 [debug] [ThreadPool]: On list_finbest: Close
[0m12:05:02.158012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m12:05:02.163694 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m12:05:02.164208 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m12:05:02.164789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:02.170929 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.171635 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m12:05:02.172243 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m12:05:02.175774 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:05:02.177652 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m12:05:02.178493 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m12:05:02.186128 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:02.186903 [debug] [MainThread]: On master: BEGIN
[0m12:05:02.187538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:02.195547 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.196589 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:02.197473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:05:02.204787 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:05:02.206897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39da6bb10>]}
[0m12:05:02.207805 [debug] [MainThread]: On master: ROLLBACK
[0m12:05:02.208792 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:02.209519 [debug] [MainThread]: On master: BEGIN
[0m12:05:02.210543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.211269 [debug] [MainThread]: On master: COMMIT
[0m12:05:02.211928 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:02.212492 [debug] [MainThread]: On master: COMMIT
[0m12:05:02.213178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.213744 [debug] [MainThread]: On master: Close
[0m12:05:02.214664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:02.215162 [info ] [MainThread]: 
[0m12:05:02.220056 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m12:05:02.220636 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m12:05:02.221327 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m12:05:02.222022 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m12:05:02.222609 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m12:05:02.223334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m12:05:02.223950 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m12:05:02.224706 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m12:05:02.225206 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m12:05:02.225986 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m12:05:02.226473 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m12:05:02.233333 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m12:05:02.233999 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m12:05:02.237288 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m12:05:02.240271 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m12:05:02.241279 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 12:05:02.226834 => 12:05:02.240978
[0m12:05:02.242217 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m12:05:02.258961 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 12:05:02.238046 => 12:05:02.258430
[0m12:05:02.259602 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 12:05:02.234589 => 12:05:02.259375
[0m12:05:02.275368 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m12:05:02.276096 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m12:05:02.301451 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m12:05:02.304191 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m12:05:02.309563 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m12:05:02.310840 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:05:02.311508 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:05:02.311976 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m12:05:02.312445 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m12:05:02.312932 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:05:02.313401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:02.313875 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:05:02.314364 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m12:05:02.315278 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:05:02.320361 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.321020 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:05:02.321537 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.322053 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m12:05:02.322533 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.322987 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:05:02.323649 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:05:02.324232 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m12:05:02.324777 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m12:05:02.326841 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m12:05:02.334755 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:05:02.335391 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m12:05:02.335788 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:05:02.336326 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m12:05:02.339807 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:05:02.345464 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:05:02.346167 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m12:05:02.346666 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.347138 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:05:02.350320 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:05:02.350789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.351307 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m12:05:02.351761 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.354818 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:05:02.359945 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:05:02.360567 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.361203 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m12:05:02.361974 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:05:02.383382 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.385155 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m12:05:02.387831 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m12:05:02.388426 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.388934 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:05:02.389393 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:05:02.392371 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m12:05:02.393035 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m12:05:02.393709 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m12:05:02.394369 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:05:02.394965 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m12:05:02.395845 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.396316 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.396810 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.402324 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:05:02.404822 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:05:02.408515 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:05:02.409475 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m12:05:02.410110 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m12:05:02.410703 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m12:05:02.412791 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:02.414348 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 12:05:02.304846 => 12:05:02.414179
[0m12:05:02.414895 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:02.415412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:02.415780 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m12:05:02.417378 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 12:05:02.281639 => 12:05:02.417212
[0m12:05:02.418767 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 12:05:02.242913 => 12:05:02.418605
[0m12:05:02.419275 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m12:05:02.420052 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39d183c50>]}
[0m12:05:02.420671 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m12:05:02.421472 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39d9dcbd0>]}
[0m12:05:02.422174 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.20s]
[0m12:05:02.423271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39d9dce50>]}
[0m12:05:02.424710 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.20s]
[0m12:05:02.425970 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m12:05:02.426905 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m12:05:02.427635 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m12:05:02.428498 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m12:05:02.429266 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m12:05:02.429902 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m12:05:02.430706 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m12:05:02.431136 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m12:05:02.434130 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m12:05:02.434822 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 12:05:02.431448 => 12:05:02.434639
[0m12:05:02.435255 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m12:05:02.441254 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m12:05:02.442667 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:05:02.443501 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m12:05:02.444065 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:05:02.448674 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.449215 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:05:02.449653 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m12:05:02.453740 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m12:05:02.500838 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:05:02.501402 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m12:05:02.502112 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.505246 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:05:02.506005 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m12:05:02.506949 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.509952 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m12:05:02.510491 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:05:02.510911 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m12:05:02.512307 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.515092 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:05:02.515543 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m12:05:02.517443 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:02.518870 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 12:05:02.435569 => 12:05:02.518704
[0m12:05:02.519306 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m12:05:02.520157 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39d086810>]}
[0m12:05:02.520820 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.09s]
[0m12:05:02.521452 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m12:05:02.522124 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m12:05:02.522918 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m12:05:02.523748 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m12:05:02.524170 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m12:05:02.527902 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m12:05:02.529145 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 12:05:02.524475 => 12:05:02.528845
[0m12:05:02.529621 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m12:05:02.533958 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m12:05:02.534610 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:05:02.535134 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m12:05:02.535550 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:05:02.540402 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.541170 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:05:02.541812 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m12:05:02.549632 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m12:05:02.553045 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:05:02.553582 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m12:05:02.554320 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.557348 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:05:02.558131 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m12:05:02.559105 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:02.561755 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m12:05:02.562232 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:05:02.562628 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m12:05:02.564123 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.567043 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:05:02.567569 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m12:05:02.569839 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:02.571357 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 12:05:02.529938 => 12:05:02.571190
[0m12:05:02.571814 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m12:05:02.572758 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fbe3374-26a6-428b-b0ad-0b11842544eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d39d04e3d0>]}
[0m12:05:02.573822 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.05s]
[0m12:05:02.574781 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m12:05:02.623224 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:02.625321 [debug] [MainThread]: On master: BEGIN
[0m12:05:02.626789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:02.636456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:02.637355 [debug] [MainThread]: On master: COMMIT
[0m12:05:02.637826 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:02.638186 [debug] [MainThread]: On master: COMMIT
[0m12:05:02.638669 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:05:02.639109 [debug] [MainThread]: On master: Close
[0m12:05:02.640012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:02.640614 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m12:05:02.641157 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m12:05:02.641589 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m12:05:02.641953 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m12:05:02.642385 [info ] [MainThread]: 
[0m12:05:02.642825 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:05:02.644003 [debug] [MainThread]: Command end result
[0m12:05:02.649009 [info ] [MainThread]: 
[0m12:05:02.649485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:02.649839 [info ] [MainThread]: 
[0m12:05:02.650202 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:05:02.650744 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:02.650648 after 0.66 seconds
[0m12:05:02.651136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e27bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e27a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d3a1e27ad0>]}
[0m12:05:02.651541 [debug] [MainThread]: Flushing usage events
[0m12:22:01.636200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb2da402d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb2da40290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb2da409d0>]}


============================== 12:22:01.641134 | c85856d5-a535-41c8-b716-52cd9a8b1b28 ==============================
[0m12:22:01.641134 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:22:01.641728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:22:01.698942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb2da6c6d0>]}
[0m12:22:01.715247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb2da40cd0>]}
[0m12:22:01.716118 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:22:01.727593 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:22:01.746633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:01.747300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:01.753447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb29684390>]}
[0m12:22:01.758500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb296cadd0>]}
[0m12:22:01.759073 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:22:01.759453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb296cae90>]}
[0m12:22:01.761124 [info ] [MainThread]: 
[0m12:22:01.762345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:01.764137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m12:22:01.775296 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m12:22:01.775841 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m12:22:01.776249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:01.782279 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:22:01.783858 [debug] [ThreadPool]: On list_finbest: Close
[0m12:22:01.785865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m12:22:01.793219 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m12:22:01.793789 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m12:22:01.794268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:01.798618 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:01.799136 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m12:22:01.799541 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m12:22:01.801744 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:22:01.803348 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m12:22:01.804055 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m12:22:01.810570 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:01.811061 [debug] [MainThread]: On master: BEGIN
[0m12:22:01.811425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:01.815862 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:01.816335 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:01.816761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:01.821931 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:01.823453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28d7ead0>]}
[0m12:22:01.824014 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:01.824494 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:01.824869 [debug] [MainThread]: On master: BEGIN
[0m12:22:01.825318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:01.825688 [debug] [MainThread]: On master: COMMIT
[0m12:22:01.826041 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:01.826372 [debug] [MainThread]: On master: COMMIT
[0m12:22:01.826762 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:01.827115 [debug] [MainThread]: On master: Close
[0m12:22:01.827767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:22:01.828140 [info ] [MainThread]: 
[0m12:22:01.833102 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m12:22:01.833674 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m12:22:01.834341 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m12:22:01.835239 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m12:22:01.835964 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m12:22:01.836642 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m12:22:01.837487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m12:22:01.838358 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m12:22:01.839292 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m12:22:01.839869 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m12:22:01.840433 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m12:22:01.841008 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m12:22:01.847600 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m12:22:01.849916 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m12:22:01.851877 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m12:22:01.853198 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 12:22:01.847985 => 12:22:01.852933
[0m12:22:01.853798 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 12:22:01.841351 => 12:22:01.853595
[0m12:22:01.854422 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 12:22:01.850329 => 12:22:01.854194
[0m12:22:01.855119 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m12:22:01.855776 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m12:22:01.856295 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m12:22:01.936249 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m12:22:01.939691 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m12:22:01.941234 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m12:22:01.942193 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:22:01.942867 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m12:22:01.943303 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:22:01.944042 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:22:01.944537 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:22:01.945051 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m12:22:01.945681 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m12:22:01.946174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:22:01.946863 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:22:01.948182 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:22:01.948772 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:22:01.949316 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m12:22:01.951280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:22:01.951871 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:22:01.952688 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:22:01.953230 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m12:22:01.953769 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m12:22:01.954501 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:22:01.960746 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m12:22:01.961227 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m12:22:01.963665 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:22:01.967433 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:22:01.968116 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m12:22:01.968654 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m12:22:01.969894 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:01.970474 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:01.974764 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:22:01.975388 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:22:01.978784 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:22:01.979525 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m12:22:01.982771 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:22:01.983258 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m12:22:01.983799 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:22:01.984221 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:01.990019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:01.990627 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:02.020542 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:22:02.026380 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:22:02.028661 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m12:22:02.029747 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m12:22:02.030258 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:02.030866 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:22:02.031376 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:22:02.033808 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m12:22:02.034459 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m12:22:02.034996 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m12:22:02.035506 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:22:02.036151 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m12:22:02.037598 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:22:02.038501 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:22:02.044265 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:22:02.046888 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:22:02.047460 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:22:02.047990 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m12:22:02.048517 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m12:22:02.050948 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:22:02.051690 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m12:22:02.053911 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:22:02.054776 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:22:02.055482 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:22:02.057032 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 12:22:01.856670 => 12:22:02.056864
[0m12:22:02.058507 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 12:22:01.918037 => 12:22:02.058343
[0m12:22:02.060004 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 12:22:01.866851 => 12:22:02.059840
[0m12:22:02.060507 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m12:22:02.060986 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m12:22:02.061450 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m12:22:02.062333 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28ce85d0>]}
[0m12:22:02.063199 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28da5f10>]}
[0m12:22:02.064002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28d86590>]}
[0m12:22:02.065048 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.22s]
[0m12:22:02.065725 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m12:22:02.066354 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.23s]
[0m12:22:02.067035 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m12:22:02.067660 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m12:22:02.068281 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m12:22:02.069606 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m12:22:02.070683 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m12:22:02.071673 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m12:22:02.072189 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m12:22:02.076014 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m12:22:02.076765 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 12:22:02.072504 => 12:22:02.076559
[0m12:22:02.077198 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m12:22:02.118284 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m12:22:02.119555 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:22:02.120114 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m12:22:02.120566 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:22:02.125531 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:22:02.126094 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:22:02.126553 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m12:22:02.130786 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m12:22:02.134031 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:22:02.134611 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m12:22:02.135313 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:02.139029 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:22:02.139556 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m12:22:02.140251 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:02.142519 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m12:22:02.142964 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:22:02.143357 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m12:22:02.144636 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m12:22:02.147191 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:22:02.147676 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m12:22:02.149531 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:22:02.150988 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 12:22:02.077501 => 12:22:02.150821
[0m12:22:02.151489 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m12:22:02.152295 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb295ce710>]}
[0m12:22:02.153124 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m12:22:02.153818 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m12:22:02.154777 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m12:22:02.155507 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m12:22:02.156215 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m12:22:02.156652 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m12:22:02.159402 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m12:22:02.160114 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 12:22:02.156966 => 12:22:02.159933
[0m12:22:02.160544 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m12:22:02.164630 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m12:22:02.165268 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:22:02.165707 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m12:22:02.166076 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:22:02.171126 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:22:02.171870 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:22:02.172340 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m12:22:02.177463 [debug] [Thread-3  ]: SQL status: SELECT 669 in 0.0 seconds
[0m12:22:02.180841 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:22:02.181290 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m12:22:02.182043 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:02.185016 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:22:02.185616 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m12:22:02.186345 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:02.188561 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m12:22:02.189048 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:22:02.189439 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m12:22:02.190739 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:22:02.193336 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:22:02.193848 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m12:22:02.195863 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:22:02.197314 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 12:22:02.160868 => 12:22:02.197150
[0m12:22:02.197779 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m12:22:02.198509 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85856d5-a535-41c8-b716-52cd9a8b1b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28cebd10>]}
[0m12:22:02.199139 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m12:22:02.199713 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m12:22:02.249390 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:02.250618 [debug] [MainThread]: On master: BEGIN
[0m12:22:02.251613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:02.262564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:02.263817 [debug] [MainThread]: On master: COMMIT
[0m12:22:02.264780 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:02.265687 [debug] [MainThread]: On master: COMMIT
[0m12:22:02.266935 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:02.267999 [debug] [MainThread]: On master: Close
[0m12:22:02.269696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:02.270939 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m12:22:02.272551 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m12:22:02.273620 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m12:22:02.274428 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m12:22:02.275506 [info ] [MainThread]: 
[0m12:22:02.276373 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:22:02.278274 [debug] [MainThread]: Command end result
[0m12:22:02.284171 [info ] [MainThread]: 
[0m12:22:02.284675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:02.285060 [info ] [MainThread]: 
[0m12:22:02.285450 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:22:02.286010 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:02.285923 after 0.66 seconds
[0m12:22:02.286443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28c3f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28c85590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdb28c85510>]}
[0m12:22:02.286897 [debug] [MainThread]: Flushing usage events
[0m12:37:46.668501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc2b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc2b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc2b9d0>]}


============================== 12:37:46.674342 | 344a23ff-a83f-4ee8-b3f6-0f3feeaba26a ==============================
[0m12:37:46.674342 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:37:46.674866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:37:46.733320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc5b790>]}
[0m12:37:46.749009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d91e7fd0>]}
[0m12:37:46.750008 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:37:46.762177 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:37:46.790818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:46.791275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:46.797227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d791db50>]}
[0m12:37:46.801961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d78b6e50>]}
[0m12:37:46.802518 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:37:46.802883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d78b6dd0>]}
[0m12:37:46.804250 [info ] [MainThread]: 
[0m12:37:46.804977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:46.806325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m12:37:46.816575 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m12:37:46.817041 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m12:37:46.817397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:46.823166 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:37:46.824592 [debug] [ThreadPool]: On list_finbest: Close
[0m12:37:46.826209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m12:37:46.831917 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m12:37:46.832379 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m12:37:46.832831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:46.837195 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:37:46.837689 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m12:37:46.838057 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m12:37:46.841225 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:37:46.842486 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m12:37:46.843017 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m12:37:46.848250 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:46.848715 [debug] [MainThread]: On master: BEGIN
[0m12:37:46.849069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:46.853824 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:37:46.854391 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:46.854976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:46.859802 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:37:46.861158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d78cb3d0>]}
[0m12:37:46.861710 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:46.862208 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:46.862663 [debug] [MainThread]: On master: BEGIN
[0m12:37:46.863151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:37:46.863519 [debug] [MainThread]: On master: COMMIT
[0m12:37:46.863908 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:46.864254 [debug] [MainThread]: On master: COMMIT
[0m12:37:46.864672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:37:46.865047 [debug] [MainThread]: On master: Close
[0m12:37:46.865731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:46.866105 [info ] [MainThread]: 
[0m12:37:46.870967 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m12:37:46.871704 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m12:37:46.872542 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m12:37:46.873423 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m12:37:46.874122 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m12:37:46.874906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m12:37:46.875468 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m12:37:46.876363 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m12:37:46.876845 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m12:37:46.877598 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m12:37:46.878026 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m12:37:46.884547 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m12:37:46.885012 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m12:37:46.887224 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m12:37:46.889618 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m12:37:46.890845 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 12:37:46.878395 => 12:37:46.890589
[0m12:37:46.891370 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 12:37:46.885361 => 12:37:46.891204
[0m12:37:46.891893 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 12:37:46.887808 => 12:37:46.891688
[0m12:37:46.892398 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m12:37:46.892877 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m12:37:46.893414 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m12:37:46.986412 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m12:37:46.988509 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m12:37:46.982475 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m12:37:46.990152 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:37:46.990692 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:37:46.991202 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:37:46.991655 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m12:37:46.992122 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m12:37:46.992597 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m12:37:46.993095 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:37:46.993553 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:37:46.994023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:46.998952 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:37:46.999603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:37:47.000174 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:37:47.000661 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:37:47.001215 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:37:47.001718 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m12:37:47.002226 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m12:37:47.002759 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:37:47.003443 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m12:37:47.007634 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m12:37:47.008583 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m12:37:47.009232 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:37:47.019490 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:37:47.020938 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:37:47.025689 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:37:47.026420 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m12:37:47.027070 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m12:37:47.027863 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:37:47.028969 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.029478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.029950 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.033073 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:37:47.035981 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:37:47.039854 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:37:47.040436 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m12:37:47.041004 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m12:37:47.041539 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:37:47.042338 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.042855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.048504 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.078634 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m12:37:47.081731 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m12:37:47.084251 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m12:37:47.084741 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:37:47.085291 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:37:47.085896 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:37:47.086376 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m12:37:47.086954 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m12:37:47.087431 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m12:37:47.089426 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:37:47.090158 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:37:47.090604 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:37:47.096786 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m12:37:47.099548 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m12:37:47.102299 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m12:37:47.102958 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m12:37:47.103613 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m12:37:47.104357 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m12:37:47.106871 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:37:47.107447 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:37:47.108007 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:37:47.110120 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 12:37:46.905056 => 12:37:47.109947
[0m12:37:47.111739 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 12:37:46.893804 => 12:37:47.111562
[0m12:37:47.113095 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 12:37:46.926732 => 12:37:47.112926
[0m12:37:47.113623 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m12:37:47.114154 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m12:37:47.114646 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m12:37:47.115734 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d77b8210>]}
[0m12:37:47.116841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d6f7edd0>]}
[0m12:37:47.117814 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d77b2890>]}
[0m12:37:47.118762 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.24s]
[0m12:37:47.119414 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.24s]
[0m12:37:47.120062 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.24s]
[0m12:37:47.120706 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m12:37:47.121476 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m12:37:47.122371 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m12:37:47.123482 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m12:37:47.124237 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m12:37:47.125219 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m12:37:47.125689 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m12:37:47.128647 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m12:37:47.129367 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 12:37:47.126029 => 12:37:47.129170
[0m12:37:47.129868 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m12:37:47.135054 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m12:37:47.135773 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:37:47.136249 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m12:37:47.136744 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:37:47.141273 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:37:47.141829 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:37:47.142272 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m12:37:47.147598 [debug] [Thread-4  ]: SQL status: SELECT 669 in 0.0 seconds
[0m12:37:47.189867 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:37:47.190666 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m12:37:47.191704 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.194708 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:37:47.195129 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m12:37:47.195738 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.198030 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m12:37:47.198481 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:37:47.198890 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m12:37:47.200118 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m12:37:47.202593 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m12:37:47.203086 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m12:37:47.205374 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:37:47.207137 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 12:37:47.130209 => 12:37:47.206955
[0m12:37:47.207719 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m12:37:47.208609 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8da60f710>]}
[0m12:37:47.209244 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 669[0m in 0.08s]
[0m12:37:47.209825 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m12:37:47.210493 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m12:37:47.211100 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m12:37:47.211827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m12:37:47.212316 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m12:37:47.215137 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m12:37:47.215850 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 12:37:47.212654 => 12:37:47.215657
[0m12:37:47.216289 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m12:37:47.220618 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m12:37:47.221392 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:37:47.221918 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m12:37:47.222352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:47.227920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:37:47.228473 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:37:47.228914 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m12:37:47.233809 [debug] [Thread-1  ]: SQL status: SELECT 669 in 0.0 seconds
[0m12:37:47.237236 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:37:47.237877 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m12:37:47.238713 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.242325 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:37:47.242997 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m12:37:47.243673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:47.245842 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m12:37:47.246276 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:37:47.246705 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m12:37:47.247824 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:37:47.250217 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m12:37:47.250791 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m12:37:47.252868 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:37:47.254538 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 12:37:47.216608 => 12:37:47.254337
[0m12:37:47.255384 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m12:37:47.256369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344a23ff-a83f-4ee8-b3f6-0f3feeaba26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8d6dfd2d0>]}
[0m12:37:47.257303 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 669[0m in 0.04s]
[0m12:37:47.258066 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m12:37:47.291470 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:47.292225 [debug] [MainThread]: On master: BEGIN
[0m12:37:47.292682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:47.297187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:37:47.297707 [debug] [MainThread]: On master: COMMIT
[0m12:37:47.298102 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:47.298453 [debug] [MainThread]: On master: COMMIT
[0m12:37:47.298892 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:37:47.299271 [debug] [MainThread]: On master: Close
[0m12:37:47.299972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:47.300338 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m12:37:47.300672 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m12:37:47.300991 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m12:37:47.301300 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m12:37:47.301683 [info ] [MainThread]: 
[0m12:37:47.302049 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m12:37:47.303254 [debug] [MainThread]: Command end result
[0m12:37:47.309804 [info ] [MainThread]: 
[0m12:37:47.310342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:47.310719 [info ] [MainThread]: 
[0m12:37:47.311085 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:37:47.311617 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:47.311520 after 0.65 seconds
[0m12:37:47.312027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc2b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc2b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec8dbc2bc90>]}
[0m12:37:47.312430 [debug] [MainThread]: Flushing usage events
[0m16:42:30.957937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3780e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3780ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3780e610>]}


============================== 16:42:30.973742 | 3fc3a70a-f6c3-44db-b40b-299fe0876999 ==============================
[0m16:42:30.973742 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:42:30.974311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:42:31.033469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3783d8d0>]}
[0m16:42:31.048198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3780e890>]}
[0m16:42:31.049110 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:42:31.059560 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:42:31.087832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:31.088270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:31.093683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c36fb29d0>]}
[0m16:42:31.099352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c36fcce90>]}
[0m16:42:31.099949 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:42:31.100305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c36fccfd0>]}
[0m16:42:31.101708 [info ] [MainThread]: 
[0m16:42:31.102385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:31.103829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m16:42:31.113728 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m16:42:31.114172 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m16:42:31.114555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:31.120164 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:42:31.121511 [debug] [ThreadPool]: On list_finbest: Close
[0m16:42:31.123267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m16:42:31.128977 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m16:42:31.129556 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m16:42:31.129993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:31.135652 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.136298 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m16:42:31.136859 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m16:42:31.140895 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:42:31.142662 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m16:42:31.143381 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m16:42:31.149926 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:31.150800 [debug] [MainThread]: On master: BEGIN
[0m16:42:31.151518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:31.159907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.160761 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:31.161585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:31.169173 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:31.171274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c36fc27d0>]}
[0m16:42:31.172113 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:31.172954 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:31.173614 [debug] [MainThread]: On master: BEGIN
[0m16:42:31.174574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.175378 [debug] [MainThread]: On master: COMMIT
[0m16:42:31.176142 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:31.176847 [debug] [MainThread]: On master: COMMIT
[0m16:42:31.177631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.178232 [debug] [MainThread]: On master: Close
[0m16:42:31.179413 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:31.180068 [info ] [MainThread]: 
[0m16:42:31.185488 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m16:42:31.185916 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m16:42:31.186609 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m16:42:31.186964 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m16:42:31.187593 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m16:42:31.188427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m16:42:31.189017 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m16:42:31.189943 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m16:42:31.190620 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m16:42:31.191364 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m16:42:31.191818 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m16:42:31.198858 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m16:42:31.199354 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m16:42:31.201093 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m16:42:31.203097 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m16:42:31.203903 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 16:42:31.192159 => 16:42:31.203694
[0m16:42:31.204412 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m16:42:31.225541 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 16:42:31.201561 => 16:42:31.225290
[0m16:42:31.231186 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m16:42:31.248382 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m16:42:31.252151 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m16:42:31.253038 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 16:42:31.199768 => 16:42:31.252826
[0m16:42:31.253547 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m16:42:31.253904 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:42:31.254315 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:42:31.258599 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m16:42:31.259274 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m16:42:31.259853 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m16:42:31.260418 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:42:31.261087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:31.261596 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:42:31.262306 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m16:42:31.262775 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:42:31.266822 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.267392 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:42:31.267954 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m16:42:31.268293 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.269057 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.269809 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:42:31.270284 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:42:31.270792 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m16:42:31.271265 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m16:42:31.271720 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m16:42:31.278130 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:42:31.278808 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m16:42:31.279287 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m16:42:31.279786 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m16:42:31.283437 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:42:31.286477 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:42:31.286845 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:31.287567 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m16:42:31.288204 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m16:42:31.299145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:31.317953 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m16:42:31.315086 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m16:42:31.318724 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:42:31.319548 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:42:31.320054 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:31.320573 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m16:42:31.321026 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m16:42:31.322918 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m16:42:31.323525 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:42:31.323956 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m16:42:31.324374 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.324846 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.330207 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:42:31.330671 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.333568 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:42:31.334347 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m16:42:31.337438 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:42:31.338147 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m16:42:31.338797 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m16:42:31.339261 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:31.340898 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 16:42:31.254926 => 16:42:31.340715
[0m16:42:31.341409 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:31.341936 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:31.342374 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m16:42:31.343796 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 16:42:31.204747 => 16:42:31.343649
[0m16:42:31.345047 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 16:42:31.241955 => 16:42:31.344903
[0m16:42:31.345814 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c36fd69d0>]}
[0m16:42:31.346334 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m16:42:31.346878 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m16:42:31.347512 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.16s]
[0m16:42:31.348244 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m16:42:31.349029 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35314dd0>]}
[0m16:42:31.350127 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35b8b310>]}
[0m16:42:31.350816 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.16s]
[0m16:42:31.351532 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.16s]
[0m16:42:31.352171 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m16:42:31.352809 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m16:42:31.353591 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m16:42:31.354148 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m16:42:31.354882 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m16:42:31.355310 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m16:42:31.358125 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m16:42:31.358832 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 16:42:31.355636 => 16:42:31.358644
[0m16:42:31.359277 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m16:42:31.363265 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m16:42:31.363915 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:42:31.364339 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m16:42:31.364731 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:42:31.369247 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.369799 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:42:31.370263 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m16:42:31.375652 [debug] [Thread-4  ]: SQL status: SELECT 490 in 0.0 seconds
[0m16:42:31.379002 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:42:31.379707 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m16:42:31.380584 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:31.382988 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m16:42:31.383530 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:42:31.384057 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m16:42:31.385393 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.387758 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:42:31.388234 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m16:42:31.388849 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:31.390118 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 16:42:31.359591 => 16:42:31.389968
[0m16:42:31.390536 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m16:42:31.391248 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35b86a50>]}
[0m16:42:31.391908 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 490[0m in 0.04s]
[0m16:42:31.392525 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m16:42:31.393204 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m16:42:31.393815 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m16:42:31.394462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m16:42:31.394906 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m16:42:31.398500 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m16:42:31.399442 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 16:42:31.395227 => 16:42:31.399241
[0m16:42:31.399903 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m16:42:31.434552 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m16:42:31.435285 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:42:31.435778 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m16:42:31.436153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:31.440641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.441208 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:42:31.441672 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m16:42:31.446293 [debug] [Thread-1  ]: SQL status: SELECT 490 in 0.0 seconds
[0m16:42:31.449230 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:42:31.449714 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m16:42:31.450347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:31.452239 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m16:42:31.452683 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:42:31.453111 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m16:42:31.454240 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.456890 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:42:31.457341 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m16:42:31.458025 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:31.459303 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 16:42:31.400227 => 16:42:31.459146
[0m16:42:31.459756 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m16:42:31.460462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fc3a70a-f6c3-44db-b40b-299fe0876999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3783d4d0>]}
[0m16:42:31.461147 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 490[0m in 0.07s]
[0m16:42:31.461753 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m16:42:31.489417 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:31.490438 [debug] [MainThread]: On master: BEGIN
[0m16:42:31.491229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:31.495983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:31.496474 [debug] [MainThread]: On master: COMMIT
[0m16:42:31.496897 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:31.497275 [debug] [MainThread]: On master: COMMIT
[0m16:42:31.497703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:31.498091 [debug] [MainThread]: On master: Close
[0m16:42:31.498757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:31.499125 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m16:42:31.499472 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m16:42:31.499828 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m16:42:31.500169 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m16:42:31.500573 [info ] [MainThread]: 
[0m16:42:31.500952 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m16:42:31.502084 [debug] [MainThread]: Command end result
[0m16:42:31.506513 [info ] [MainThread]: 
[0m16:42:31.507027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:31.507420 [info ] [MainThread]: 
[0m16:42:31.507823 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:42:31.508378 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:31.508292 after 0.56 seconds
[0m16:42:31.508801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c36f2bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3783d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35261490>]}
[0m16:42:31.509242 [debug] [MainThread]: Flushing usage events
[0m18:43:53.458324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701035e8d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701035e8d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701035e8d050>]}


============================== 18:43:53.463359 | 7e593bff-ee3b-435a-9396-c152c9ae0df0 ==============================
[0m18:43:53.463359 [info ] [MainThread]: Running with dbt=1.5.11
[0m18:43:53.463903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:43:53.522530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701035ebd510>]}
[0m18:43:53.537516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70103344a590>]}
[0m18:43:53.538427 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m18:43:53.549740 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m18:43:53.578139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:53.578587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:53.584239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701031acfdd0>]}
[0m18:43:53.589355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701031b17fd0>]}
[0m18:43:53.589872 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:43:53.590202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701031b17c50>]}
[0m18:43:53.591461 [info ] [MainThread]: 
[0m18:43:53.592106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:53.593321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m18:43:53.603202 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m18:43:53.603635 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m18:43:53.603977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:53.610957 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:43:53.612314 [debug] [ThreadPool]: On list_finbest: Close
[0m18:43:53.614350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m18:43:53.620120 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m18:43:53.620696 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m18:43:53.621105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:53.626473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.627027 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m18:43:53.627506 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m18:43:53.630568 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:43:53.632030 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m18:43:53.632700 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m18:43:53.638414 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:53.639003 [debug] [MainThread]: On master: BEGIN
[0m18:43:53.639524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:53.645675 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.646281 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:53.646844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:53.651913 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:43:53.653423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701031a12f50>]}
[0m18:43:53.654115 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:53.654819 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:53.655344 [debug] [MainThread]: On master: BEGIN
[0m18:43:53.656011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.656513 [debug] [MainThread]: On master: COMMIT
[0m18:43:53.656974 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:53.657408 [debug] [MainThread]: On master: COMMIT
[0m18:43:53.657918 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:53.658331 [debug] [MainThread]: On master: Close
[0m18:43:53.658999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:53.659360 [info ] [MainThread]: 
[0m18:43:53.664391 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m18:43:53.664841 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m18:43:53.665561 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m18:43:53.666108 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m18:43:53.666761 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m18:43:53.667639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m18:43:53.668344 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m18:43:53.669040 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m18:43:53.669539 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m18:43:53.670250 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m18:43:53.670739 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m18:43:53.676424 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m18:43:53.677612 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m18:43:53.679771 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m18:43:53.681544 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m18:43:53.682424 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 18:43:53.671129 => 18:43:53.682213
[0m18:43:53.683076 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 18:43:53.677985 => 18:43:53.682900
[0m18:43:53.683540 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m18:43:53.684052 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m18:43:53.689751 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 18:43:53.680193 => 18:43:53.689548
[0m18:43:53.706619 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m18:43:53.759093 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m18:43:53.762675 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m18:43:53.765051 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m18:43:53.766327 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:43:53.767040 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:43:53.767653 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m18:43:53.768353 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m18:43:53.769140 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:43:53.769883 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:43:53.770555 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:43:53.771261 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m18:43:53.772360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:53.777714 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.778416 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:43:53.779042 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.779656 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m18:43:53.780202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.780757 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:43:53.781262 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:43:53.781745 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m18:43:53.782193 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m18:43:53.786639 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m18:43:53.787164 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m18:43:53.792752 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m18:43:53.794545 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:43:53.798156 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:43:53.801148 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:43:53.801672 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m18:43:53.802104 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m18:43:53.802536 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m18:43:53.803390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.803970 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.804429 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.807281 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:43:53.810038 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:43:53.812762 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:43:53.813270 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m18:43:53.813834 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m18:43:53.814270 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:43:53.815159 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.815674 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.816142 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.849621 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m18:43:53.850383 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:43:53.851006 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m18:43:53.851474 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m18:43:53.853911 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m18:43:53.854492 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:43:53.854990 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:43:53.855497 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:43:53.860960 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:43:53.861543 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m18:43:53.862075 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m18:43:53.862613 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m18:43:53.863942 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:43:53.864476 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:43:53.867145 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:43:53.867799 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:53.870328 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:43:53.870893 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m18:43:53.872619 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 18:43:53.690108 => 18:43:53.872397
[0m18:43:53.873241 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m18:43:53.874023 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m18:43:53.875148 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010311dabd0>]}
[0m18:43:53.875939 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.21s]
[0m18:43:53.876482 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:53.877226 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m18:43:53.877776 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:53.879337 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 18:43:53.684445 => 18:43:53.879174
[0m18:43:53.880954 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 18:43:53.712117 => 18:43:53.880793
[0m18:43:53.881486 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m18:43:53.882034 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m18:43:53.882909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701031b20550>]}
[0m18:43:53.883761 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701031ae4c10>]}
[0m18:43:53.884495 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m18:43:53.885244 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.21s]
[0m18:43:53.885988 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m18:43:53.886697 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m18:43:53.887618 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m18:43:53.888207 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m18:43:53.888972 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m18:43:53.889430 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m18:43:53.893383 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m18:43:53.894254 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 18:43:53.889780 => 18:43:53.894050
[0m18:43:53.894695 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m18:43:53.928778 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m18:43:53.929500 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:43:53.929921 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m18:43:53.930301 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:43:53.935093 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.935611 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:43:53.936020 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m18:43:53.941037 [debug] [Thread-4  ]: SQL status: SELECT 490 in 0.0 seconds
[0m18:43:53.945014 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:43:53.945777 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m18:43:53.946751 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.949767 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:43:53.950301 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m18:43:53.951240 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.954089 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m18:43:53.954554 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:43:53.954963 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m18:43:53.956595 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:43:53.959432 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:43:53.959899 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m18:43:53.961858 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:53.963256 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 18:43:53.895019 => 18:43:53.963092
[0m18:43:53.963723 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m18:43:53.964432 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010345ab490>]}
[0m18:43:53.965083 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 490[0m in 0.08s]
[0m18:43:53.965716 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m18:43:53.966633 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m18:43:53.967255 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m18:43:53.967917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m18:43:53.968412 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m18:43:53.971275 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m18:43:53.972023 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 18:43:53.968749 => 18:43:53.971827
[0m18:43:53.972478 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m18:43:53.976395 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m18:43:53.977041 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:43:53.977434 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m18:43:53.977808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:53.982329 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:43:53.982840 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:43:53.983283 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m18:43:53.987679 [debug] [Thread-1  ]: SQL status: SELECT 490 in 0.0 seconds
[0m18:43:53.991027 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:43:53.991503 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m18:43:53.992199 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.994909 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:43:53.995344 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m18:43:53.996006 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:53.998126 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m18:43:53.998529 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:43:53.998924 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m18:43:54.000111 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:43:54.002664 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:43:54.003130 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m18:43:54.006610 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:54.008025 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 18:43:53.972812 => 18:43:54.007861
[0m18:43:54.008480 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m18:43:54.009259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e593bff-ee3b-435a-9396-c152c9ae0df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701030862450>]}
[0m18:43:54.009906 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 490[0m in 0.04s]
[0m18:43:54.010517 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m18:43:54.070243 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:54.071451 [debug] [MainThread]: On master: BEGIN
[0m18:43:54.072409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:54.083018 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:54.084190 [debug] [MainThread]: On master: COMMIT
[0m18:43:54.085187 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:54.086899 [debug] [MainThread]: On master: COMMIT
[0m18:43:54.088754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:54.089743 [debug] [MainThread]: On master: Close
[0m18:43:54.090708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:54.091070 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m18:43:54.091387 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m18:43:54.091709 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m18:43:54.092016 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m18:43:54.092392 [info ] [MainThread]: 
[0m18:43:54.092759 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:43:54.093857 [debug] [MainThread]: Command end result
[0m18:43:54.098905 [info ] [MainThread]: 
[0m18:43:54.099363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:54.099739 [info ] [MainThread]: 
[0m18:43:54.100083 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:43:54.100596 [debug] [MainThread]: Command `dbt run` succeeded at 18:43:54.100506 after 0.65 seconds
[0m18:43:54.100994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701035e81fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70103340eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70103453abd0>]}
[0m18:43:54.101396 [debug] [MainThread]: Flushing usage events
[0m14:35:55.469632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a32d77350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a32d77cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a32d77650>]}


============================== 14:35:55.484947 | e480c6f4-017a-42fe-a759-c9daf63f9659 ==============================
[0m14:35:55.484947 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:35:55.485503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'debug': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:35:55.539000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2fc6ff90>]}
[0m14:35:55.554117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a32d77cd0>]}
[0m14:35:55.554989 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:35:55.565283 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:35:55.594830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:55.595318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:55.600917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2e8d3250>]}
[0m14:35:55.606036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2fd23550>]}
[0m14:35:55.606555 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:35:55.606899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2fd23850>]}
[0m14:35:55.608231 [info ] [MainThread]: 
[0m14:35:55.608882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:55.610160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:35:55.619746 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:35:55.620203 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:35:55.620611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:55.627029 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:35:55.628637 [debug] [ThreadPool]: On list_finbest: Close
[0m14:35:55.630542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m14:35:55.636251 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:35:55.636756 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:35:55.637173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:55.642887 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.643567 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:35:55.644138 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:35:55.648716 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:35:55.650920 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:35:55.651671 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:35:55.660022 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:55.660855 [debug] [MainThread]: On master: BEGIN
[0m14:35:55.661552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:55.668942 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.669791 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:55.670703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:55.680205 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:35:55.682040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2fd38850>]}
[0m14:35:55.682869 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:55.683782 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:55.684459 [debug] [MainThread]: On master: BEGIN
[0m14:35:55.685240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.685850 [debug] [MainThread]: On master: COMMIT
[0m14:35:55.686400 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:55.686924 [debug] [MainThread]: On master: COMMIT
[0m14:35:55.687553 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:35:55.688165 [debug] [MainThread]: On master: Close
[0m14:35:55.689412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:35:55.690130 [info ] [MainThread]: 
[0m14:35:55.695757 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:35:55.696316 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:35:55.697119 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:35:55.697627 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:35:55.698235 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:35:55.698930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:35:55.699494 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:35:55.700202 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m14:35:55.700675 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:35:55.701432 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:35:55.701917 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:35:55.708863 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:35:55.709371 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:35:55.711054 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:35:55.713429 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:35:55.714171 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:35:55.702271 => 14:35:55.713951
[0m14:35:55.714768 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:35:55.726638 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:35:55.709768 => 14:35:55.726379
[0m14:35:55.732391 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:35:55.743507 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:35:55.711738 => 14:35:55.743226
[0m14:35:55.749315 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:35:55.773134 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:35:55.777407 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:35:55.779710 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:35:55.780447 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:35:55.780961 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:35:55.781318 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:35:55.781649 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:35:55.782311 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:35:55.782721 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:35:55.783157 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:35:55.783570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:35:55.783985 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:35:55.789166 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.790036 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:35:55.790414 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.791066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.791567 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:35:55.792043 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:35:55.792509 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:35:55.793034 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:35:55.793509 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:35:55.797220 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m14:35:55.797746 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:35:55.803367 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:35:55.809908 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:35:55.813746 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:35:55.814453 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:35:55.815845 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:35:55.816439 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:35:55.817161 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:35:55.817742 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.821395 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:35:55.821992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.822628 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:35:55.823139 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.826345 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:35:55.829663 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:35:55.830159 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.830669 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:35:55.831227 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:35:55.847728 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.852105 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:35:55.854508 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:35:55.854958 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.855431 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:35:55.855877 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:35:55.858052 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:35:55.858502 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:35:55.858963 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:35:55.859495 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:35:55.860120 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:35:55.861185 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:35:55.861656 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:35:55.862077 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:35:55.866974 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:35:55.869439 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:35:55.871622 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:35:55.872096 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:35:55.872588 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:35:55.873030 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:35:55.875631 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:35:55.877050 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:35:55.773448 => 14:35:55.876895
[0m14:35:55.877541 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:35:55.878019 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:35:55.878479 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:35:55.879707 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:35:55.715201 => 14:35:55.879565
[0m14:35:55.881046 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:35:55.732874 => 14:35:55.880899
[0m14:35:55.881835 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2e8a7e90>]}
[0m14:35:55.882332 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:35:55.882897 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:35:55.883549 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.18s]
[0m14:35:55.884344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2d733990>]}
[0m14:35:55.885100 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2d7168d0>]}
[0m14:35:55.885728 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:35:55.886383 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m14:35:55.887073 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.19s]
[0m14:35:55.887750 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:35:55.888455 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:35:55.889142 [debug] [Thread-1  ]: Began running node model.finbest.int_daily_transactions
[0m14:35:55.889814 [info ] [Thread-1  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:35:55.890467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.int_daily_transactions)
[0m14:35:55.890870 [debug] [Thread-1  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:35:55.893570 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:35:55.894295 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:35:55.891179 => 14:35:55.894068
[0m14:35:55.894705 [debug] [Thread-1  ]: Began executing node model.finbest.int_daily_transactions
[0m14:35:55.930865 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:35:55.931637 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:35:55.932103 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:35:55.932517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:35:55.937391 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.937927 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:35:55.938368 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:35:55.946093 [debug] [Thread-1  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:35:55.949967 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:35:55.950693 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:35:55.951734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.954650 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:35:55.955114 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:35:55.955683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.957842 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:35:55.958298 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:35:55.958820 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:35:55.960166 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:35:55.963131 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:35:55.963569 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:35:55.965234 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:35:55.966550 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:35:55.895008 => 14:35:55.966387
[0m14:35:55.966987 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: Close
[0m14:35:55.967706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2d752390>]}
[0m14:35:55.968328 [info ] [Thread-1  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.08s]
[0m14:35:55.968903 [debug] [Thread-1  ]: Finished running node model.finbest.int_daily_transactions
[0m14:35:55.969698 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m14:35:55.970218 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:35:55.970842 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m14:35:55.971281 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m14:35:55.973895 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:35:55.974592 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 14:35:55.971590 => 14:35:55.974406
[0m14:35:55.975011 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m14:35:55.979116 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:35:55.979760 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:35:55.980256 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:35:55.980638 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:35:55.985171 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:35:55.985649 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:35:55.986068 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:35:55.991528 [debug] [Thread-3  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:35:55.994633 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:35:55.995099 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:35:55.995821 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:55.998504 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:35:55.998920 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:35:55.999522 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:35:56.001681 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:35:56.002127 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:35:56.002558 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:35:56.005621 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:35:56.008052 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:35:56.008474 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:35:56.010688 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:35:56.012191 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 14:35:55.975347 => 14:35:56.012038
[0m14:35:56.012603 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m14:35:56.013333 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e480c6f4-017a-42fe-a759-c9daf63f9659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2d7a75d0>]}
[0m14:35:56.013966 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m14:35:56.014556 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m14:35:56.031566 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:56.032255 [debug] [MainThread]: On master: BEGIN
[0m14:35:56.032786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:56.038679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:35:56.039225 [debug] [MainThread]: On master: COMMIT
[0m14:35:56.039650 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:56.040046 [debug] [MainThread]: On master: COMMIT
[0m14:35:56.040502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:35:56.040916 [debug] [MainThread]: On master: Close
[0m14:35:56.041595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:56.041953 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:35:56.042284 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:35:56.042599 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:35:56.042975 [info ] [MainThread]: 
[0m14:35:56.043346 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:35:56.044443 [debug] [MainThread]: Command end result
[0m14:35:56.049528 [info ] [MainThread]: 
[0m14:35:56.050002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:56.050386 [info ] [MainThread]: 
[0m14:35:56.050750 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:35:56.051287 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:56.051201 after 0.59 seconds
[0m14:35:56.051691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a304d1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2fce9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758a2fce9ed0>]}
[0m14:35:56.052100 [debug] [MainThread]: Flushing usage events
[0m14:42:58.249014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e81fbf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e81fbf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e81fbf9d0>]}


============================== 14:42:58.254061 | 02916c01-4fbc-40f4-b8a5-17072e04b4cd ==============================
[0m14:42:58.254061 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:42:58.254632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:42:58.306930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e81feb610>]}
[0m14:42:58.328003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e81feb590>]}
[0m14:42:58.329117 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:42:58.341048 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:42:58.371432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:58.371936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:58.377812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7f514810>]}
[0m14:42:58.382853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7dc4cd90>]}
[0m14:42:58.383399 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:42:58.383812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7dc4cc50>]}
[0m14:42:58.385398 [info ] [MainThread]: 
[0m14:42:58.386246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:58.387959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:42:58.398922 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:42:58.399486 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:42:58.399892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:58.405905 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:42:58.407345 [debug] [ThreadPool]: On list_finbest: Close
[0m14:42:58.409188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m14:42:58.415558 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:42:58.416199 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:42:58.416607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:58.422024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.422647 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:42:58.423045 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:42:58.425621 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:42:58.427297 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:42:58.428007 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:42:58.433483 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:58.433932 [debug] [MainThread]: On master: BEGIN
[0m14:42:58.434302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:58.438983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.439577 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:58.439996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:58.444579 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:42:58.445785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7dc56690>]}
[0m14:42:58.446328 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:58.446797 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:58.447175 [debug] [MainThread]: On master: BEGIN
[0m14:42:58.447633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.447990 [debug] [MainThread]: On master: COMMIT
[0m14:42:58.448335 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:58.448662 [debug] [MainThread]: On master: COMMIT
[0m14:42:58.449033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.449394 [debug] [MainThread]: On master: Close
[0m14:42:58.450048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:58.450430 [info ] [MainThread]: 
[0m14:42:58.455058 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:42:58.455505 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:42:58.456382 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:42:58.457008 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:42:58.457887 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:42:58.458730 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:42:58.459707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:42:58.460630 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m14:42:58.461526 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:42:58.462110 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:42:58.462560 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:42:58.463024 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:42:58.469429 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:42:58.471736 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:42:58.473689 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:42:58.474661 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:42:58.472166 => 14:42:58.474434
[0m14:42:58.475208 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:42:58.475799 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:42:58.463408 => 14:42:58.475572
[0m14:42:58.476406 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:42:58.469802 => 14:42:58.476202
[0m14:42:58.488131 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:42:58.493969 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:42:58.529488 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:42:58.534310 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:42:58.538442 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:42:58.539481 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:42:58.540074 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:42:58.540564 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:42:58.541198 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:42:58.541863 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:42:58.542559 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:42:58.543229 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:42:58.543918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:42:58.544422 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:42:58.546770 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.547333 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:42:58.547778 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:42:58.548984 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.549556 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:42:58.549902 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.550583 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:42:58.551068 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:42:58.551697 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:42:58.553197 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:42:58.559276 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m14:42:58.561870 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:42:58.562294 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:42:58.565635 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:42:58.566301 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:42:58.569798 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:42:58.570299 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:42:58.570822 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:42:58.571321 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.574654 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:42:58.575336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.575858 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.576522 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:42:58.580190 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:42:58.583281 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:42:58.583857 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:42:58.584368 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.584838 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:42:58.595882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.596561 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.608999 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:42:58.611964 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:42:58.614590 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:42:58.615079 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:42:58.615613 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:42:58.616094 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:42:58.616543 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:42:58.617047 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:42:58.617532 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:42:58.619180 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.619648 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.625540 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:42:58.626343 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.629466 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:42:58.630141 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:42:58.632714 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:42:58.633212 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:42:58.633796 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:42:58.635795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:58.636369 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:58.637718 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:42:58.504766 => 14:42:58.637546
[0m14:42:58.638114 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:58.639807 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:42:58.520083 => 14:42:58.639619
[0m14:42:58.640498 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:42:58.642197 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:42:58.476781 => 14:42:58.642017
[0m14:42:58.642795 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:42:58.643666 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:42:58.644402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7dc61150>]}
[0m14:42:58.646234 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7dc61490>]}
[0m14:42:58.647363 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7db4da90>]}
[0m14:42:58.648074 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m14:42:58.648732 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.19s]
[0m14:42:58.649410 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.19s]
[0m14:42:58.650030 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:42:58.650615 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:42:58.651226 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:42:58.652190 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:42:58.652724 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:42:58.653435 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:42:58.653840 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:42:58.657013 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:42:58.657778 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:42:58.654148 => 14:42:58.657575
[0m14:42:58.658238 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:42:58.664525 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:42:58.665344 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:42:58.665807 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:42:58.666253 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:42:58.670849 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.671381 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:42:58.671809 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:42:58.676028 [debug] [Thread-4  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:42:58.719351 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:42:58.719861 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:42:58.721132 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.724493 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:42:58.725150 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:42:58.726110 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.728492 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:42:58.729199 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:42:58.729810 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:42:58.731086 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.733593 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:42:58.734023 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:42:58.736096 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:58.737551 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:42:58.658552 => 14:42:58.737402
[0m14:42:58.737980 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:42:58.738743 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7c9cbdd0>]}
[0m14:42:58.739369 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.09s]
[0m14:42:58.740123 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:42:58.741078 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m14:42:58.741901 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:42:58.742742 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m14:42:58.743186 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m14:42:58.745865 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:42:58.746645 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 14:42:58.743502 => 14:42:58.746440
[0m14:42:58.747078 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m14:42:58.751366 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:42:58.752043 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:42:58.752477 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:42:58.752842 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:42:58.757971 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.758843 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:42:58.759322 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:42:58.763833 [debug] [Thread-2  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:42:58.767039 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:42:58.767542 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:42:58.768487 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.771153 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:42:58.771587 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:42:58.772296 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:42:58.774607 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:42:58.775164 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:42:58.775674 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:42:58.776971 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.779588 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:42:58.780138 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:42:58.782238 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:42:58.783713 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 14:42:58.747465 => 14:42:58.783549
[0m14:42:58.784165 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m14:42:58.784899 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02916c01-4fbc-40f4-b8a5-17072e04b4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7dc13950>]}
[0m14:42:58.785532 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m14:42:58.786135 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m14:42:58.869814 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:58.871022 [debug] [MainThread]: On master: BEGIN
[0m14:42:58.871400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:58.876731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:42:58.877444 [debug] [MainThread]: On master: COMMIT
[0m14:42:58.877838 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:58.878210 [debug] [MainThread]: On master: COMMIT
[0m14:42:58.878638 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:42:58.878999 [debug] [MainThread]: On master: Close
[0m14:42:58.879701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:58.880056 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:42:58.880383 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m14:42:58.880703 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m14:42:58.881014 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:42:58.881401 [info ] [MainThread]: 
[0m14:42:58.881747 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m14:42:58.883136 [debug] [MainThread]: Command end result
[0m14:42:58.888873 [info ] [MainThread]: 
[0m14:42:58.889743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:58.890214 [info ] [MainThread]: 
[0m14:42:58.890666 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:42:58.891275 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:58.891157 after 0.65 seconds
[0m14:42:58.891827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e8066d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7caa8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723e7caa8f10>]}
[0m14:42:58.892300 [debug] [MainThread]: Flushing usage events
[0m14:49:01.759725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a910>]}


============================== 14:49:01.766124 | ecefbbd9-af14-4df0-8f42-47f7a656beb8 ==============================
[0m14:49:01.766124 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:49:01.766654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:49:01.821688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf5a610>]}
[0m14:49:01.836389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf45750>]}
[0m14:49:01.837347 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:49:01.847902 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:49:01.875021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:01.875508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:01.881037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98a51cf10>]}
[0m14:49:01.885734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d987bb4b50>]}
[0m14:49:01.886300 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:49:01.886647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a1d0>]}
[0m14:49:01.887965 [info ] [MainThread]: 
[0m14:49:01.888648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:01.889945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:49:01.899899 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:49:01.900365 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:49:01.900722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:01.906648 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:49:01.908036 [debug] [ThreadPool]: On list_finbest: Close
[0m14:49:01.909881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m14:49:01.915738 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:49:01.916261 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:49:01.916688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:01.922195 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:49:01.922736 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:49:01.923216 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:49:01.925374 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:49:01.926703 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:49:01.927206 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:49:01.933027 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:01.933574 [debug] [MainThread]: On master: BEGIN
[0m14:49:01.933976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:01.939457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:01.940032 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:01.940581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:01.945210 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:01.946378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d987b74090>]}
[0m14:49:01.946908 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:01.947456 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:01.947879 [debug] [MainThread]: On master: BEGIN
[0m14:49:01.948463 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:01.948921 [debug] [MainThread]: On master: COMMIT
[0m14:49:01.949350 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:01.949757 [debug] [MainThread]: On master: COMMIT
[0m14:49:01.950235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:49:01.950658 [debug] [MainThread]: On master: Close
[0m14:49:01.951395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:01.951754 [info ] [MainThread]: 
[0m14:49:01.956676 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:49:01.957277 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:49:01.958005 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:49:01.958635 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:49:01.959247 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:49:01.959805 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:49:01.960526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:49:01.961242 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m14:49:01.962005 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:49:01.962466 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:49:01.962988 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:49:01.963457 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:49:01.969803 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:49:01.972019 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:49:01.973744 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:49:01.974616 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:49:01.963839 => 14:49:01.974405
[0m14:49:01.975179 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:49:01.970233 => 14:49:01.974978
[0m14:49:01.975642 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:49:01.976169 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:49:01.987672 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:49:01.972479 => 14:49:01.987403
[0m14:49:02.033051 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:49:02.033632 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:49:02.034419 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:49:02.038681 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:49:02.039435 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:49:02.039886 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:49:02.040297 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:49:02.040734 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:49:02.041381 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:49:02.041923 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:49:02.042407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:49:02.042898 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:49:02.043769 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:49:02.046227 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:49:02.046772 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:49:02.047210 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:49:02.048233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:49:02.048849 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:49:02.049230 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:49:02.049888 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:49:02.050395 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:49:02.050904 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m14:49:02.051431 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:49:02.058243 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:49:02.058745 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:49:02.059536 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:49:02.062948 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:49:02.063584 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:49:02.064130 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:49:02.064565 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.068287 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:49:02.071571 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:49:02.072127 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.072678 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:49:02.073214 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:49:02.076255 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:49:02.077020 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:49:02.077653 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.078513 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.079144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.081954 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:49:02.112386 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:49:02.115692 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:49:02.116245 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:49:02.116743 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:49:02.117378 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:49:02.118019 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:49:02.118524 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.119052 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:49:02.121677 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:49:02.122255 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:49:02.122897 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:49:02.128162 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:49:02.128763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:49:02.129319 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:49:02.129796 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:49:02.132385 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:49:02.133096 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:49:02.133631 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:49:02.136743 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:49:02.137399 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:02.137966 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:02.138512 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:49:02.140017 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:49:01.998163 => 14:49:02.139839
[0m14:49:02.141572 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:49:01.976538 => 14:49:02.141387
[0m14:49:02.142220 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:49:02.142982 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:49:02.143925 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98690fd90>]}
[0m14:49:02.144678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9872834d0>]}
[0m14:49:02.145180 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:02.146182 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.18s]
[0m14:49:02.146745 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m14:49:02.148523 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:49:02.034966 => 14:49:02.148355
[0m14:49:02.149209 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:49:02.149821 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:49:02.150312 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:49:02.151322 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d986a56c50>]}
[0m14:49:02.151952 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.19s]
[0m14:49:02.152586 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:49:02.153235 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:49:02.153765 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:49:02.154516 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:49:02.154966 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:49:02.157748 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:49:02.158534 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:49:02.155304 => 14:49:02.158284
[0m14:49:02.158985 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:49:02.163090 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:49:02.163764 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:49:02.164203 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:49:02.164583 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:49:02.169535 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:49:02.170035 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:49:02.171644 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:49:02.176296 [debug] [Thread-4  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:49:02.210402 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:49:02.210973 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:49:02.211781 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.214526 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:49:02.214952 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:49:02.215824 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.217872 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:49:02.218288 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:49:02.218676 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:49:02.220035 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:49:02.222405 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:49:02.222799 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:49:02.224684 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:02.226008 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:49:02.159315 => 14:49:02.225858
[0m14:49:02.226448 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:49:02.227182 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d986921750>]}
[0m14:49:02.227833 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.07s]
[0m14:49:02.228462 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:49:02.229220 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m14:49:02.229751 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:49:02.230383 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m14:49:02.230793 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m14:49:02.233440 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:49:02.234147 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 14:49:02.231108 => 14:49:02.233946
[0m14:49:02.234596 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m14:49:02.238658 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:49:02.239294 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:49:02.239716 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:49:02.240107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:49:02.244701 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:49:02.245223 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:49:02.245650 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:49:02.250957 [debug] [Thread-1  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:49:02.254068 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:49:02.254552 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:49:02.255244 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.258064 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:49:02.258500 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:49:02.259100 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:02.261214 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:49:02.261614 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:49:02.261993 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:49:02.263263 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:49:02.265654 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:49:02.266092 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:49:02.268188 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:49:02.269529 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 14:49:02.234906 => 14:49:02.269377
[0m14:49:02.269950 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m14:49:02.270685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecefbbd9-af14-4df0-8f42-47f7a656beb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9869533d0>]}
[0m14:49:02.271305 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m14:49:02.271949 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m14:49:02.367365 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:02.368208 [debug] [MainThread]: On master: BEGIN
[0m14:49:02.368853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:02.374699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:02.375493 [debug] [MainThread]: On master: COMMIT
[0m14:49:02.376131 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:02.376772 [debug] [MainThread]: On master: COMMIT
[0m14:49:02.377462 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:49:02.378120 [debug] [MainThread]: On master: Close
[0m14:49:02.379205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:02.379818 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:49:02.380415 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:49:02.380997 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m14:49:02.381582 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:49:02.382256 [info ] [MainThread]: 
[0m14:49:02.382881 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m14:49:02.384706 [debug] [MainThread]: Command end result
[0m14:49:02.392865 [info ] [MainThread]: 
[0m14:49:02.393622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:02.394216 [info ] [MainThread]: 
[0m14:49:02.394820 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:49:02.395718 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:02.395587 after 0.64 seconds
[0m14:49:02.396417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d98bf2a4d0>]}
[0m14:49:02.397110 [debug] [MainThread]: Flushing usage events
[0m14:55:30.492552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522c0c3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522c0c3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522c0c3990>]}


============================== 14:55:30.497356 | 5cb11245-7817-4b6d-a43d-1e96a89e12e7 ==============================
[0m14:55:30.497356 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:55:30.497859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:55:30.557715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72522c0f56d0>]}
[0m14:55:30.573571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725229681f10>]}
[0m14:55:30.574923 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:55:30.585956 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:55:30.603250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:30.603727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:30.609833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725227c42750>]}
[0m14:55:30.614796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725227d50f90>]}
[0m14:55:30.615370 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:55:30.615741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725227d50b10>]}
[0m14:55:30.617124 [info ] [MainThread]: 
[0m14:55:30.617823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:30.619075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:55:30.629738 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:55:30.630311 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:55:30.630701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:30.636450 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:55:30.637816 [debug] [ThreadPool]: On list_finbest: Close
[0m14:55:30.639588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m14:55:30.645569 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:55:30.646019 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:55:30.646385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:30.650876 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.651380 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:55:30.651779 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:55:30.653832 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:55:30.655170 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:55:30.655714 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:55:30.661495 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:30.662041 [debug] [MainThread]: On master: BEGIN
[0m14:55:30.662476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:30.668571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.669254 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:30.669881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:30.677096 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:55:30.679050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725227d65990>]}
[0m14:55:30.679871 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:30.680608 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:30.681201 [debug] [MainThread]: On master: BEGIN
[0m14:55:30.681902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.682514 [debug] [MainThread]: On master: COMMIT
[0m14:55:30.682877 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:30.683212 [debug] [MainThread]: On master: COMMIT
[0m14:55:30.683591 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:55:30.683936 [debug] [MainThread]: On master: Close
[0m14:55:30.684594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:30.684970 [info ] [MainThread]: 
[0m14:55:30.689780 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:55:30.690367 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:55:30.691199 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:55:30.691760 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:55:30.692329 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:55:30.693052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:55:30.693616 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:55:30.694323 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m14:55:30.694802 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:55:30.695560 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:55:30.696053 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:55:30.702676 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:55:30.703171 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:55:30.705281 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:55:30.707227 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:55:30.708069 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:55:30.696414 => 14:55:30.707855
[0m14:55:30.708586 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:55:30.714283 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:55:30.703500 => 14:55:30.714045
[0m14:55:30.721068 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:55:30.737535 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:55:30.705772 => 14:55:30.737277
[0m14:55:30.753936 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:55:30.779023 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:55:30.781149 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:55:30.784026 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:55:30.784810 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:55:30.785456 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:55:30.785938 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:55:30.786294 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:55:30.786940 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:55:30.787385 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:55:30.787865 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:55:30.788335 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:55:30.788959 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:55:30.793778 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.794409 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.794990 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:55:30.795433 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.795880 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:55:30.796414 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:55:30.796872 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:55:30.797330 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:55:30.797905 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:55:30.805980 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:55:30.813916 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m14:55:30.814589 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:55:30.818105 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:55:30.819025 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:55:30.823805 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:55:30.824459 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:55:30.824998 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:55:30.825563 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:55:30.826705 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.827206 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.827663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.830854 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:55:30.833962 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:55:30.837002 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:55:30.837526 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:55:30.838019 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:55:30.838528 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:55:30.842510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.843151 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.848965 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.877613 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:55:30.874305 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:55:30.880304 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:55:30.881192 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:55:30.881756 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:55:30.882293 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:55:30.882796 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:55:30.883286 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:55:30.883733 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:55:30.889399 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:55:30.890023 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:55:30.890514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:55:30.895879 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:55:30.898829 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:55:30.901890 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:55:30.902595 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:55:30.903214 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:55:30.903825 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:55:30.907650 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:30.909762 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:55:30.721461 => 14:55:30.909480
[0m14:55:30.910394 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:30.910863 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:30.911503 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:55:30.912946 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:55:30.708950 => 14:55:30.912782
[0m14:55:30.914346 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:55:30.759500 => 14:55:30.914187
[0m14:55:30.915564 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725227404090>]}
[0m14:55:30.916096 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:55:30.916592 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:55:30.917406 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.22s]
[0m14:55:30.918268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725227c53250>]}
[0m14:55:30.919212 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:55:30.920007 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725226bc6890>]}
[0m14:55:30.920740 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.23s]
[0m14:55:30.921576 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m14:55:30.922200 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:55:30.922838 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:55:30.923952 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:55:30.924678 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:55:30.925647 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:55:30.926213 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:55:30.929672 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:55:30.930475 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:55:30.926582 => 14:55:30.930243
[0m14:55:30.930961 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:55:30.936324 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:55:30.936992 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:55:30.937451 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:55:30.937851 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:55:30.943153 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:55:30.943861 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:55:30.944329 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:55:30.952482 [debug] [Thread-4  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:55:30.993948 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:55:30.994556 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:55:30.995281 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:30.998175 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:55:30.998655 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:55:30.999205 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.001451 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:55:31.001912 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:55:31.002331 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:55:31.005744 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.009365 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:55:31.009938 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:55:31.012589 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:31.014116 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:55:30.931288 => 14:55:31.013940
[0m14:55:31.014602 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:55:31.015448 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725226abe1d0>]}
[0m14:55:31.016138 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.09s]
[0m14:55:31.016765 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:55:31.017427 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m14:55:31.017949 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:55:31.018586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m14:55:31.019000 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m14:55:31.022891 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:55:31.023985 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 14:55:31.019325 => 14:55:31.023731
[0m14:55:31.024578 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m14:55:31.029043 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:55:31.029749 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:55:31.030225 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:55:31.030617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:55:31.035524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.036075 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:55:31.036516 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:55:31.042738 [debug] [Thread-1  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:55:31.046020 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:55:31.046504 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:55:31.047332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.050277 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:55:31.050750 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:55:31.051520 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:55:31.053744 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:55:31.054396 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:55:31.054910 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:55:31.056655 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.059448 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:55:31.059906 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:55:31.061931 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:55:31.063316 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 14:55:31.024951 => 14:55:31.063152
[0m14:55:31.063751 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m14:55:31.064557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb11245-7817-4b6d-a43d-1e96a89e12e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725226af0d10>]}
[0m14:55:31.065197 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.05s]
[0m14:55:31.065786 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m14:55:31.099452 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.099973 [debug] [MainThread]: On master: BEGIN
[0m14:55:31.100375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:31.105607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:55:31.106327 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.106926 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:31.107361 [debug] [MainThread]: On master: COMMIT
[0m14:55:31.107982 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:55:31.108378 [debug] [MainThread]: On master: Close
[0m14:55:31.109076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:31.109467 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m14:55:31.109794 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:55:31.110117 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m14:55:31.110449 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:55:31.110832 [info ] [MainThread]: 
[0m14:55:31.111240 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m14:55:31.112387 [debug] [MainThread]: Command end result
[0m14:55:31.117500 [info ] [MainThread]: 
[0m14:55:31.117972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:31.118337 [info ] [MainThread]: 
[0m14:55:31.118699 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:55:31.119239 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:31.119153 after 0.63 seconds
[0m14:55:31.119775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7252298c4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725229646ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725226afc390>]}
[0m14:55:31.120332 [debug] [MainThread]: Flushing usage events
[0m14:57:18.124709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d355551150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3555510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d355551910>]}


============================== 14:57:18.131365 | b5fb7159-1783-400f-bae9-b2f99a6b547e ==============================
[0m14:57:18.131365 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:57:18.131888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:18.190445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d355583590>]}
[0m14:57:18.207388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d352afdcd0>]}
[0m14:57:18.208424 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:57:18.221089 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:57:18.254020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:18.254555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:18.261037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d351196fd0>]}
[0m14:57:18.267003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3511de650>]}
[0m14:57:18.267641 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:57:18.268039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3511de3d0>]}
[0m14:57:18.269466 [info ] [MainThread]: 
[0m14:57:18.270203 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:57:18.271544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m14:57:18.283753 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m14:57:18.284356 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m14:57:18.284804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:18.290517 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:57:18.292073 [debug] [ThreadPool]: On list_finbest: Close
[0m14:57:18.293733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m14:57:18.300920 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:57:18.301535 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m14:57:18.302027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:18.307359 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.307867 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m14:57:18.308260 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m14:57:18.310154 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:57:18.311753 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m14:57:18.312946 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m14:57:18.320003 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:18.320522 [debug] [MainThread]: On master: BEGIN
[0m14:57:18.320880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:18.325777 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.326341 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:18.326903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:57:18.332176 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:57:18.334244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3508a92d0>]}
[0m14:57:18.335267 [debug] [MainThread]: On master: ROLLBACK
[0m14:57:18.335894 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:18.336320 [debug] [MainThread]: On master: BEGIN
[0m14:57:18.336916 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.337304 [debug] [MainThread]: On master: COMMIT
[0m14:57:18.337660 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:18.338021 [debug] [MainThread]: On master: COMMIT
[0m14:57:18.338466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.338837 [debug] [MainThread]: On master: Close
[0m14:57:18.339525 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:18.339907 [info ] [MainThread]: 
[0m14:57:18.344893 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m14:57:18.345897 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m14:57:18.346517 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m14:57:18.347037 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m14:57:18.347748 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m14:57:18.348652 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m14:57:18.349876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m14:57:18.350890 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m14:57:18.351956 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m14:57:18.352581 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m14:57:18.353132 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m14:57:18.353675 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m14:57:18.360564 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m14:57:18.363549 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m14:57:18.365410 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m14:57:18.366551 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 14:57:18.364016 => 14:57:18.366303
[0m14:57:18.367049 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 14:57:18.354054 => 14:57:18.366805
[0m14:57:18.367559 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 14:57:18.361028 => 14:57:18.367339
[0m14:57:18.368366 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m14:57:18.369195 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m14:57:18.369675 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m14:57:18.453466 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m14:57:18.456127 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m14:57:18.456927 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m14:57:18.457782 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:57:18.458318 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:57:18.458925 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:57:18.459332 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m14:57:18.460045 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m14:57:18.460579 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m14:57:18.461368 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:57:18.461881 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:57:18.462376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:18.467520 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.468179 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.468769 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:57:18.469402 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:57:18.469940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.470446 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m14:57:18.471061 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m14:57:18.471620 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:57:18.472223 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m14:57:18.478276 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m14:57:18.485605 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m14:57:18.486435 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:57:18.491293 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:57:18.491887 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m14:57:18.492403 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m14:57:18.492977 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m14:57:18.496646 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:57:18.497406 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m14:57:18.497886 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.501135 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:57:18.501655 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.502185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.502620 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m14:57:18.506035 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:57:18.509581 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:57:18.510265 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m14:57:18.510736 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.511401 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m14:57:18.517390 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.528662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.536785 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:57:18.539166 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:57:18.541312 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:57:18.541891 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:57:18.542689 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:57:18.543240 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:57:18.543811 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m14:57:18.544460 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m14:57:18.545013 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m14:57:18.546461 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.547100 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.552990 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.553743 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m14:57:18.556412 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m14:57:18.558805 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m14:57:18.559324 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m14:57:18.559850 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m14:57:18.560402 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m14:57:18.564607 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:18.565215 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:18.565621 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:18.567365 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 14:57:18.385397 => 14:57:18.567198
[0m14:57:18.569034 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 14:57:18.416821 => 14:57:18.568869
[0m14:57:18.570380 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 14:57:18.370039 => 14:57:18.570220
[0m14:57:18.570877 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m14:57:18.571359 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m14:57:18.571861 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m14:57:18.572704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d35079d750>]}
[0m14:57:18.573517 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d350708b90>]}
[0m14:57:18.574326 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3511aabd0>]}
[0m14:57:18.575007 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m14:57:18.575726 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.22s]
[0m14:57:18.576376 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m14:57:18.576988 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m14:57:18.577683 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m14:57:18.578361 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m14:57:18.579322 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m14:57:18.580036 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m14:57:18.581101 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m14:57:18.581705 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m14:57:18.584887 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m14:57:18.585680 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 14:57:18.582044 => 14:57:18.585461
[0m14:57:18.586141 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m14:57:18.591360 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m14:57:18.592099 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:57:18.592566 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m14:57:18.592964 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:57:18.598408 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.599155 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:57:18.599705 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m14:57:18.607269 [debug] [Thread-4  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:57:18.644809 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:57:18.645402 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m14:57:18.646114 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.649106 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:57:18.649621 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m14:57:18.650471 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.652611 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:57:18.653007 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:57:18.653378 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m14:57:18.654753 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.657357 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m14:57:18.657790 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m14:57:18.660074 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:18.661443 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 14:57:18.586467 => 14:57:18.661287
[0m14:57:18.661967 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m14:57:18.662884 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3507a3990>]}
[0m14:57:18.663574 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.08s]
[0m14:57:18.664188 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m14:57:18.664865 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m14:57:18.665398 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m14:57:18.666046 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m14:57:18.666465 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m14:57:18.669172 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m14:57:18.669944 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 14:57:18.666769 => 14:57:18.669735
[0m14:57:18.670398 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m14:57:18.674513 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m14:57:18.675159 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:57:18.675613 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m14:57:18.675998 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:57:18.680670 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.681251 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:57:18.681697 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m14:57:18.687875 [debug] [Thread-2  ]: SQL status: SELECT 487 in 0.0 seconds
[0m14:57:18.691207 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:57:18.691703 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m14:57:18.692446 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.695241 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:57:18.695688 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m14:57:18.696427 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:57:18.698834 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:57:18.699316 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:57:18.699719 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m14:57:18.700891 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.703383 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m14:57:18.703801 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m14:57:18.705752 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:57:18.707209 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 14:57:18.670713 => 14:57:18.707031
[0m14:57:18.707774 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m14:57:18.708598 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5fb7159-1783-400f-bae9-b2f99a6b547e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d3507b7250>]}
[0m14:57:18.709245 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m14:57:18.709839 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m14:57:18.756393 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:18.757545 [debug] [MainThread]: On master: BEGIN
[0m14:57:18.758452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:18.769531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:18.770757 [debug] [MainThread]: On master: COMMIT
[0m14:57:18.771279 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:18.771658 [debug] [MainThread]: On master: COMMIT
[0m14:57:18.772157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:57:18.772531 [debug] [MainThread]: On master: Close
[0m14:57:18.773182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:18.773544 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m14:57:18.773874 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m14:57:18.774198 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m14:57:18.774512 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m14:57:18.774896 [info ] [MainThread]: 
[0m14:57:18.775273 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m14:57:18.776388 [debug] [MainThread]: Command end result
[0m14:57:18.781587 [info ] [MainThread]: 
[0m14:57:18.782235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:18.782614 [info ] [MainThread]: 
[0m14:57:18.782978 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:57:18.783695 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:18.783600 after 0.67 seconds
[0m14:57:18.784111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d352fc10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d352fc1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d35079f250>]}
[0m14:57:18.784522 [debug] [MainThread]: Flushing usage events
[0m15:00:27.599634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e702e42d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e702e4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e702e4a10>]}


============================== 15:00:27.606308 | 80c2cc77-e144-40fc-85de-be3f30bcf14b ==============================
[0m15:00:27.606308 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:00:27.606865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'debug': 'True', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:00:27.665247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e70316710>]}
[0m15:00:27.681734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e705d9950>]}
[0m15:00:27.683054 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:00:27.695274 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:00:27.724286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:27.724794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:27.730938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6bf31f90>]}
[0m15:00:27.736214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6bf71610>]}
[0m15:00:27.736891 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:00:27.737296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6bf71810>]}
[0m15:00:27.738817 [info ] [MainThread]: 
[0m15:00:27.739594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:27.740835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m15:00:27.751747 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m15:00:27.752394 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m15:00:27.752812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:27.759727 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:00:27.761132 [debug] [ThreadPool]: On list_finbest: Close
[0m15:00:27.762960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m15:00:27.770334 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m15:00:27.770978 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m15:00:27.771491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:27.776344 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:00:27.776807 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m15:00:27.777181 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m15:00:27.779306 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:00:27.780623 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m15:00:27.781178 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m15:00:27.787351 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:27.787847 [debug] [MainThread]: On master: BEGIN
[0m15:00:27.788530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:27.793235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:00:27.793729 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:27.794147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:27.798079 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:00:27.799186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6be98a10>]}
[0m15:00:27.799757 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:27.800298 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:27.800706 [debug] [MainThread]: On master: BEGIN
[0m15:00:27.801294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:00:27.801729 [debug] [MainThread]: On master: COMMIT
[0m15:00:27.802090 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:27.802433 [debug] [MainThread]: On master: COMMIT
[0m15:00:27.802842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:00:27.803209 [debug] [MainThread]: On master: Close
[0m15:00:27.803877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:27.804260 [info ] [MainThread]: 
[0m15:00:27.809285 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m15:00:27.809892 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m15:00:27.810373 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m15:00:27.810917 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m15:00:27.811690 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m15:00:27.812955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m15:00:27.813728 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m15:00:27.814998 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m15:00:27.815851 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m15:00:27.816653 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m15:00:27.817200 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m15:00:27.824340 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m15:00:27.825055 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m15:00:27.827671 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m15:00:27.829679 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m15:00:27.830593 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 15:00:27.817845 => 15:00:27.830355
[0m15:00:27.831030 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 15:00:27.825477 => 15:00:27.830810
[0m15:00:27.831518 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 15:00:27.828227 => 15:00:27.831302
[0m15:00:27.832315 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m15:00:27.833013 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m15:00:27.833526 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m15:00:27.906050 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m15:00:27.909285 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m15:00:27.911409 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m15:00:27.912271 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:00:27.912771 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m15:00:27.913220 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:00:27.913703 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:00:27.914336 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:00:27.914793 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m15:00:27.915274 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m15:00:27.915787 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:27.916528 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:00:27.920179 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:00:27.921091 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:00:27.921800 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m15:00:27.922639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:00:27.923103 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:00:27.923620 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m15:00:27.924122 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:00:27.924675 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:00:27.925019 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m15:00:27.925751 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m15:00:27.931374 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m15:00:27.933291 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:00:27.938223 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:00:27.938838 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m15:00:27.939416 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m15:00:27.939884 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m15:00:27.943633 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:00:27.944230 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m15:00:27.944672 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:27.945138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:27.948161 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:00:27.948694 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:27.952835 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:00:27.953609 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m15:00:27.956685 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:00:27.957205 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m15:00:27.957778 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m15:00:27.958136 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:27.958794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:27.959234 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:27.993894 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m15:00:27.997265 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m15:00:27.997809 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:00:28.000799 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m15:00:28.001560 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:00:28.002311 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m15:00:28.003012 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:00:28.003596 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m15:00:28.004209 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m15:00:28.005472 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:00:28.011335 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:00:28.011705 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m15:00:28.011055 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:00:28.014522 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:00:28.017597 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:00:28.018631 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m15:00:28.019765 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m15:00:28.020561 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m15:00:28.023146 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:00:28.024776 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 15:00:27.869519 => 15:00:28.024603
[0m15:00:28.025257 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:00:28.025742 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:00:28.026206 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m15:00:28.027684 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 15:00:27.833865 => 15:00:28.027518
[0m15:00:28.029033 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 15:00:27.854255 => 15:00:28.028878
[0m15:00:28.029525 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m15:00:28.030486 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6b531310>]}
[0m15:00:28.031137 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m15:00:28.032018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6be74350>]}
[0m15:00:28.032744 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.21s]
[0m15:00:28.034145 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m15:00:28.035100 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m15:00:28.036415 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6be6f090>]}
[0m15:00:28.037518 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m15:00:28.038415 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.22s]
[0m15:00:28.039121 [debug] [Thread-1  ]: Began running node model.finbest.int_daily_transactions
[0m15:00:28.039824 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m15:00:28.040418 [info ] [Thread-1  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m15:00:28.041342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.int_daily_transactions)
[0m15:00:28.041794 [debug] [Thread-1  ]: Began compiling node model.finbest.int_daily_transactions
[0m15:00:28.044640 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m15:00:28.045466 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (compile): 15:00:28.042162 => 15:00:28.045207
[0m15:00:28.045926 [debug] [Thread-1  ]: Began executing node model.finbest.int_daily_transactions
[0m15:00:28.051770 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m15:00:28.052812 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:00:28.053391 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: BEGIN
[0m15:00:28.053826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:28.058371 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:00:28.058902 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:00:28.059370 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m15:00:28.064282 [debug] [Thread-1  ]: SQL status: SELECT 487 in 0.0 seconds
[0m15:00:28.099554 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:00:28.100171 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m15:00:28.101003 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:28.103687 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:00:28.104125 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m15:00:28.104848 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:28.106813 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m15:00:28.107249 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:00:28.107657 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: COMMIT
[0m15:00:28.109339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:00:28.111763 [debug] [Thread-1  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:00:28.112238 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m15:00:28.114494 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:00:28.115796 [debug] [Thread-1  ]: Timing info for model.finbest.int_daily_transactions (execute): 15:00:28.046259 => 15:00:28.115647
[0m15:00:28.116248 [debug] [Thread-1  ]: On model.finbest.int_daily_transactions: Close
[0m15:00:28.116996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6b4f4110>]}
[0m15:00:28.117684 [info ] [Thread-1  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.08s]
[0m15:00:28.118300 [debug] [Thread-1  ]: Finished running node model.finbest.int_daily_transactions
[0m15:00:28.119085 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m15:00:28.119657 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m15:00:28.120333 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m15:00:28.120765 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m15:00:28.123542 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m15:00:28.124255 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 15:00:28.121075 => 15:00:28.124051
[0m15:00:28.124689 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m15:00:28.128720 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m15:00:28.129394 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:00:28.129810 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m15:00:28.130223 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:00:28.134685 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:00:28.135215 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:00:28.135658 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m15:00:28.140452 [debug] [Thread-3  ]: SQL status: SELECT 487 in 0.0 seconds
[0m15:00:28.143824 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:00:28.144374 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m15:00:28.145023 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:28.147684 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:00:28.148092 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m15:00:28.148700 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:00:28.150845 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m15:00:28.151305 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:00:28.151708 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m15:00:28.152938 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m15:00:28.155308 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:00:28.155712 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m15:00:28.157701 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:00:28.159075 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 15:00:28.125012 => 15:00:28.158925
[0m15:00:28.159535 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m15:00:28.160279 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80c2cc77-e144-40fc-85de-be3f30bcf14b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6b540f90>]}
[0m15:00:28.160916 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m15:00:28.161516 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m15:00:28.214805 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:28.216090 [debug] [MainThread]: On master: BEGIN
[0m15:00:28.217189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:28.225262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:00:28.225774 [debug] [MainThread]: On master: COMMIT
[0m15:00:28.226184 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:28.226559 [debug] [MainThread]: On master: COMMIT
[0m15:00:28.227001 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:00:28.227769 [debug] [MainThread]: On master: Close
[0m15:00:28.229383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:28.230096 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m15:00:28.230492 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m15:00:28.230836 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m15:00:28.231332 [info ] [MainThread]: 
[0m15:00:28.232037 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:00:28.233513 [debug] [MainThread]: Command end result
[0m15:00:28.239060 [info ] [MainThread]: 
[0m15:00:28.239589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:28.239951 [info ] [MainThread]: 
[0m15:00:28.240349 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:00:28.240871 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:28.240790 after 0.65 seconds
[0m15:00:28.241295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6d836dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e6b531e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8e70316610>]}
[0m15:00:28.241707 [debug] [MainThread]: Flushing usage events
[0m15:06:48.873333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788b9db310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788b9db290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788b9db9d0>]}


============================== 15:06:48.880575 | 7df57894-a7f5-4403-a6b9-c49511fc263f ==============================
[0m15:06:48.880575 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:06:48.881228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:06:48.943926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788ba0d6d0>]}
[0m15:06:48.960819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788b9dbcd0>]}
[0m15:06:48.962052 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:06:48.973769 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:06:49.008777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:49.009278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:49.016242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78876c7450>]}
[0m15:06:49.021205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78876671d0>]}
[0m15:06:49.021754 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:06:49.022126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7887667e90>]}
[0m15:06:49.023506 [info ] [MainThread]: 
[0m15:06:49.024205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:49.025467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m15:06:49.036700 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m15:06:49.037241 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m15:06:49.037621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:49.043281 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:06:49.045245 [debug] [ThreadPool]: On list_finbest: Close
[0m15:06:49.047643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m15:06:49.053622 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m15:06:49.054108 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m15:06:49.054463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:49.058903 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.059355 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m15:06:49.059865 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m15:06:49.062796 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:06:49.064603 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m15:06:49.065169 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m15:06:49.071076 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.071606 [debug] [MainThread]: On master: BEGIN
[0m15:06:49.072006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:49.076647 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.077159 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.077624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:49.082049 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:49.083332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78876708d0>]}
[0m15:06:49.083921 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:49.084435 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.084827 [debug] [MainThread]: On master: BEGIN
[0m15:06:49.085292 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.085678 [debug] [MainThread]: On master: COMMIT
[0m15:06:49.086045 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.086418 [debug] [MainThread]: On master: COMMIT
[0m15:06:49.086809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.087190 [debug] [MainThread]: On master: Close
[0m15:06:49.087866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:49.088267 [info ] [MainThread]: 
[0m15:06:49.093102 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m15:06:49.093616 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m15:06:49.094434 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m15:06:49.095303 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m15:06:49.096321 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m15:06:49.097014 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m15:06:49.097941 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m15:06:49.098632 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m15:06:49.099457 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m15:06:49.100005 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m15:06:49.100435 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m15:06:49.100858 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m15:06:49.107377 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m15:06:49.109718 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m15:06:49.111591 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m15:06:49.112774 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 15:06:49.107762 => 15:06:49.112505
[0m15:06:49.113622 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 15:06:49.101285 => 15:06:49.113290
[0m15:06:49.114227 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m15:06:49.114835 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m15:06:49.127017 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 15:06:49.110193 => 15:06:49.126599
[0m15:06:49.143271 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m15:06:49.202588 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m15:06:49.205886 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m15:06:49.206712 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m15:06:49.207745 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:06:49.208306 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m15:06:49.208778 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:06:49.209389 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:06:49.209901 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m15:06:49.210467 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:06:49.211234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:06:49.211752 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m15:06:49.212409 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:06:49.214234 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.214843 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:06:49.215347 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m15:06:49.216483 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.216975 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:06:49.217447 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m15:06:49.217921 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.218658 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:06:49.219319 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m15:06:49.219826 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m15:06:49.225415 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m15:06:49.226919 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:06:49.230369 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:06:49.230887 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m15:06:49.231447 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m15:06:49.231923 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m15:06:49.236026 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:06:49.236644 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m15:06:49.237119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.237593 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.240855 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:06:49.241268 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.244212 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:06:49.244897 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m15:06:49.247763 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:06:49.248236 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m15:06:49.248739 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m15:06:49.249175 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.254960 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.260688 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.287531 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m15:06:49.288765 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m15:06:49.286414 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m15:06:49.289564 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:06:49.290057 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:06:49.290817 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:06:49.291258 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m15:06:49.291700 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m15:06:49.292279 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m15:06:49.293722 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.294330 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.294739 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.300063 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:06:49.302653 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:06:49.305543 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:06:49.306062 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m15:06:49.306547 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m15:06:49.307008 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m15:06:49.308968 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:49.310482 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 15:06:49.115221 => 15:06:49.310313
[0m15:06:49.310822 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:49.311529 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:49.312049 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m15:06:49.314479 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 15:06:49.127499 => 15:06:49.314285
[0m15:06:49.316247 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 15:06:49.149135 => 15:06:49.316053
[0m15:06:49.317002 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m15:06:49.317978 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7886d2fa50>]}
[0m15:06:49.318645 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m15:06:49.319788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788756ae90>]}
[0m15:06:49.320683 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.22s]
[0m15:06:49.321850 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m15:06:49.322832 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78863acc90>]}
[0m15:06:49.323577 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m15:06:49.324392 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m15:06:49.325065 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m15:06:49.325967 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m15:06:49.326648 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m15:06:49.327293 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m15:06:49.328155 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m15:06:49.328638 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m15:06:49.332297 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m15:06:49.333164 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 15:06:49.329235 => 15:06:49.332933
[0m15:06:49.333634 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m15:06:49.338947 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m15:06:49.339946 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:06:49.340728 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m15:06:49.341442 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:06:49.346359 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.346905 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:06:49.347337 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m15:06:49.352705 [debug] [Thread-4  ]: SQL status: SELECT 487 in 0.0 seconds
[0m15:06:49.388784 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:06:49.389356 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m15:06:49.390070 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.392886 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:06:49.393338 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m15:06:49.393875 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.396003 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m15:06:49.396473 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:06:49.396876 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m15:06:49.398316 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.400820 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:06:49.401273 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m15:06:49.403028 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:49.404540 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 15:06:49.333955 => 15:06:49.404374
[0m15:06:49.404992 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m15:06:49.405733 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78863a2750>]}
[0m15:06:49.406379 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.08s]
[0m15:06:49.406970 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m15:06:49.407613 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m15:06:49.408128 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m15:06:49.408753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m15:06:49.409173 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m15:06:49.411930 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m15:06:49.412667 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 15:06:49.409484 => 15:06:49.412463
[0m15:06:49.413349 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m15:06:49.417432 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m15:06:49.418050 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:06:49.418486 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m15:06:49.418871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:06:49.423455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.423964 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:06:49.424396 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m15:06:49.429017 [debug] [Thread-1  ]: SQL status: SELECT 487 in 0.0 seconds
[0m15:06:49.432599 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:06:49.433058 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m15:06:49.433706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.436478 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:06:49.436918 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m15:06:49.437462 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:49.439548 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m15:06:49.439977 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:06:49.440409 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m15:06:49.441478 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.443954 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:06:49.444388 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m15:06:49.446013 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:06:49.447556 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 15:06:49.413672 => 15:06:49.447374
[0m15:06:49.448055 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m15:06:49.448880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df57894-a7f5-4403-a6b9-c49511fc263f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78863a2890>]}
[0m15:06:49.449577 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m15:06:49.450256 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m15:06:49.504310 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.504812 [debug] [MainThread]: On master: BEGIN
[0m15:06:49.505189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:49.509766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:49.510260 [debug] [MainThread]: On master: COMMIT
[0m15:06:49.510622 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.510962 [debug] [MainThread]: On master: COMMIT
[0m15:06:49.511433 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:49.511814 [debug] [MainThread]: On master: Close
[0m15:06:49.512488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:49.512840 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m15:06:49.513165 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m15:06:49.513477 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m15:06:49.513790 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m15:06:49.514177 [info ] [MainThread]: 
[0m15:06:49.514529 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:06:49.515632 [debug] [MainThread]: Command end result
[0m15:06:49.520662 [info ] [MainThread]: 
[0m15:06:49.521141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:49.521583 [info ] [MainThread]: 
[0m15:06:49.521966 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:06:49.522604 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:49.522513 after 0.66 seconds
[0m15:06:49.523011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788944c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7887651c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788765c690>]}
[0m15:06:49.523444 [debug] [MainThread]: Flushing usage events
[0m15:29:59.521145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713141c1a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713141c1a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713141c1a950>]}


============================== 15:29:59.526720 | c18912aa-bfef-4ece-8ff0-6eba54a73c08 ==============================
[0m15:29:59.526720 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:29:59.527265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:29:59.584120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713141c4c050>]}
[0m15:29:59.598741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d8e4890>]}
[0m15:29:59.599611 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:29:59.610360 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:29:59.640601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:59.641075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:59.647045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d85dd50>]}
[0m15:29:59.651792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d8a71d0>]}
[0m15:29:59.652349 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:29:59.652699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d8a7250>]}
[0m15:29:59.654016 [info ] [MainThread]: 
[0m15:29:59.654739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:59.656043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m15:29:59.666243 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m15:29:59.666713 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m15:29:59.667071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:59.674652 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:29:59.676016 [debug] [ThreadPool]: On list_finbest: Close
[0m15:29:59.677806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m15:29:59.683923 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m15:29:59.684548 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m15:29:59.685002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:59.689581 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.690040 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m15:29:59.690424 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m15:29:59.694298 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:29:59.695541 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m15:29:59.696021 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m15:29:59.701374 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:59.701820 [debug] [MainThread]: On master: BEGIN
[0m15:29:59.702179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:59.706726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.707195 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:59.707602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:59.713968 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:29:59.715113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d8bc4d0>]}
[0m15:29:59.715607 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:59.716088 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:59.716446 [debug] [MainThread]: On master: BEGIN
[0m15:29:59.716891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.717267 [debug] [MainThread]: On master: COMMIT
[0m15:29:59.717600 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:59.717924 [debug] [MainThread]: On master: COMMIT
[0m15:29:59.718309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:29:59.718650 [debug] [MainThread]: On master: Close
[0m15:29:59.719335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:59.719727 [info ] [MainThread]: 
[0m15:29:59.724655 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m15:29:59.725211 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m15:29:59.725807 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m15:29:59.726324 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m15:29:59.726960 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m15:29:59.727724 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m15:29:59.728690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m15:29:59.729442 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m15:29:59.730483 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m15:29:59.731013 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m15:29:59.731479 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m15:29:59.731942 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m15:29:59.738357 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m15:29:59.740782 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m15:29:59.742644 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m15:29:59.743622 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 15:29:59.741250 => 15:29:59.743405
[0m15:29:59.744143 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 15:29:59.732299 => 15:29:59.743967
[0m15:29:59.744641 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 15:29:59.738749 => 15:29:59.744450
[0m15:29:59.745143 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m15:29:59.745592 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m15:29:59.746099 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m15:29:59.823542 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m15:29:59.826483 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m15:29:59.829047 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m15:29:59.829980 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:29:59.830351 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:29:59.830895 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m15:29:59.831364 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m15:29:59.831849 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:29:59.832199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:29:59.832671 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:29:59.833332 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m15:29:59.834202 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:29:59.838342 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.838972 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:29:59.839465 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.839990 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.840338 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m15:29:59.840998 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:29:59.841446 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:29:59.841957 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m15:29:59.842459 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m15:29:59.856952 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m15:29:59.857662 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m15:29:59.863476 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m15:29:59.865196 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:29:59.869064 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:29:59.872136 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:29:59.872694 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m15:29:59.873156 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m15:29:59.873661 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m15:29:59.874828 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:29:59.875341 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:29:59.878659 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:29:59.879157 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:29:59.882233 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:29:59.882758 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m15:29:59.885710 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:29:59.886191 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m15:29:59.886757 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m15:29:59.887274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:29:59.893362 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:29:59.898998 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:29:59.910986 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m15:29:59.913570 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m15:29:59.916060 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m15:29:59.916670 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:29:59.917269 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:29:59.917925 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:29:59.918481 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m15:29:59.918981 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m15:29:59.919427 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m15:29:59.921119 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:29:59.921646 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m15:29:59.926897 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m15:29:59.927566 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m15:29:59.930431 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m15:29:59.930922 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m15:29:59.933439 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m15:29:59.934061 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m15:29:59.934906 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m15:29:59.937404 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:29:59.939135 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 15:29:59.766966 => 15:29:59.938957
[0m15:29:59.939484 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:29:59.940055 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:29:59.940571 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m15:29:59.942242 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 15:29:59.756735 => 15:29:59.942059
[0m15:29:59.943734 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 15:29:59.746494 => 15:29:59.943566
[0m15:29:59.944284 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m15:29:59.945039 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d7cee90>]}
[0m15:29:59.945543 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m15:29:59.946328 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.22s]
[0m15:29:59.947161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313c70fc90>]}
[0m15:29:59.947857 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m15:29:59.948591 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313d7cedd0>]}
[0m15:29:59.949376 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.22s]
[0m15:29:59.950193 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.22s]
[0m15:29:59.950978 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m15:29:59.951606 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m15:29:59.952414 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m15:29:59.952990 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m15:29:59.953728 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m15:29:59.954159 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m15:29:59.956958 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m15:29:59.957685 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 15:29:59.954469 => 15:29:59.957487
[0m15:29:59.958128 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m15:29:59.963529 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m15:29:59.964304 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:29:59.964778 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m15:29:59.965166 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:29:59.969647 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m15:29:59.970140 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:29:59.970549 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m15:29:59.976721 [debug] [Thread-4  ]: SQL status: SELECT 487 in 0.0 seconds
[0m15:30:00.012875 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:30:00.013525 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m15:30:00.014221 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:00.016911 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:30:00.017349 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m15:30:00.018042 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:00.020163 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m15:30:00.020590 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:30:00.020977 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m15:30:00.022811 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m15:30:00.025221 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m15:30:00.025660 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m15:30:00.028221 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:00.029654 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 15:29:59.958444 => 15:30:00.029462
[0m15:30:00.030119 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m15:30:00.030843 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313c62d310>]}
[0m15:30:00.031471 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.08s]
[0m15:30:00.032021 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m15:30:00.032731 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m15:30:00.033404 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m15:30:00.034046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m15:30:00.034475 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m15:30:00.037217 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m15:30:00.037949 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 15:30:00.034789 => 15:30:00.037750
[0m15:30:00.038393 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m15:30:00.042362 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m15:30:00.043024 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:30:00.043464 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m15:30:00.043861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:00.048423 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:30:00.048984 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:30:00.049450 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m15:30:00.055448 [debug] [Thread-1  ]: SQL status: SELECT 487 in 0.0 seconds
[0m15:30:00.058775 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:30:00.059317 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m15:30:00.060158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:00.063009 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:30:00.063500 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m15:30:00.064166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:30:00.066347 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m15:30:00.066792 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:30:00.067200 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m15:30:00.068664 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m15:30:00.071047 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m15:30:00.071494 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m15:30:00.073747 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m15:30:00.075059 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 15:30:00.038695 => 15:30:00.074911
[0m15:30:00.075523 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m15:30:00.076270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18912aa-bfef-4ece-8ff0-6eba54a73c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313cf6f210>]}
[0m15:30:00.076900 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.04s]
[0m15:30:00.077500 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m15:30:00.129305 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:00.130601 [debug] [MainThread]: On master: BEGIN
[0m15:30:00.131751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:00.143578 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:30:00.145138 [debug] [MainThread]: On master: COMMIT
[0m15:30:00.146367 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:00.147418 [debug] [MainThread]: On master: COMMIT
[0m15:30:00.148325 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:30:00.149119 [debug] [MainThread]: On master: Close
[0m15:30:00.150393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:00.150992 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m15:30:00.151509 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m15:30:00.152008 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m15:30:00.152612 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m15:30:00.153205 [info ] [MainThread]: 
[0m15:30:00.153733 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:30:00.154854 [debug] [MainThread]: Command end result
[0m15:30:00.159983 [info ] [MainThread]: 
[0m15:30:00.160509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:00.160893 [info ] [MainThread]: 
[0m15:30:00.161305 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:30:00.161863 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:00.161775 after 0.65 seconds
[0m15:30:00.162289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313c70d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313c70d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71313c70d610>]}
[0m15:30:00.162721 [debug] [MainThread]: Flushing usage events
[0m16:02:01.774653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bfa5c5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bfa5c5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bfa5c5950>]}


============================== 16:02:01.781425 | e00452d6-db3f-44a6-b5e8-d6aef9b94502 ==============================
[0m16:02:01.781425 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:02:01.781941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:02:01.846932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bfa5f7650>]}
[0m16:02:01.864854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bfa5d7550>]}
[0m16:02:01.865934 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:02:01.878127 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:02:01.912789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:01.913477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:01.919803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf620abd0>]}
[0m16:02:01.924956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf6251550>]}
[0m16:02:01.925670 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:02:01.926231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf6251710>]}
[0m16:02:01.928163 [info ] [MainThread]: 
[0m16:02:01.929149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:01.930562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m16:02:01.941299 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m16:02:01.941793 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m16:02:01.942176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:01.950591 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:02:01.952270 [debug] [ThreadPool]: On list_finbest: Close
[0m16:02:01.954232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m16:02:01.960836 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m16:02:01.961544 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m16:02:01.961977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:01.967461 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.968014 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m16:02:01.968428 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m16:02:01.972160 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:02:01.973574 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m16:02:01.974279 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m16:02:01.981373 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:01.981907 [debug] [MainThread]: On master: BEGIN
[0m16:02:01.982281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:01.987055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.987721 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:01.988316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:01.993146 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:02:01.994865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf6246f50>]}
[0m16:02:01.995916 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:01.996570 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:01.996944 [debug] [MainThread]: On master: BEGIN
[0m16:02:01.997415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:01.997796 [debug] [MainThread]: On master: COMMIT
[0m16:02:01.998159 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:01.998497 [debug] [MainThread]: On master: COMMIT
[0m16:02:01.998883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:01.999243 [debug] [MainThread]: On master: Close
[0m16:02:01.999916 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:02.000309 [info ] [MainThread]: 
[0m16:02:02.005236 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m16:02:02.005703 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m16:02:02.006424 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m16:02:02.007078 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m16:02:02.007884 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m16:02:02.008666 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m16:02:02.009659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m16:02:02.010478 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m16:02:02.011565 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m16:02:02.012353 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m16:02:02.012936 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m16:02:02.013501 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m16:02:02.020192 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m16:02:02.022606 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m16:02:02.024391 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m16:02:02.025301 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 16:02:02.013929 => 16:02:02.025069
[0m16:02:02.025809 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m16:02:02.026473 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 16:02:02.020601 => 16:02:02.026180
[0m16:02:02.032349 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 16:02:02.023023 => 16:02:02.032051
[0m16:02:02.032918 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m16:02:02.038509 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m16:02:02.099542 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m16:02:02.101349 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m16:02:02.102646 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m16:02:02.103569 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:02:02.104023 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:02:02.104562 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:02:02.104894 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m16:02:02.105439 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m16:02:02.105910 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m16:02:02.106638 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:02:02.107071 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:02:02.107490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:02:02.114947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.115900 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.116834 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.117174 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:02:02.117798 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:02:02.118398 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:02:02.118837 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m16:02:02.119592 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m16:02:02.120275 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m16:02:02.149966 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m16:02:02.156126 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m16:02:02.157164 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:02:02.157553 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m16:02:02.161339 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:02:02.162241 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m16:02:02.166344 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:02:02.166859 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m16:02:02.167411 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m16:02:02.167919 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.170965 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:02:02.171456 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.171885 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m16:02:02.172403 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.175909 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:02:02.179170 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:02:02.179696 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.180305 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m16:02:02.180927 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m16:02:02.197388 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.203958 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m16:02:02.206500 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m16:02:02.207039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.207592 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:02:02.208128 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:02:02.211223 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m16:02:02.211969 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m16:02:02.212505 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m16:02:02.213048 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:02:02.213586 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m16:02:02.214275 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.214690 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.215147 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.220462 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:02:02.222819 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:02:02.225653 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:02:02.226226 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m16:02:02.226787 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m16:02:02.227435 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m16:02:02.230636 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:02.231177 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:02.232696 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 16:02:02.059737 => 16:02:02.232524
[0m16:02:02.233204 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:02.234688 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 16:02:02.026915 => 16:02:02.234525
[0m16:02:02.235181 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m16:02:02.236627 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 16:02:02.044096 => 16:02:02.236449
[0m16:02:02.237149 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m16:02:02.237656 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m16:02:02.238463 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747be6790c10>]}
[0m16:02:02.239501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf590f750>]}
[0m16:02:02.240227 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf6155f10>]}
[0m16:02:02.240989 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.23s]
[0m16:02:02.242033 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.23s]
[0m16:02:02.242896 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.23s]
[0m16:02:02.243659 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m16:02:02.244603 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m16:02:02.245208 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m16:02:02.246284 [debug] [Thread-2  ]: Began running node model.finbest.int_daily_transactions
[0m16:02:02.246807 [info ] [Thread-2  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m16:02:02.247554 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.int_daily_transactions)
[0m16:02:02.247987 [debug] [Thread-2  ]: Began compiling node model.finbest.int_daily_transactions
[0m16:02:02.250895 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m16:02:02.251687 [debug] [Thread-2  ]: Timing info for model.finbest.int_daily_transactions (compile): 16:02:02.248313 => 16:02:02.251476
[0m16:02:02.252130 [debug] [Thread-2  ]: Began executing node model.finbest.int_daily_transactions
[0m16:02:02.257592 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m16:02:02.258340 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:02:02.258800 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: BEGIN
[0m16:02:02.259319 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:02:02.265387 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.265953 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:02:02.266392 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m16:02:02.296261 [debug] [Thread-2  ]: SQL status: SELECT 487 in 0.0 seconds
[0m16:02:02.339868 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:02:02.340454 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m16:02:02.341237 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.345379 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:02:02.346219 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m16:02:02.346984 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.349491 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: COMMIT
[0m16:02:02.350012 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:02:02.350422 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: COMMIT
[0m16:02:02.354344 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.357105 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:02:02.357641 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m16:02:02.362885 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:02.364728 [debug] [Thread-2  ]: Timing info for model.finbest.int_daily_transactions (execute): 16:02:02.252494 => 16:02:02.364534
[0m16:02:02.365355 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: Close
[0m16:02:02.366464 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747be6752690>]}
[0m16:02:02.367419 [info ] [Thread-2  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 487[0m in 0.12s]
[0m16:02:02.368023 [debug] [Thread-2  ]: Finished running node model.finbest.int_daily_transactions
[0m16:02:02.368751 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m16:02:02.369375 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m16:02:02.370054 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m16:02:02.370495 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m16:02:02.373343 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m16:02:02.374536 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 16:02:02.370807 => 16:02:02.374267
[0m16:02:02.375235 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m16:02:02.380868 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m16:02:02.381667 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:02:02.382132 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m16:02:02.382530 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:02:02.387960 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.389051 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:02:02.389963 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m16:02:02.399936 [debug] [Thread-3  ]: SQL status: SELECT 487 in 0.0 seconds
[0m16:02:02.403698 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:02:02.404209 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m16:02:02.406786 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.410060 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:02:02.410611 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m16:02:02.411486 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:02.414748 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m16:02:02.415306 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:02:02.415799 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m16:02:02.417064 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.420139 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:02:02.420857 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m16:02:02.423792 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:02:02.425299 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 16:02:02.375787 => 16:02:02.425110
[0m16:02:02.425815 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m16:02:02.427212 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e00452d6-db3f-44a6-b5e8-d6aef9b94502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf6202850>]}
[0m16:02:02.428002 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 487[0m in 0.06s]
[0m16:02:02.428660 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m16:02:02.439407 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:02.439943 [debug] [MainThread]: On master: BEGIN
[0m16:02:02.440529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:02.497188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:02.497771 [debug] [MainThread]: On master: COMMIT
[0m16:02:02.498189 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:02.498562 [debug] [MainThread]: On master: COMMIT
[0m16:02:02.499035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:02.499447 [debug] [MainThread]: On master: Close
[0m16:02:02.500155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:02.500547 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m16:02:02.500891 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m16:02:02.501231 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m16:02:02.501659 [info ] [MainThread]: 
[0m16:02:02.502043 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:02:02.503263 [debug] [MainThread]: Command end result
[0m16:02:02.509160 [info ] [MainThread]: 
[0m16:02:02.509850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:02.510388 [info ] [MainThread]: 
[0m16:02:02.510808 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:02:02.511967 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:02.511858 after 0.75 seconds
[0m16:02:02.512434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf8c73c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747bf9cabe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747be67825d0>]}
[0m16:02:02.512887 [debug] [MainThread]: Flushing usage events
[0m16:47:48.609287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596eaff6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596eaff6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596eaff64d0>]}


============================== 16:47:48.624908 | 5b605c75-add1-450f-9895-ed5d8bbfc61c ==============================
[0m16:47:48.624908 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:47:48.625441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'debug': 'True', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:47:48.682081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596eb19c610>]}
[0m16:47:48.696758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596eaff6590>]}
[0m16:47:48.697633 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:47:48.707755 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:47:48.735540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:48.736083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:48.742009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e6b16450>]}
[0m16:47:48.746742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e7f62d10>]}
[0m16:47:48.747291 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:47:48.747647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e7f62e50>]}
[0m16:47:48.749040 [info ] [MainThread]: 
[0m16:47:48.749765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:48.751020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m16:47:48.761137 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m16:47:48.761631 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m16:47:48.762000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:48.768091 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:47:48.769447 [debug] [ThreadPool]: On list_finbest: Close
[0m16:47:48.771330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m16:47:48.777047 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m16:47:48.777665 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m16:47:48.778116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:48.784111 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:48.784818 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m16:47:48.785404 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m16:47:48.789484 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:47:48.791241 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m16:47:48.791940 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m16:47:48.799825 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:48.800616 [debug] [MainThread]: On master: BEGIN
[0m16:47:48.801264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:48.807735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:48.808310 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:48.808836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:48.815449 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:47:48.817069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e7f53fd0>]}
[0m16:47:48.817800 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:48.818537 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:48.819117 [debug] [MainThread]: On master: BEGIN
[0m16:47:48.819766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:48.820285 [debug] [MainThread]: On master: COMMIT
[0m16:47:48.820754 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:48.821220 [debug] [MainThread]: On master: COMMIT
[0m16:47:48.821763 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:47:48.822195 [debug] [MainThread]: On master: Close
[0m16:47:48.822902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:48.823305 [info ] [MainThread]: 
[0m16:47:48.828183 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m16:47:48.828744 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m16:47:48.829429 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m16:47:48.830060 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m16:47:48.830670 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m16:47:48.831226 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m16:47:48.831943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m16:47:48.832721 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m16:47:48.833440 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m16:47:48.833936 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m16:47:48.834485 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m16:47:48.835017 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m16:47:48.842415 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m16:47:48.844186 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m16:47:48.845764 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m16:47:48.846718 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 16:47:48.835438 => 16:47:48.846408
[0m16:47:48.847388 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 16:47:48.842819 => 16:47:48.847142
[0m16:47:48.847879 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m16:47:48.848385 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m16:47:48.848893 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 16:47:48.844546 => 16:47:48.848724
[0m16:47:48.880793 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m16:47:48.914499 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m16:47:48.916158 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m16:47:48.920116 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m16:47:48.920980 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:47:48.921450 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m16:47:48.921882 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:47:48.922316 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:47:48.922776 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:47:48.923459 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m16:47:48.924041 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m16:47:48.924529 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:47:48.924989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:48.927888 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:47:48.928723 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:47:48.929153 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m16:47:48.929786 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:47:48.930302 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:47:48.930747 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:47:48.931218 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:47:48.931670 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m16:47:48.932126 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m16:47:48.935829 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m16:47:48.942394 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:47:48.942929 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m16:47:48.943420 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m16:47:48.943958 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m16:47:48.947787 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:47:48.948252 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:48.951263 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:47:48.951932 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m16:47:48.954768 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:47:48.955248 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m16:47:48.955771 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m16:47:48.956286 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:48.959274 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:47:48.959793 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:48.960284 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m16:47:48.960772 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:48.982443 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:48.985431 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m16:47:48.990411 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:47:48.994776 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m16:47:48.995725 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:47:48.996381 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m16:47:48.997267 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:47:48.997979 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m16:47:48.998549 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m16:47:48.999057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:49.002035 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m16:47:49.002586 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:47:49.003010 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:47:49.003499 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:47:49.009157 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m16:47:49.011807 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m16:47:49.012307 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m16:47:49.012839 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m16:47:49.013599 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m16:47:49.015053 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:47:49.017564 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m16:47:49.018050 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:49.018478 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m16:47:49.018856 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:49.020446 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 16:47:48.916530 => 16:47:49.020277
[0m16:47:49.022732 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 16:47:48.860028 => 16:47:49.022485
[0m16:47:49.023506 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m16:47:49.023957 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:49.024496 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m16:47:49.026114 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 16:47:48.849211 => 16:47:49.025951
[0m16:47:49.026872 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e6b1be10>]}
[0m16:47:49.027453 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m16:47:49.028409 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e614efd0>]}
[0m16:47:49.029481 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.19s]
[0m16:47:49.030211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e628cad0>]}
[0m16:47:49.030984 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.20s]
[0m16:47:49.031915 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m16:47:49.032540 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m16:47:49.033312 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m16:47:49.034355 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m16:47:49.035136 [debug] [Thread-2  ]: Began running node model.finbest.int_daily_transactions
[0m16:47:49.036112 [info ] [Thread-2  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m16:47:49.037234 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.int_daily_transactions)
[0m16:47:49.037949 [debug] [Thread-2  ]: Began compiling node model.finbest.int_daily_transactions
[0m16:47:49.043855 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m16:47:49.045038 [debug] [Thread-2  ]: Timing info for model.finbest.int_daily_transactions (compile): 16:47:49.038511 => 16:47:49.044727
[0m16:47:49.045770 [debug] [Thread-2  ]: Began executing node model.finbest.int_daily_transactions
[0m16:47:49.085582 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m16:47:49.086384 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:47:49.086846 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: BEGIN
[0m16:47:49.087252 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:47:49.092060 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:47:49.092585 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:47:49.093008 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m16:47:49.100860 [debug] [Thread-2  ]: SQL status: SELECT 480 in 0.0 seconds
[0m16:47:49.103956 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:47:49.104443 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m16:47:49.105374 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:49.108615 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:47:49.109282 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m16:47:49.109931 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:49.111941 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: COMMIT
[0m16:47:49.112364 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:47:49.112734 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: COMMIT
[0m16:47:49.113956 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:47:49.116323 [debug] [Thread-2  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m16:47:49.116728 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m16:47:49.119107 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:49.120558 [debug] [Thread-2  ]: Timing info for model.finbest.int_daily_transactions (execute): 16:47:49.046287 => 16:47:49.120406
[0m16:47:49.120991 [debug] [Thread-2  ]: On model.finbest.int_daily_transactions: Close
[0m16:47:49.121734 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596eaf40390>]}
[0m16:47:49.122362 [info ] [Thread-2  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 480[0m in 0.08s]
[0m16:47:49.122913 [debug] [Thread-2  ]: Finished running node model.finbest.int_daily_transactions
[0m16:47:49.123838 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m16:47:49.124503 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m16:47:49.125133 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m16:47:49.125540 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m16:47:49.128181 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m16:47:49.128867 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 16:47:49.125840 => 16:47:49.128689
[0m16:47:49.129427 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m16:47:49.133485 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m16:47:49.134108 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:47:49.134531 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m16:47:49.134912 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:47:49.139420 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:47:49.139933 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:47:49.140374 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m16:47:49.146648 [debug] [Thread-3  ]: SQL status: SELECT 480 in 0.0 seconds
[0m16:47:49.151328 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:47:49.152177 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m16:47:49.153626 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:49.159234 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:47:49.159905 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m16:47:49.160829 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:49.163714 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m16:47:49.164223 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:47:49.164699 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m16:47:49.165933 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:47:49.168241 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m16:47:49.168653 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m16:47:49.171130 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:49.172575 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 16:47:49.129774 => 16:47:49.172423
[0m16:47:49.172992 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m16:47:49.173727 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b605c75-add1-450f-9895-ed5d8bbfc61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e61ed550>]}
[0m16:47:49.174366 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 480[0m in 0.05s]
[0m16:47:49.174955 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m16:47:49.232057 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:49.234487 [debug] [MainThread]: On master: BEGIN
[0m16:47:49.236497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:49.247827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:49.248699 [debug] [MainThread]: On master: COMMIT
[0m16:47:49.249394 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:49.250081 [debug] [MainThread]: On master: COMMIT
[0m16:47:49.250843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:47:49.251433 [debug] [MainThread]: On master: Close
[0m16:47:49.252377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:49.252918 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m16:47:49.253425 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m16:47:49.253863 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m16:47:49.254274 [info ] [MainThread]: 
[0m16:47:49.254639 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:47:49.255771 [debug] [MainThread]: Command end result
[0m16:47:49.260835 [info ] [MainThread]: 
[0m16:47:49.261348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:49.261725 [info ] [MainThread]: 
[0m16:47:49.262070 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:47:49.262599 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:49.262521 after 0.67 seconds
[0m16:47:49.262970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e7ebf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e9668810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596e62930d0>]}
[0m16:47:49.263386 [debug] [MainThread]: Flushing usage events
[0m17:53:43.628788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7695011fa3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7695011fa390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7695011faa10>]}


============================== 17:53:43.634858 | c8dfc99e-c4a7-4f86-a670-9f42c7328ff3 ==============================
[0m17:53:43.634858 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:53:43.635451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:53:43.701508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76950122b810>]}
[0m17:53:43.718004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76950121a210>]}
[0m17:53:43.719004 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:53:43.730869 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:53:43.762742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:43.763361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:43.769722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694ff7edf90>]}
[0m17:53:43.774972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fce865d0>]}
[0m17:53:43.775557 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:53:43.775937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fce86790>]}
[0m17:53:43.777374 [info ] [MainThread]: 
[0m17:53:43.778108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:43.779498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m17:53:43.790773 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m17:53:43.791357 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m17:53:43.791776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:43.804576 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:53:43.806558 [debug] [ThreadPool]: On list_finbest: Close
[0m17:53:43.808631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m17:53:43.814884 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m17:53:43.815423 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m17:53:43.815790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:43.820747 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:53:43.821303 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m17:53:43.821789 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m17:53:43.830997 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:53:43.832887 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m17:53:43.833552 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m17:53:43.839278 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:43.839840 [debug] [MainThread]: On master: BEGIN
[0m17:53:43.840239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:43.845199 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:43.845768 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:43.846258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:43.857622 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:53:43.859120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fce90f10>]}
[0m17:53:43.859819 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:43.860476 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:43.860938 [debug] [MainThread]: On master: BEGIN
[0m17:53:43.861516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:43.861969 [debug] [MainThread]: On master: COMMIT
[0m17:53:43.862368 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:43.862732 [debug] [MainThread]: On master: COMMIT
[0m17:53:43.863245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:53:43.863666 [debug] [MainThread]: On master: Close
[0m17:53:43.864632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:43.865324 [info ] [MainThread]: 
[0m17:53:43.871230 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m17:53:43.871943 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m17:53:43.872819 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m17:53:43.873435 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m17:53:43.874044 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m17:53:43.874833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m17:53:43.875888 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m17:53:43.877213 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m17:53:43.877775 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m17:53:43.879322 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m17:53:43.880413 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m17:53:43.887230 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m17:53:43.888012 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m17:53:43.891381 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m17:53:43.894447 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m17:53:43.895747 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 17:53:43.880791 => 17:53:43.895512
[0m17:53:43.896529 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 17:53:43.891921 => 17:53:43.896204
[0m17:53:43.897480 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m17:53:43.898077 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m17:53:43.898952 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 17:53:43.889310 => 17:53:43.898744
[0m17:53:43.925158 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m17:53:43.986052 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m17:53:43.997006 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m17:53:43.999349 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m17:53:44.000936 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:53:44.001739 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m17:53:44.002480 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:53:44.003019 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:53:44.003759 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m17:53:44.004272 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:53:44.005063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:44.005859 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m17:53:44.006932 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:53:44.011843 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:53:44.013093 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:53:44.014642 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m17:53:44.015676 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:53:44.016864 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:53:44.019154 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:53:44.020338 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:53:44.022088 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m17:53:44.023092 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m17:53:44.042589 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m17:53:44.050041 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:53:44.050730 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m17:53:44.051480 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m17:53:44.057178 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m17:53:44.058517 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:53:44.064712 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.065251 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m17:53:44.064422 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:53:44.069227 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:53:44.069877 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m17:53:44.070487 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m17:53:44.071152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.074761 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:53:44.075458 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.076196 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m17:53:44.076749 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.092939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.113514 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m17:53:44.108509 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:53:44.116574 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m17:53:44.117158 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:53:44.117757 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m17:53:44.118600 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:53:44.119098 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m17:53:44.119669 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m17:53:44.120264 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.124420 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m17:53:44.125178 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:53:44.125734 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:53:44.126440 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:53:44.132413 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:53:44.133018 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m17:53:44.135961 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:53:44.136546 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m17:53:44.137260 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m17:53:44.138008 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:53:44.141182 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:53:44.142015 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:53:44.142678 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m17:53:44.144595 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 17:53:43.956293 => 17:53:44.144358
[0m17:53:44.145210 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:53:44.145857 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m17:53:44.147627 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 17:53:43.899372 => 17:53:44.147446
[0m17:53:44.148383 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m17:53:44.149233 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fc4cdfd0>]}
[0m17:53:44.149730 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:53:44.151387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fceaa890>]}
[0m17:53:44.152365 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.27s]
[0m17:53:44.153931 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 17:53:43.909613 => 17:53:44.153747
[0m17:53:44.154869 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.28s]
[0m17:53:44.155642 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m17:53:44.156220 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m17:53:44.156868 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m17:53:44.158082 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fc509710>]}
[0m17:53:44.159064 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.28s]
[0m17:53:44.159942 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m17:53:44.160655 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m17:53:44.161252 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m17:53:44.162029 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m17:53:44.162481 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m17:53:44.165581 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m17:53:44.167189 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 17:53:44.162811 => 17:53:44.166969
[0m17:53:44.167640 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m17:53:44.209608 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m17:53:44.210934 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:53:44.211433 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m17:53:44.211828 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:53:44.236591 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:53:44.237483 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:53:44.238271 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m17:53:44.251420 [debug] [Thread-4  ]: SQL status: SELECT 480 in 0.0 seconds
[0m17:53:44.254858 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:53:44.255380 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m17:53:44.256085 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.259162 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:53:44.259711 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m17:53:44.260595 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.265783 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m17:53:44.267023 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:53:44.268061 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m17:53:44.271051 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:53:44.275342 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:53:44.276263 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m17:53:44.283435 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:53:44.286348 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 17:53:44.167955 => 17:53:44.285997
[0m17:53:44.287276 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m17:53:44.288953 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fc3e6d90>]}
[0m17:53:44.290870 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 480[0m in 0.13s]
[0m17:53:44.292531 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m17:53:44.293882 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m17:53:44.294954 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m17:53:44.296293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m17:53:44.297311 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m17:53:44.302883 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m17:53:44.304764 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 17:53:44.297984 => 17:53:44.304336
[0m17:53:44.305710 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m17:53:44.314267 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m17:53:44.316457 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:53:44.317430 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m17:53:44.318229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:44.325665 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:53:44.326675 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:53:44.327459 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m17:53:44.337659 [debug] [Thread-1  ]: SQL status: SELECT 480 in 0.0 seconds
[0m17:53:44.341937 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:53:44.342517 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m17:53:44.343600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.347874 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:53:44.348562 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m17:53:44.349885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:53:44.352484 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m17:53:44.353026 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:53:44.353483 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m17:53:44.354719 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:53:44.357907 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:53:44.358424 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m17:53:44.360808 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:53:44.362241 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 17:53:44.306333 => 17:53:44.362059
[0m17:53:44.362697 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m17:53:44.363465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8dfc99e-c4a7-4f86-a670-9f42c7328ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fc3e6b90>]}
[0m17:53:44.364173 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 480[0m in 0.07s]
[0m17:53:44.364815 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m17:53:44.417179 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:44.418388 [debug] [MainThread]: On master: BEGIN
[0m17:53:44.419373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:44.430886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:44.432144 [debug] [MainThread]: On master: COMMIT
[0m17:53:44.433120 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:44.434039 [debug] [MainThread]: On master: COMMIT
[0m17:53:44.435187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:53:44.436199 [debug] [MainThread]: On master: Close
[0m17:53:44.437802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:44.438805 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m17:53:44.439676 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m17:53:44.440651 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m17:53:44.441620 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m17:53:44.442759 [info ] [MainThread]: 
[0m17:53:44.444030 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m17:53:44.446834 [debug] [MainThread]: Command end result
[0m17:53:44.458528 [info ] [MainThread]: 
[0m17:53:44.459714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:44.460596 [info ] [MainThread]: 
[0m17:53:44.461466 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:53:44.464789 [debug] [MainThread]: Command `dbt run` succeeded at 17:53:44.464553 after 0.85 seconds
[0m17:53:44.465752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694ff8a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fe78ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7694fc480fd0>]}
[0m17:53:44.466684 [debug] [MainThread]: Flushing usage events
[0m18:17:31.081579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b6528650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b6528c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b6528610>]}


============================== 18:17:31.096620 | 2da795da-49d6-4211-b792-9404757d5e2f ==============================
[0m18:17:31.096620 [info ] [MainThread]: Running with dbt=1.5.11
[0m18:17:31.097184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:17:31.151658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b6756490>]}
[0m18:17:31.168325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b65427d0>]}
[0m18:17:31.169328 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m18:17:31.180733 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m18:17:31.209370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:31.209844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:31.215458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b34bbad0>]}
[0m18:17:31.220031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b3513f10>]}
[0m18:17:31.220560 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:17:31.220979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b3513950>]}
[0m18:17:31.222308 [info ] [MainThread]: 
[0m18:17:31.222972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:31.224263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m18:17:31.234271 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m18:17:31.234732 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m18:17:31.235103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:31.240852 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:17:31.242242 [debug] [ThreadPool]: On list_finbest: Close
[0m18:17:31.244105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m18:17:31.249546 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m18:17:31.250247 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m18:17:31.250620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:31.255610 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.256204 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m18:17:31.256713 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m18:17:31.260874 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:17:31.262600 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m18:17:31.263354 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m18:17:31.270607 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:31.271278 [debug] [MainThread]: On master: BEGIN
[0m18:17:31.271812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:31.277198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.277782 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:31.278248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:31.283318 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:17:31.284694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b3527650>]}
[0m18:17:31.285360 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:31.286016 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:31.286526 [debug] [MainThread]: On master: BEGIN
[0m18:17:31.287086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.287457 [debug] [MainThread]: On master: COMMIT
[0m18:17:31.287804 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:31.288139 [debug] [MainThread]: On master: COMMIT
[0m18:17:31.288529 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.288886 [debug] [MainThread]: On master: Close
[0m18:17:31.289542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:17:31.289906 [info ] [MainThread]: 
[0m18:17:31.294602 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m18:17:31.295032 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m18:17:31.295791 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m18:17:31.296447 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m18:17:31.297231 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m18:17:31.297802 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m18:17:31.298522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m18:17:31.299320 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m18:17:31.300096 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m18:17:31.300587 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m18:17:31.301036 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m18:17:31.301474 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m18:17:31.308445 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m18:17:31.310359 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m18:17:31.312393 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m18:17:31.313273 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 18:17:31.301910 => 18:17:31.313061
[0m18:17:31.313713 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 18:17:31.308883 => 18:17:31.313515
[0m18:17:31.314217 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m18:17:31.314785 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 18:17:31.311005 => 18:17:31.314607
[0m18:17:31.315117 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m18:17:31.327164 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m18:17:31.380551 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m18:17:31.384029 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m18:17:31.384848 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m18:17:31.386075 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:17:31.386566 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m18:17:31.386991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:17:31.387648 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:17:31.388313 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m18:17:31.388753 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:17:31.389208 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:17:31.390420 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m18:17:31.391136 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:17:31.392234 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.392730 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:17:31.393159 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m18:17:31.394358 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.394908 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:17:31.395362 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m18:17:31.396744 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.397271 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m18:17:31.397630 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:17:31.403432 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m18:17:31.403888 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m18:17:31.405288 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:17:31.409007 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:17:31.409655 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m18:17:31.410162 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m18:17:31.410886 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.411347 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.414611 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:17:31.415137 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m18:17:31.418154 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:17:31.418671 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m18:17:31.421680 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:17:31.422192 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:17:31.422832 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m18:17:31.423270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.429158 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.444024 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m18:17:31.446228 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m18:17:31.446787 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.447285 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:17:31.447747 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:17:31.450630 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:17:31.451181 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m18:17:31.451669 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m18:17:31.452146 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m18:17:31.453048 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.455245 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m18:17:31.455719 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.456154 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.456595 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:17:31.461519 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m18:17:31.463975 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m18:17:31.464489 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m18:17:31.465084 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m18:17:31.465504 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m18:17:31.467133 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.469739 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m18:17:31.470321 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:31.470762 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m18:17:31.471208 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:31.472576 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 18:17:31.368047 => 18:17:31.472426
[0m18:17:31.474000 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 18:17:31.315543 => 18:17:31.473849
[0m18:17:31.474495 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m18:17:31.474884 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m18:17:31.475458 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:31.476503 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b183dd50>]}
[0m18:17:31.477517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b185de50>]}
[0m18:17:31.478970 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 18:17:31.342448 => 18:17:31.478801
[0m18:17:31.479826 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.18s]
[0m18:17:31.480449 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m18:17:31.480978 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m18:17:31.481593 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m18:17:31.482185 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m18:17:31.482996 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b170ef50>]}
[0m18:17:31.483792 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m18:17:31.484445 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.18s]
[0m18:17:31.485051 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m18:17:31.485714 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m18:17:31.486469 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m18:17:31.487042 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m18:17:31.490024 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m18:17:31.490802 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 18:17:31.487366 => 18:17:31.490566
[0m18:17:31.491414 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m18:17:31.497822 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m18:17:31.498558 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:17:31.499010 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m18:17:31.499407 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:17:31.504010 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.534629 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:17:31.535171 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m18:17:31.540932 [debug] [Thread-4  ]: SQL status: SELECT 480 in 0.0 seconds
[0m18:17:31.544061 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:17:31.544535 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m18:17:31.545207 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.548030 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:17:31.548498 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m18:17:31.549063 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.551160 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m18:17:31.551594 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:17:31.552144 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m18:17:31.553210 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.555485 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m18:17:31.555949 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m18:17:31.557918 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:31.559203 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 18:17:31.491882 => 18:17:31.559058
[0m18:17:31.559666 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m18:17:31.560411 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b3509590>]}
[0m18:17:31.561062 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 480[0m in 0.07s]
[0m18:17:31.561671 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m18:17:31.562383 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m18:17:31.562890 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m18:17:31.563497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m18:17:31.563930 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m18:17:31.566563 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m18:17:31.567280 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 18:17:31.564241 => 18:17:31.567088
[0m18:17:31.567712 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m18:17:31.571912 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m18:17:31.572541 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:17:31.572967 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m18:17:31.573351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:17:31.578120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.578801 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:17:31.579262 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m18:17:31.583566 [debug] [Thread-1  ]: SQL status: SELECT 480 in 0.0 seconds
[0m18:17:31.586719 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:17:31.587172 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m18:17:31.587775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.590550 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:17:31.590995 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m18:17:31.591534 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:31.593686 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m18:17:31.594119 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:17:31.594506 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m18:17:31.595652 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.598055 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m18:17:31.598532 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m18:17:31.600518 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:31.601890 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 18:17:31.568033 => 18:17:31.601712
[0m18:17:31.602307 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m18:17:31.603016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2da795da-49d6-4211-b792-9404757d5e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b183ded0>]}
[0m18:17:31.603630 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 480[0m in 0.04s]
[0m18:17:31.604221 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m18:17:31.700440 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:31.701729 [debug] [MainThread]: On master: BEGIN
[0m18:17:31.702799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:31.714076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:31.715409 [debug] [MainThread]: On master: COMMIT
[0m18:17:31.716446 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:31.717424 [debug] [MainThread]: On master: COMMIT
[0m18:17:31.718726 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:31.719811 [debug] [MainThread]: On master: Close
[0m18:17:31.721380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:31.722195 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m18:17:31.722786 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m18:17:31.723354 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m18:17:31.723943 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m18:17:31.724601 [info ] [MainThread]: 
[0m18:17:31.725174 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:17:31.726543 [debug] [MainThread]: Command end result
[0m18:17:31.731760 [info ] [MainThread]: 
[0m18:17:31.732264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:31.732635 [info ] [MainThread]: 
[0m18:17:31.733002 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:17:31.733537 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:31.733444 after 0.67 seconds
[0m18:17:31.733963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b4a37450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b3c8d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c02b3c8d7d0>]}
[0m18:17:31.734376 [debug] [MainThread]: Flushing usage events
[0m23:01:04.440170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73703538e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73703538ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73703538e510>]}


============================== 23:01:04.456105 | 15ddebe3-05e6-44eb-b0fc-ff7bf0065491 ==============================
[0m23:01:04.456105 [info ] [MainThread]: Running with dbt=1.5.11
[0m23:01:04.456671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:01:04.509793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370353bea90>]}
[0m23:01:04.525401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737032927990>]}
[0m23:01:04.526263 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m23:01:04.536632 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m23:01:04.564208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:04.564694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:04.570354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370338c2310>]}
[0m23:01:04.575051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737032378f90>]}
[0m23:01:04.575573 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:01:04.575992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370323789d0>]}
[0m23:01:04.577307 [info ] [MainThread]: 
[0m23:01:04.578001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:04.579258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m23:01:04.588875 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m23:01:04.589298 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m23:01:04.589652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:04.595481 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:01:04.596891 [debug] [ThreadPool]: On list_finbest: Close
[0m23:01:04.598803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m23:01:04.604693 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m23:01:04.605223 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m23:01:04.605714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:04.612584 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.613543 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m23:01:04.614338 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m23:01:04.619942 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:01:04.622398 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m23:01:04.623367 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m23:01:04.631238 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:04.632133 [debug] [MainThread]: On master: BEGIN
[0m23:01:04.632824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:04.639415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.640105 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:04.640736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:04.647045 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:01:04.649129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737030ef0890>]}
[0m23:01:04.650019 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:04.650895 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:04.651575 [debug] [MainThread]: On master: BEGIN
[0m23:01:04.652574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.653424 [debug] [MainThread]: On master: COMMIT
[0m23:01:04.654201 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:04.654942 [debug] [MainThread]: On master: COMMIT
[0m23:01:04.655751 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:04.656487 [debug] [MainThread]: On master: Close
[0m23:01:04.657823 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:04.658371 [info ] [MainThread]: 
[0m23:01:04.664817 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m23:01:04.665386 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m23:01:04.666028 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m23:01:04.666553 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m23:01:04.667271 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m23:01:04.667991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m23:01:04.668544 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m23:01:04.669318 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m23:01:04.669820 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m23:01:04.670557 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m23:01:04.671038 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m23:01:04.678616 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m23:01:04.679361 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m23:01:04.682062 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m23:01:04.685009 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m23:01:04.686556 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 23:01:04.671394 => 23:01:04.685977
[0m23:01:04.687579 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m23:01:04.693791 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 23:01:04.682766 => 23:01:04.693500
[0m23:01:04.694433 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m23:01:04.695232 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 23:01:04.680088 => 23:01:04.694969
[0m23:01:04.706358 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m23:01:04.840944 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m23:01:04.836306 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m23:01:04.846409 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m23:01:04.847846 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m23:01:04.848529 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m23:01:04.848949 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m23:01:04.849449 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m23:01:04.850483 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m23:01:04.851173 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:01:04.851848 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m23:01:04.852464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:01:04.853391 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:01:04.858255 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.858902 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m23:01:04.859437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.859948 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.860414 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m23:01:04.860853 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m23:01:04.861319 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m23:01:04.861821 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m23:01:04.862280 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m23:01:04.864782 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m23:01:04.865170 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m23:01:04.865859 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m23:01:04.872079 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m23:01:04.874944 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m23:01:04.877821 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m23:01:04.878466 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m23:01:04.879026 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m23:01:04.879637 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m23:01:04.880731 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:04.881470 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:04.897413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:04.913794 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m23:01:04.915761 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m23:01:04.918033 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m23:01:04.918482 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m23:01:04.918999 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m23:01:04.919450 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m23:01:04.919924 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m23:01:04.920337 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m23:01:04.920745 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m23:01:04.922401 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:01:04.927323 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m23:01:04.927969 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:01:04.928300 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m23:01:04.928644 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:01:04.931322 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m23:01:04.933896 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m23:01:04.934499 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:01:04.935083 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m23:01:04.935916 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m23:01:04.937283 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 23:01:04.695712 => 23:01:04.937133
[0m23:01:04.937857 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m23:01:04.938300 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:01:04.938805 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:01:04.939593 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737030f39910>]}
[0m23:01:04.941135 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 23:01:04.707002 => 23:01:04.940962
[0m23:01:04.942553 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 23:01:04.688396 => 23:01:04.942392
[0m23:01:04.943205 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.27s]
[0m23:01:04.943761 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m23:01:04.944245 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m23:01:04.944912 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m23:01:04.946049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737030f347d0>]}
[0m23:01:04.947121 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737030636990>]}
[0m23:01:04.947823 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.28s]
[0m23:01:04.948443 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m23:01:04.949046 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.28s]
[0m23:01:04.949734 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m23:01:04.950256 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m23:01:04.950877 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m23:01:04.951697 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m23:01:04.952205 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m23:01:04.954978 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m23:01:04.955657 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 23:01:04.952513 => 23:01:04.955466
[0m23:01:04.956087 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m23:01:04.961136 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m23:01:04.961797 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m23:01:04.962229 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m23:01:04.962606 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:01:04.967231 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:04.967731 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m23:01:04.968143 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m23:01:04.973811 [debug] [Thread-4  ]: SQL status: SELECT 476 in 0.0 seconds
[0m23:01:05.007975 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m23:01:05.008482 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m23:01:05.009231 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:05.011162 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m23:01:05.011595 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m23:01:05.011996 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m23:01:05.013660 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:01:05.015953 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m23:01:05.016366 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m23:01:05.017013 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:01:05.018273 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 23:01:04.956395 => 23:01:05.018127
[0m23:01:05.018698 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m23:01:05.019412 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737032c4c0d0>]}
[0m23:01:05.020036 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 476[0m in 0.07s]
[0m23:01:05.020608 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m23:01:05.021271 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m23:01:05.021865 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m23:01:05.022493 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m23:01:05.022911 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m23:01:05.025536 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m23:01:05.026552 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 23:01:05.023214 => 23:01:05.026367
[0m23:01:05.026987 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m23:01:05.030952 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m23:01:05.031574 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m23:01:05.032003 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m23:01:05.032387 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:01:05.036787 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:05.037310 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m23:01:05.037743 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m23:01:05.043646 [debug] [Thread-3  ]: SQL status: SELECT 476 in 0.0 seconds
[0m23:01:05.046834 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m23:01:05.047353 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m23:01:05.048098 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:05.049992 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m23:01:05.050428 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m23:01:05.050845 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m23:01:05.052290 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:01:05.054568 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m23:01:05.054986 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m23:01:05.055570 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:01:05.056898 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 23:01:05.027298 => 23:01:05.056748
[0m23:01:05.057309 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m23:01:05.058028 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ddebe3-05e6-44eb-b0fc-ff7bf0065491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7370306127d0>]}
[0m23:01:05.058665 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 476[0m in 0.04s]
[0m23:01:05.059245 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m23:01:05.108620 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:05.109863 [debug] [MainThread]: On master: BEGIN
[0m23:01:05.111011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:05.122313 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:05.123544 [debug] [MainThread]: On master: COMMIT
[0m23:01:05.124510 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:05.125397 [debug] [MainThread]: On master: COMMIT
[0m23:01:05.126452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:05.127371 [debug] [MainThread]: On master: Close
[0m23:01:05.128605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:05.129348 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m23:01:05.130011 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m23:01:05.130612 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m23:01:05.131064 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m23:01:05.131575 [info ] [MainThread]: 
[0m23:01:05.132082 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:01:05.133540 [debug] [MainThread]: Command end result
[0m23:01:05.138020 [info ] [MainThread]: 
[0m23:01:05.138499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:05.138867 [info ] [MainThread]: 
[0m23:01:05.139233 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:01:05.139770 [debug] [MainThread]: Command `dbt run` succeeded at 23:01:05.139669 after 0.71 seconds
[0m23:01:05.140199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73703538e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73703538e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73703538e7d0>]}
[0m23:01:05.140611 [debug] [MainThread]: Flushing usage events
[0m11:19:43.519643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3befaed250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3befaed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3befaed950>]}


============================== 11:19:43.524730 | dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7 ==============================
[0m11:19:43.524730 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:19:43.525268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:19:43.578654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3bed099d90>]}
[0m11:19:43.593110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3befb39ed0>]}
[0m11:19:43.593977 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:19:43.604590 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:19:43.633859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:43.634357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:43.639981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb7d7a90>]}
[0m11:19:43.644544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb779ed0>]}
[0m11:19:43.645053 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:19:43.645415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb779b10>]}
[0m11:19:43.646727 [info ] [MainThread]: 
[0m11:19:43.647413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:19:43.648672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:19:43.658540 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:19:43.658975 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:19:43.659329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:43.665227 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:19:43.666593 [debug] [ThreadPool]: On list_finbest: Close
[0m11:19:43.668212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m11:19:43.673501 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:19:43.673933 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:19:43.674362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:43.678855 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.679297 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:19:43.679658 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:19:43.683634 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:19:43.684883 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:19:43.685330 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:19:43.690555 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:43.691036 [debug] [MainThread]: On master: BEGIN
[0m11:19:43.691408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:43.696071 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.696575 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:43.697052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:19:43.702751 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:19:43.703875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb731a50>]}
[0m11:19:43.704403 [debug] [MainThread]: On master: ROLLBACK
[0m11:19:43.704881 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:43.705272 [debug] [MainThread]: On master: BEGIN
[0m11:19:43.705792 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.706204 [debug] [MainThread]: On master: COMMIT
[0m11:19:43.706583 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:43.706963 [debug] [MainThread]: On master: COMMIT
[0m11:19:43.707421 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:19:43.707820 [debug] [MainThread]: On master: Close
[0m11:19:43.708551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:43.709014 [info ] [MainThread]: 
[0m11:19:43.713776 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:19:43.714358 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:19:43.714968 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:19:43.715676 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:19:43.716139 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:19:43.717014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:19:43.717589 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:19:43.718360 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m11:19:43.718877 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:19:43.719629 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:19:43.720106 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:19:43.726488 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:19:43.727087 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:19:43.729256 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:19:43.730953 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:19:43.731778 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:19:43.720463 => 11:19:43.731569
[0m11:19:43.732330 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:19:43.732865 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:19:43.727442 => 11:19:43.732679
[0m11:19:43.733401 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:19:43.729727 => 11:19:43.733205
[0m11:19:43.744320 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:19:43.749964 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:19:43.789800 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:19:43.792342 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:19:43.796412 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:19:43.797365 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:19:43.797769 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:19:43.798375 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:19:43.798715 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:19:43.799169 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:19:43.799927 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:19:43.800595 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:19:43.801036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:19:43.801467 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:19:43.806381 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.807324 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:19:43.807829 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.808355 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:19:43.808896 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:19:43.809320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.809827 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:19:43.810261 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:19:43.810737 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:19:43.812163 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m11:19:43.818644 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:19:43.819165 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:19:43.819588 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:19:43.822998 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:19:43.823629 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:19:43.827204 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:19:43.827672 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:19:43.828210 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:19:43.828752 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.831825 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:19:43.832336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.832812 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:19:43.833244 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.835949 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:19:43.838773 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:19:43.839266 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.839776 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:19:43.840218 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:19:43.856523 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.860735 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:19:43.863207 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:19:43.863615 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.864117 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:19:43.864596 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:19:43.866648 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:19:43.867161 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:19:43.867653 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:19:43.868122 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:19:43.868622 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:19:43.869354 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:19:43.874308 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:19:43.874814 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:19:43.875278 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:19:43.875775 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:19:43.878619 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:19:43.881233 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:19:43.881688 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:19:43.882174 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:19:43.882626 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:19:43.884051 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:19:43.755516 => 11:19:43.883894
[0m11:19:43.884591 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:19:43.885748 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb6734d0>]}
[0m11:19:43.886400 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:19:43.887127 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.17s]
[0m11:19:43.887748 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:19:43.889204 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:19:43.733817 => 11:19:43.889039
[0m11:19:43.890116 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:19:43.891531 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:19:43.792696 => 11:19:43.891367
[0m11:19:43.891996 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:19:43.892592 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:19:43.893381 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb737590>]}
[0m11:19:43.894174 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beada6e90>]}
[0m11:19:43.894939 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m11:19:43.895612 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.17s]
[0m11:19:43.896245 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:19:43.896881 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:19:43.897870 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:19:43.898458 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:19:43.899209 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:19:43.899646 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:19:43.902494 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:19:43.903386 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:19:43.899977 => 11:19:43.903067
[0m11:19:43.903958 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:19:43.910209 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:19:43.910994 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:19:43.911446 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:19:43.911860 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:19:43.916424 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.916940 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:19:43.917373 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:19:43.923263 [debug] [Thread-4  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:19:43.957288 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:19:43.957870 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:19:43.958775 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.961346 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:19:43.961793 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:19:43.962482 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:43.964479 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:19:43.964897 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:19:43.965287 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:19:43.966566 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:19:43.969021 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:19:43.969589 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:19:43.971785 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:19:43.973076 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:19:43.904355 => 11:19:43.972927
[0m11:19:43.973486 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:19:43.974201 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beacf5f10>]}
[0m11:19:43.974840 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 516[0m in 0.08s]
[0m11:19:43.975430 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:19:43.976401 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m11:19:43.977046 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:19:43.977674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m11:19:43.978092 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m11:19:43.980638 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:19:43.981794 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 11:19:43.978393 => 11:19:43.981577
[0m11:19:43.982226 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m11:19:43.986211 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:19:43.987110 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:19:43.987784 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:19:43.988197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:19:43.992945 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:19:43.993495 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:19:43.993944 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:19:43.999045 [debug] [Thread-1  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:19:44.002203 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:19:44.002679 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:19:44.003420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:44.006254 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:19:44.006737 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:19:44.007439 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:19:44.009441 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:19:44.009845 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:19:44.010236 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:19:44.011927 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:19:44.014264 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:19:44.014665 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:19:44.017085 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:19:44.018396 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 11:19:43.982537 => 11:19:44.018240
[0m11:19:44.018836 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m11:19:44.019571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc74a5e-6b95-49c7-b46d-4f8eae4b14e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3befb1e590>]}
[0m11:19:44.020238 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 516[0m in 0.04s]
[0m11:19:44.020877 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m11:19:44.122650 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:44.123932 [debug] [MainThread]: On master: BEGIN
[0m11:19:44.125047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:44.136590 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:19:44.137892 [debug] [MainThread]: On master: COMMIT
[0m11:19:44.138911 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:44.139846 [debug] [MainThread]: On master: COMMIT
[0m11:19:44.141161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:19:44.142286 [debug] [MainThread]: On master: Close
[0m11:19:44.144008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:44.144975 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:19:44.145841 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m11:19:44.146796 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m11:19:44.147725 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:19:44.149384 [info ] [MainThread]: 
[0m11:19:44.150479 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:19:44.153210 [debug] [MainThread]: Command end result
[0m11:19:44.160078 [info ] [MainThread]: 
[0m11:19:44.160568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:44.160916 [info ] [MainThread]: 
[0m11:19:44.161275 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:19:44.161834 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:44.161753 after 0.65 seconds
[0m11:19:44.162225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beacf5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb731a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3beb731ed0>]}
[0m11:19:44.162704 [debug] [MainThread]: Flushing usage events
[0m11:29:12.696819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3f10e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3f10e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3f10e910>]}


============================== 11:29:12.701785 | 57c69036-80ae-47e9-a01b-ad99d4a86898 ==============================
[0m11:29:12.701785 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:29:12.702303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'version_check': 'True', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:29:12.755514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3f140590>]}
[0m11:29:12.770133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3f12b510>]}
[0m11:29:12.770984 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:29:12.781557 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:29:12.810276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:12.810740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:12.816601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3adf9510>]}
[0m11:29:12.821137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3ad9ba10>]}
[0m11:29:12.821637 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:29:12.822004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3ad9b310>]}
[0m11:29:12.823360 [info ] [MainThread]: 
[0m11:29:12.824046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:29:12.825268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:29:12.834969 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:29:12.835421 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:29:12.835784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:12.841379 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:29:12.842740 [debug] [ThreadPool]: On list_finbest: Close
[0m11:29:12.844491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m11:29:12.850343 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:29:12.850933 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:29:12.851442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:12.857401 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:29:12.858008 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:29:12.858495 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:29:12.860678 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:29:12.862096 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:29:12.862603 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:29:12.868270 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:12.868785 [debug] [MainThread]: On master: BEGIN
[0m11:29:12.869176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:12.874633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:12.875155 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:12.875605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:29:12.879768 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:29:12.880976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3ada4250>]}
[0m11:29:12.881606 [debug] [MainThread]: On master: ROLLBACK
[0m11:29:12.882205 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:12.882662 [debug] [MainThread]: On master: BEGIN
[0m11:29:12.883202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:12.883617 [debug] [MainThread]: On master: COMMIT
[0m11:29:12.883983 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:12.884319 [debug] [MainThread]: On master: COMMIT
[0m11:29:12.884703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:29:12.885055 [debug] [MainThread]: On master: Close
[0m11:29:12.885710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:29:12.886073 [info ] [MainThread]: 
[0m11:29:12.890887 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:29:12.891478 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:29:12.892375 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:29:12.892938 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:29:12.893514 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:29:12.894247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:29:12.894815 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:29:12.895543 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m11:29:12.896035 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:29:12.896800 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:29:12.897248 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:29:12.902932 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:29:12.904186 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:29:12.906300 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:29:12.907967 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:29:12.908812 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:29:12.897618 => 11:29:12.908593
[0m11:29:12.909352 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:29:12.915051 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:29:12.906693 => 11:29:12.914839
[0m11:29:12.921040 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:29:12.926819 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:29:12.904536 => 11:29:12.926577
[0m11:29:12.958660 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:29:12.977634 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:29:12.979520 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:29:12.981419 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:29:12.982738 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:29:12.983452 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:29:12.984276 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:29:12.985119 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:29:12.986010 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:29:12.986926 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:29:12.987809 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:29:12.989025 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:29:12.990180 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:29:12.996995 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:29:12.997921 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:29:12.998841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:29:12.999745 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:29:13.000508 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:29:13.001290 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:29:13.002202 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:29:13.003086 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:29:13.003892 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:29:13.007257 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:29:13.013270 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:29:13.013796 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m11:29:13.018902 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:29:13.020337 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:29:13.024968 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:29:13.025804 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:29:13.026593 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:29:13.027421 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:29:13.028878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.029792 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.030677 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.036006 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:29:13.042417 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:29:13.047267 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:29:13.048249 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:29:13.049391 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:29:13.050518 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:29:13.052152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.053281 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.054349 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.108262 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:29:13.109013 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:29:13.109445 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:29:13.109914 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:29:13.113205 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:29:13.113848 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:29:13.114303 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:29:13.114755 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:29:13.115214 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:29:13.116139 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:29:13.116767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:29:13.117193 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:29:13.122307 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:29:13.124663 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:29:13.127043 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:29:13.127518 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:29:13.128000 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:29:13.128466 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:29:13.130610 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:29:13.131282 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:29:13.132805 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:29:12.959114 => 11:29:13.132632
[0m11:29:13.133318 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:29:13.134635 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:29:12.927322 => 11:29:13.134493
[0m11:29:13.135129 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:29:13.136430 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:29:12.909717 => 11:29:13.136289
[0m11:29:13.136901 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:29:13.137432 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:29:13.138121 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3ad59b50>]}
[0m11:29:13.139109 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3acc3dd0>]}
[0m11:29:13.140138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3acc3fd0>]}
[0m11:29:13.140881 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.24s]
[0m11:29:13.141646 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.24s]
[0m11:29:13.142277 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.25s]
[0m11:29:13.142983 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:29:13.143633 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:29:13.144229 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:29:13.145063 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:29:13.145614 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:29:13.146340 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:29:13.146770 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:29:13.149670 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:29:13.150399 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:29:13.147081 => 11:29:13.150217
[0m11:29:13.150839 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:29:13.155853 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:29:13.156506 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:29:13.156931 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:29:13.157292 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:29:13.161852 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:29:13.162370 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:29:13.162804 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:29:13.166850 [debug] [Thread-4  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:29:13.200721 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:29:13.201235 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:29:13.202071 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.204686 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:29:13.205102 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:29:13.205886 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.207889 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:29:13.208296 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:29:13.208675 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:29:13.209905 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:29:13.212228 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:29:13.212613 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:29:13.214323 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:29:13.215618 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:29:13.151145 => 11:29:13.215471
[0m11:29:13.216059 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:29:13.216807 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed39bca950>]}
[0m11:29:13.217432 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 516[0m in 0.07s]
[0m11:29:13.218030 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:29:13.218699 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m11:29:13.219264 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:29:13.219904 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m11:29:13.220321 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m11:29:13.222958 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:29:13.223644 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 11:29:13.220626 => 11:29:13.223466
[0m11:29:13.224089 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m11:29:13.227946 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:29:13.228568 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:29:13.228985 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:29:13.229354 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:29:13.234160 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:29:13.234709 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:29:13.235140 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:29:13.239287 [debug] [Thread-3  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:29:13.242492 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:29:13.242948 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:29:13.243550 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.246248 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:29:13.246671 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:29:13.247278 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:29:13.249247 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:29:13.249655 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:29:13.250020 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:29:13.251124 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:29:13.253413 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:29:13.253814 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:29:13.255663 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:29:13.256996 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 11:29:13.224401 => 11:29:13.256848
[0m11:29:13.257411 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m11:29:13.258157 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57c69036-80ae-47e9-a01b-ad99d4a86898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed39b43d90>]}
[0m11:29:13.258801 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 516[0m in 0.04s]
[0m11:29:13.259362 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m11:29:13.315820 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:13.316932 [debug] [MainThread]: On master: BEGIN
[0m11:29:13.317804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:29:13.328352 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:13.329375 [debug] [MainThread]: On master: COMMIT
[0m11:29:13.330198 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:13.331326 [debug] [MainThread]: On master: COMMIT
[0m11:29:13.332206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:29:13.333025 [debug] [MainThread]: On master: Close
[0m11:29:13.334016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:13.334430 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m11:29:13.334827 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m11:29:13.335209 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:29:13.335582 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:29:13.336136 [info ] [MainThread]: 
[0m11:29:13.336555 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:29:13.337846 [debug] [MainThread]: Command end result
[0m11:29:13.342998 [info ] [MainThread]: 
[0m11:29:13.343507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:29:13.343895 [info ] [MainThread]: 
[0m11:29:13.344446 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:29:13.345007 [debug] [MainThread]: Command `dbt run` succeeded at 11:29:13.344918 after 0.66 seconds
[0m11:29:13.345417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed3c691e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed39b43bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ed39b43350>]}
[0m11:29:13.345858 [debug] [MainThread]: Flushing usage events
[0m11:43:28.712135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795650a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795650a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795650a990>]}


============================== 11:43:28.716563 | 08a1c5d9-ce82-421f-af5d-fb71dd618842 ==============================
[0m11:43:28.716563 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:43:28.717116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:43:28.769261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767956536610>]}
[0m11:43:28.783736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795654d8d0>]}
[0m11:43:28.784434 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:43:28.794406 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:43:28.810268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:28.810736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:28.816194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795214fe90>]}
[0m11:43:28.820963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679521974d0>]}
[0m11:43:28.821502 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:43:28.821911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767952197d50>]}
[0m11:43:28.823355 [info ] [MainThread]: 
[0m11:43:28.824100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:28.825419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:43:28.835580 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:43:28.836062 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:43:28.836437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:28.841876 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:43:28.843189 [debug] [ThreadPool]: On list_finbest: Close
[0m11:43:28.845058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m11:43:28.850780 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:43:28.851240 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:43:28.851700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:28.856425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:43:28.857042 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:43:28.857566 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:43:28.860029 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:43:28.861633 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:43:28.862253 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:43:28.869170 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:28.869845 [debug] [MainThread]: On master: BEGIN
[0m11:43:28.870418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:28.876300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:43:28.876845 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:28.877327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:28.881162 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:43:28.882500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767952093a50>]}
[0m11:43:28.883139 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:28.883717 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:28.884199 [debug] [MainThread]: On master: BEGIN
[0m11:43:28.884784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:43:28.885209 [debug] [MainThread]: On master: COMMIT
[0m11:43:28.885576 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:28.885948 [debug] [MainThread]: On master: COMMIT
[0m11:43:28.886346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:43:28.886710 [debug] [MainThread]: On master: Close
[0m11:43:28.887383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:43:28.887776 [info ] [MainThread]: 
[0m11:43:28.892798 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:43:28.893370 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:43:28.893985 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:43:28.894675 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:43:28.895309 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:43:28.896134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:43:28.896713 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:43:28.897489 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m11:43:28.897970 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:43:28.898719 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:43:28.899167 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:43:28.906281 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:43:28.906949 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:43:28.909881 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:43:28.911962 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:43:28.912518 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:43:28.899527 => 11:43:28.912301
[0m11:43:28.913211 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:43:28.913744 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:43:28.907536 => 11:43:28.913571
[0m11:43:28.924538 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:43:28.940577 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:43:28.910493 => 11:43:28.940350
[0m11:43:28.965810 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:43:28.966565 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:43:28.967103 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:43:28.971361 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:43:28.971951 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:43:28.972496 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:43:28.972941 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:43:28.973405 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:43:28.973940 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:43:28.974358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:28.974772 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:43:28.975178 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:43:28.975717 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:43:28.980485 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:43:28.981202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:43:28.981773 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:43:28.982272 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:43:28.982752 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:43:28.983206 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:43:28.983656 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:43:28.984123 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:43:28.984628 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:43:28.988420 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:43:28.988961 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m11:43:28.995864 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:43:28.998942 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:43:28.999492 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:43:28.999956 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:43:29.000453 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:43:29.004494 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:43:29.005438 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:43:29.005836 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.006183 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.009404 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:43:29.009920 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.012641 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:43:29.013082 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:43:29.015795 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:43:29.016333 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:43:29.016868 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:43:29.017316 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.023375 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.029069 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.039278 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:43:29.041823 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:43:29.044069 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:43:29.044580 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:43:29.045272 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:43:29.045806 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:43:29.046343 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:43:29.046852 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:43:29.047305 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:43:29.048991 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:43:29.054113 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:43:29.054632 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:43:29.055150 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:43:29.055676 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:43:29.058282 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:43:29.061018 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:43:29.061597 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:29.062244 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:43:29.062826 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:43:29.064391 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:43:28.967730 => 11:43:29.064217
[0m11:43:29.065143 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:43:29.066190 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795185c910>]}
[0m11:43:29.066967 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:29.067756 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.17s]
[0m11:43:29.068272 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:29.069775 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:43:28.914049 => 11:43:29.069601
[0m11:43:29.070376 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:43:29.071839 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:43:28.935172 => 11:43:29.071668
[0m11:43:29.072322 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:43:29.072898 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:43:29.073892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679516e4dd0>]}
[0m11:43:29.074703 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679518539d0>]}
[0m11:43:29.075103 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:43:29.075694 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.18s]
[0m11:43:29.076656 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.18s]
[0m11:43:29.077197 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:43:29.078169 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:43:29.079104 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:43:29.079885 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:43:29.080495 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:43:29.083355 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:43:29.084056 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:43:29.080827 => 11:43:29.083875
[0m11:43:29.084486 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:43:29.089727 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:43:29.090404 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:43:29.090863 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:43:29.091236 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:43:29.095817 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:43:29.096325 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:43:29.096797 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:43:29.100826 [debug] [Thread-4  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:43:29.134165 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:43:29.134695 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:43:29.135572 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.138210 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:43:29.138636 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:43:29.139563 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.141546 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:43:29.141970 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:43:29.142338 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:43:29.143541 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:43:29.145882 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:43:29.146289 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:43:29.148314 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:29.149626 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:43:29.084806 => 11:43:29.149477
[0m11:43:29.150093 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:43:29.150832 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679516e1250>]}
[0m11:43:29.151443 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 516[0m in 0.07s]
[0m11:43:29.152044 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:43:29.152697 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m11:43:29.153204 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:43:29.153832 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m11:43:29.154238 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m11:43:29.156871 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:43:29.157513 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 11:43:29.154553 => 11:43:29.157340
[0m11:43:29.157983 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m11:43:29.161871 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:43:29.162462 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:43:29.162885 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:43:29.163258 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:43:29.167799 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:43:29.168322 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:43:29.168764 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:43:29.173340 [debug] [Thread-3  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:43:29.176323 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:43:29.176771 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:43:29.177514 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.180290 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:43:29.180749 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:43:29.181334 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:43:29.183368 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:43:29.183790 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:43:29.184172 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:43:29.185293 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:43:29.187574 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:43:29.187974 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:43:29.189912 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:43:29.191266 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 11:43:29.158278 => 11:43:29.191115
[0m11:43:29.191697 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m11:43:29.192434 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a1c5d9-ce82-421f-af5d-fb71dd618842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795172b210>]}
[0m11:43:29.193094 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 516[0m in 0.04s]
[0m11:43:29.193659 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m11:43:29.197380 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:29.197790 [debug] [MainThread]: On master: BEGIN
[0m11:43:29.198148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:29.202579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:43:29.203042 [debug] [MainThread]: On master: COMMIT
[0m11:43:29.203416 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:29.203781 [debug] [MainThread]: On master: COMMIT
[0m11:43:29.204192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:43:29.204549 [debug] [MainThread]: On master: Close
[0m11:43:29.205189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:29.205544 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m11:43:29.205887 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m11:43:29.206210 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:43:29.206554 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:43:29.206952 [info ] [MainThread]: 
[0m11:43:29.207313 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:43:29.208363 [debug] [MainThread]: Command end result
[0m11:43:29.213260 [info ] [MainThread]: 
[0m11:43:29.213743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:29.214097 [info ] [MainThread]: 
[0m11:43:29.214453 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:43:29.215036 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:29.214924 after 0.51 seconds
[0m11:43:29.215413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795651b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795650a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76795650aa90>]}
[0m11:43:29.215823 [debug] [MainThread]: Flushing usage events
[0m11:50:11.045987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e548632d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e54863150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e54863990>]}


============================== 11:50:11.050884 | abfa03bd-8975-438a-ba4b-bc57e196d85c ==============================
[0m11:50:11.050884 [info ] [MainThread]: Running with dbt=1.5.11
[0m11:50:11.051391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:50:11.104034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e54895650>]}
[0m11:50:11.118523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e54863c90>]}
[0m11:50:11.119337 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m11:50:11.130291 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m11:50:11.156056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:11.156533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:11.162232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e504a7490>]}
[0m11:50:11.167011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e504f0190>]}
[0m11:50:11.167555 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:50:11.167913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e504f0250>]}
[0m11:50:11.169266 [info ] [MainThread]: 
[0m11:50:11.169978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:50:11.171363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m11:50:11.181894 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m11:50:11.182391 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m11:50:11.182769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:11.188392 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:50:11.189744 [debug] [ThreadPool]: On list_finbest: Close
[0m11:50:11.191531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m11:50:11.197347 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:50:11.197804 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m11:50:11.198248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:11.203132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.203669 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m11:50:11.204145 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m11:50:11.206266 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:50:11.207611 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m11:50:11.208119 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m11:50:11.213555 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:11.214126 [debug] [MainThread]: On master: BEGIN
[0m11:50:11.214578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:11.220099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.220641 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:11.221152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:50:11.226157 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:50:11.227581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e503e9f90>]}
[0m11:50:11.228270 [debug] [MainThread]: On master: ROLLBACK
[0m11:50:11.228966 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:11.229565 [debug] [MainThread]: On master: BEGIN
[0m11:50:11.230237 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.230830 [debug] [MainThread]: On master: COMMIT
[0m11:50:11.231356 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:11.231869 [debug] [MainThread]: On master: COMMIT
[0m11:50:11.232363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.232850 [debug] [MainThread]: On master: Close
[0m11:50:11.233719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:50:11.234221 [info ] [MainThread]: 
[0m11:50:11.239422 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m11:50:11.239987 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m11:50:11.240654 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m11:50:11.241302 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m11:50:11.241897 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m11:50:11.242631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m11:50:11.243176 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m11:50:11.243976 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m11:50:11.244470 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m11:50:11.245238 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m11:50:11.245728 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m11:50:11.252845 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m11:50:11.253316 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m11:50:11.255711 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m11:50:11.258775 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m11:50:11.260652 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 11:50:11.246080 => 11:50:11.260203
[0m11:50:11.261544 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m11:50:11.273082 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 11:50:11.256487 => 11:50:11.272843
[0m11:50:11.273671 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 11:50:11.253715 => 11:50:11.273479
[0m11:50:11.279350 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m11:50:11.285262 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m11:50:11.318750 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m11:50:11.316217 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m11:50:11.323723 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m11:50:11.324620 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:50:11.325137 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m11:50:11.325628 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:50:11.326031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:50:11.326663 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m11:50:11.327165 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:50:11.328193 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:50:11.328920 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m11:50:11.329546 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:50:11.332225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.333093 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:50:11.333547 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m11:50:11.334270 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.334832 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.335620 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:50:11.336176 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:50:11.336905 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m11:50:11.337381 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m11:50:11.337941 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m11:50:11.344935 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:50:11.345513 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m11:50:11.346279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.349448 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:50:11.350007 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m11:50:11.350729 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m11:50:11.351091 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:50:11.356996 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:50:11.360438 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:50:11.360986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.361531 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m11:50:11.362294 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m11:50:11.373171 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.383237 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:50:11.387963 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:50:11.388750 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.389286 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:50:11.389834 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m11:50:11.392967 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:50:11.393450 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m11:50:11.394102 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m11:50:11.394599 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.398856 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:50:11.399698 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.400228 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:50:11.402848 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:50:11.403312 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.403831 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m11:50:11.404500 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:50:11.409524 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m11:50:11.410208 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m11:50:11.410714 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m11:50:11.411227 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.415811 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m11:50:11.416578 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.417100 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m11:50:11.419796 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m11:50:11.420266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:50:11.420933 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m11:50:11.422481 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 11:50:11.261955 => 11:50:11.422310
[0m11:50:11.423030 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:50:11.423905 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m11:50:11.425904 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 11:50:11.319451 => 11:50:11.425635
[0m11:50:11.426713 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:50:11.427304 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m11:50:11.428417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fbaffd0>]}
[0m11:50:11.429938 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 11:50:11.290965 => 11:50:11.429771
[0m11:50:11.430738 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m11:50:11.431251 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m11:50:11.432293 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fa3b8d0>]}
[0m11:50:11.433251 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m11:50:11.434073 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.19s]
[0m11:50:11.435302 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fb64890>]}
[0m11:50:11.436172 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m11:50:11.436808 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.19s]
[0m11:50:11.437499 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m11:50:11.438190 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m11:50:11.439127 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m11:50:11.440330 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m11:50:11.441096 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m11:50:11.445979 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m11:50:11.446988 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 11:50:11.441698 => 11:50:11.446792
[0m11:50:11.447444 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m11:50:11.451532 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m11:50:11.452194 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:50:11.452615 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m11:50:11.453004 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:50:11.457677 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.458185 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:50:11.458600 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m11:50:11.462552 [debug] [Thread-4  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:50:11.466704 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:50:11.467193 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m11:50:11.467931 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.504559 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:50:11.505069 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m11:50:11.505912 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.508295 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:50:11.508819 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:50:11.509227 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m11:50:11.510323 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.512919 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m11:50:11.513359 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m11:50:11.515598 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:50:11.517094 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 11:50:11.447770 => 11:50:11.516941
[0m11:50:11.517540 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m11:50:11.518315 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fbad3d0>]}
[0m11:50:11.518956 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 516[0m in 0.08s]
[0m11:50:11.519525 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m11:50:11.520276 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m11:50:11.520794 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m11:50:11.521426 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m11:50:11.521847 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m11:50:11.524594 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m11:50:11.525312 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 11:50:11.522162 => 11:50:11.525134
[0m11:50:11.525759 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m11:50:11.529869 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m11:50:11.530503 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:50:11.530939 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m11:50:11.531308 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:50:11.535853 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.536409 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:50:11.536853 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m11:50:11.541365 [debug] [Thread-2  ]: SQL status: SELECT 516 in 0.0 seconds
[0m11:50:11.544566 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:50:11.545040 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m11:50:11.545749 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.548497 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:50:11.549060 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m11:50:11.549663 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:50:11.551687 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:50:11.552101 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:50:11.552492 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m11:50:11.556640 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.559319 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m11:50:11.559748 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m11:50:11.562074 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:50:11.563375 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 11:50:11.526079 => 11:50:11.563226
[0m11:50:11.563816 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m11:50:11.564565 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfa03bd-8975-438a-ba4b-bc57e196d85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fb41fd0>]}
[0m11:50:11.565191 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 516[0m in 0.04s]
[0m11:50:11.565778 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m11:50:11.651076 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:11.652383 [debug] [MainThread]: On master: BEGIN
[0m11:50:11.653439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:50:11.665318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:50:11.666551 [debug] [MainThread]: On master: COMMIT
[0m11:50:11.667562 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:11.668512 [debug] [MainThread]: On master: COMMIT
[0m11:50:11.669846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:50:11.670992 [debug] [MainThread]: On master: Close
[0m11:50:11.672480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:11.673365 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m11:50:11.674081 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m11:50:11.674632 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m11:50:11.675216 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m11:50:11.675897 [info ] [MainThread]: 
[0m11:50:11.676535 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:50:11.678079 [debug] [MainThread]: Command end result
[0m11:50:11.683318 [info ] [MainThread]: 
[0m11:50:11.683811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:11.684179 [info ] [MainThread]: 
[0m11:50:11.684522 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:50:11.685044 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:11.684965 after 0.65 seconds
[0m11:50:11.685418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fb787d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fb78910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0e4fb78850>]}
[0m11:50:11.685854 [debug] [MainThread]: Flushing usage events
[0m13:59:17.467221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebc00a8b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfe32f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebc00a8b410>]}


============================== 13:59:17.481918 | 959b8dca-2214-45f0-b0dd-d58ec13eb9b2 ==============================
[0m13:59:17.481918 [info ] [MainThread]: Running with dbt=1.5.11
[0m13:59:17.482489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'debug': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:59:17.535294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfd955450>]}
[0m13:59:17.551614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebc00abca50>]}
[0m13:59:17.552472 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m13:59:17.563895 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m13:59:17.591908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:17.592371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:17.597813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfd943f10>]}
[0m13:59:17.602329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfd9f54d0>]}
[0m13:59:17.602871 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:59:17.603222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfd9f57d0>]}
[0m13:59:17.604488 [info ] [MainThread]: 
[0m13:59:17.605153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:17.606361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m13:59:17.616326 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m13:59:17.616832 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m13:59:17.617168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:17.622893 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:59:17.624765 [debug] [ThreadPool]: On list_finbest: Close
[0m13:59:17.626480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m13:59:17.632658 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m13:59:17.633184 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m13:59:17.633578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:17.638677 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.639295 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m13:59:17.639787 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m13:59:17.643769 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:59:17.645327 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m13:59:17.645921 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m13:59:17.652085 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:17.652658 [debug] [MainThread]: On master: BEGIN
[0m13:59:17.653163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:17.658760 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.659320 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:17.659821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:17.664708 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:59:17.666263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfc56fcd0>]}
[0m13:59:17.666967 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:17.667660 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:17.668188 [debug] [MainThread]: On master: BEGIN
[0m13:59:17.668870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.669399 [debug] [MainThread]: On master: COMMIT
[0m13:59:17.669872 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:17.670314 [debug] [MainThread]: On master: COMMIT
[0m13:59:17.670837 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:17.671243 [debug] [MainThread]: On master: Close
[0m13:59:17.671943 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:17.672317 [info ] [MainThread]: 
[0m13:59:17.677199 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m13:59:17.677760 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m13:59:17.678525 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m13:59:17.678916 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m13:59:17.679548 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m13:59:17.680416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m13:59:17.680987 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m13:59:17.681776 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m13:59:17.682233 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m13:59:17.682943 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m13:59:17.683446 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m13:59:17.689073 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m13:59:17.692348 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m13:59:17.694222 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m13:59:17.695829 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m13:59:17.696692 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 13:59:17.683834 => 13:59:17.696453
[0m13:59:17.697247 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m13:59:17.708637 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 13:59:17.692842 => 13:59:17.708414
[0m13:59:17.709217 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m13:59:17.725651 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 13:59:17.694589 => 13:59:17.725380
[0m13:59:17.736585 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m13:59:17.763647 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m13:59:17.771446 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m13:59:17.775168 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m13:59:17.776232 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:59:17.776948 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:59:17.777867 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:59:17.778319 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m13:59:17.778844 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m13:59:17.779400 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m13:59:17.779867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:59:17.780330 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:59:17.780917 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:59:17.787856 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.788478 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:59:17.789008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.789547 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.790078 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m13:59:17.790590 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:59:17.791038 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:59:17.791558 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m13:59:17.792056 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m13:59:17.795116 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:59:17.795500 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:59:17.795830 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m13:59:17.802391 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:59:17.806344 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:59:17.810046 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:59:17.810622 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m13:59:17.811195 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m13:59:17.811707 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m13:59:17.812781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.813292 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.816119 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:59:17.816624 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.819378 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:59:17.819719 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m13:59:17.822583 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:59:17.823107 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m13:59:17.823841 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m13:59:17.824299 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.830147 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.835797 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.850432 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m13:59:17.852765 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m13:59:17.853737 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m13:59:17.854202 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:59:17.854669 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:59:17.855181 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:59:17.855635 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m13:59:17.856098 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m13:59:17.856667 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m13:59:17.857993 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:59:17.858491 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:59:17.863342 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m13:59:17.865689 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m13:59:17.866128 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:59:17.866575 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m13:59:17.867087 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m13:59:17.869322 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m13:59:17.870053 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m13:59:17.872016 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:17.872471 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:17.874046 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 13:59:17.742196 => 13:59:17.873891
[0m13:59:17.874432 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:17.875781 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 13:59:17.719987 => 13:59:17.875617
[0m13:59:17.876461 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m13:59:17.878017 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 13:59:17.697640 => 13:59:17.877875
[0m13:59:17.878341 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m13:59:17.879365 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfbc28750>]}
[0m13:59:17.879934 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m13:59:17.881228 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfbbec410>]}
[0m13:59:17.881959 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.20s]
[0m13:59:17.882647 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 8[0m in 0.20s]
[0m13:59:17.883421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfc582410>]}
[0m13:59:17.884135 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m13:59:17.884781 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m13:59:17.885418 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.20s]
[0m13:59:17.886824 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m13:59:17.887469 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m13:59:17.888044 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m13:59:17.888912 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m13:59:17.889333 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m13:59:17.892145 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m13:59:17.892838 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 13:59:17.889641 => 13:59:17.892650
[0m13:59:17.893269 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m13:59:17.928573 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m13:59:17.929328 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:59:17.929775 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m13:59:17.930178 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:59:17.935005 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.935610 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:59:17.936085 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m13:59:17.941641 [debug] [Thread-4  ]: SQL status: SELECT 482 in 0.0 seconds
[0m13:59:17.944849 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:59:17.945321 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m13:59:17.946168 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.948904 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:59:17.949335 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m13:59:17.949961 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.952344 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m13:59:17.952826 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:59:17.953230 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m13:59:17.954582 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:59:17.956955 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m13:59:17.957392 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m13:59:17.959418 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:17.960735 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 13:59:17.893579 => 13:59:17.960576
[0m13:59:17.961131 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m13:59:17.962073 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfbc98750>]}
[0m13:59:17.962949 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 482[0m in 0.07s]
[0m13:59:17.963732 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m13:59:17.964479 [debug] [Thread-2  ]: Began running node model.finbest.fact_client_balance
[0m13:59:17.965082 [info ] [Thread-2  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m13:59:17.965709 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.finbest.stg_rates, now model.finbest.fact_client_balance)
[0m13:59:17.966124 [debug] [Thread-2  ]: Began compiling node model.finbest.fact_client_balance
[0m13:59:17.968613 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m13:59:17.969292 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (compile): 13:59:17.966427 => 13:59:17.969096
[0m13:59:17.969725 [debug] [Thread-2  ]: Began executing node model.finbest.fact_client_balance
[0m13:59:17.973707 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m13:59:17.974335 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:59:17.974767 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: BEGIN
[0m13:59:17.975152 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:59:17.979584 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:59:17.980152 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:59:17.980578 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m13:59:17.985602 [debug] [Thread-2  ]: SQL status: SELECT 482 in 0.0 seconds
[0m13:59:17.988867 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:59:17.989346 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m13:59:17.990144 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.992784 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:59:17.993195 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m13:59:17.993840 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:17.995874 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m13:59:17.996283 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:59:17.996669 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: COMMIT
[0m13:59:17.997927 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:59:18.000225 [debug] [Thread-2  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m13:59:18.000640 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m13:59:18.002497 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:18.003908 [debug] [Thread-2  ]: Timing info for model.finbest.fact_client_balance (execute): 13:59:17.970045 => 13:59:18.003746
[0m13:59:18.004327 [debug] [Thread-2  ]: On model.finbest.fact_client_balance: Close
[0m13:59:18.005048 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959b8dca-2214-45f0-b0dd-d58ec13eb9b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfbc3e550>]}
[0m13:59:18.005667 [info ] [Thread-2  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 482[0m in 0.04s]
[0m13:59:18.006254 [debug] [Thread-2  ]: Finished running node model.finbest.fact_client_balance
[0m13:59:18.080907 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:18.082378 [debug] [MainThread]: On master: BEGIN
[0m13:59:18.083557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:18.095531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:18.096914 [debug] [MainThread]: On master: COMMIT
[0m13:59:18.097852 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:18.098715 [debug] [MainThread]: On master: COMMIT
[0m13:59:18.099667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:18.100392 [debug] [MainThread]: On master: Close
[0m13:59:18.101445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:18.102059 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m13:59:18.102627 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m13:59:18.103147 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m13:59:18.103528 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m13:59:18.103992 [info ] [MainThread]: 
[0m13:59:18.104405 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:59:18.105755 [debug] [MainThread]: Command end result
[0m13:59:18.112171 [info ] [MainThread]: 
[0m13:59:18.112672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:18.113037 [info ] [MainThread]: 
[0m13:59:18.113401 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:59:18.113931 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:18.113834 after 0.66 seconds
[0m13:59:18.114325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebc01598e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfd943f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbfbcba910>]}
[0m13:59:18.114733 [debug] [MainThread]: Flushing usage events
[0m17:09:55.111854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcc7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcc7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcc7910>]}


============================== 17:09:55.127798 | fd7e4b3c-6477-46a9-ad4a-5eb73b13479d ==============================
[0m17:09:55.127798 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:09:55.128350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt_project', 'log_path': '/dbt_project/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:09:55.180585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcf5610>]}
[0m17:09:55.195067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcdf690>]}
[0m17:09:55.195894 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:09:55.206155 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:09:55.230100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:55.230565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:55.236051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbc4d7f90>]}
[0m17:09:55.240670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbac72150>]}
[0m17:09:55.241259 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:09:55.241612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbac72e10>]}
[0m17:09:55.242882 [info ] [MainThread]: 
[0m17:09:55.243565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:55.244815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m17:09:55.254586 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m17:09:55.255059 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m17:09:55.255422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:55.261133 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:09:55.262471 [debug] [ThreadPool]: On list_finbest: Close
[0m17:09:55.264291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finbest, now list_finbest_mart)
[0m17:09:55.269952 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m17:09:55.270402 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m17:09:55.270757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:55.275082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.275522 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m17:09:55.275904 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m17:09:55.278886 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:09:55.280006 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m17:09:55.280485 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m17:09:55.285237 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:55.285675 [debug] [MainThread]: On master: BEGIN
[0m17:09:55.286026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:55.290986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.291636 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:55.292234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:55.297299 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:09:55.298754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbac23b50>]}
[0m17:09:55.299402 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:55.300086 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:55.300636 [debug] [MainThread]: On master: BEGIN
[0m17:09:55.301539 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.302099 [debug] [MainThread]: On master: COMMIT
[0m17:09:55.302586 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:55.303044 [debug] [MainThread]: On master: COMMIT
[0m17:09:55.303585 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.304069 [debug] [MainThread]: On master: Close
[0m17:09:55.305195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:55.305933 [info ] [MainThread]: 
[0m17:09:55.311141 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m17:09:55.311748 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m17:09:55.312304 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m17:09:55.313086 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m17:09:55.313674 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m17:09:55.314266 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m17:09:55.315018 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m17:09:55.315817 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.finbest.stg_rates'
[0m17:09:55.316618 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m17:09:55.317116 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m17:09:55.317564 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m17:09:55.317996 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m17:09:55.325077 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m17:09:55.327020 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m17:09:55.328796 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m17:09:55.329646 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 17:09:55.318353 => 17:09:55.329432
[0m17:09:55.330134 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m17:09:55.330676 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 17:09:55.325459 => 17:09:55.330490
[0m17:09:55.336333 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 17:09:55.327483 => 17:09:55.336132
[0m17:09:55.336782 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m17:09:55.348150 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m17:09:55.387128 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m17:09:55.391066 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m17:09:55.393560 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m17:09:55.394674 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:09:55.395182 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:09:55.395661 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m17:09:55.396231 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m17:09:55.396755 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:09:55.397242 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:09:55.397903 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:09:55.398399 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m17:09:55.399218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:09:55.403328 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.404276 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:09:55.404896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.405647 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.406115 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m17:09:55.406657 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:09:55.407344 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:09:55.407929 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m17:09:55.408646 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m17:09:55.411120 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m17:09:55.411674 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.0 seconds
[0m17:09:55.412199 [debug] [Thread-1  ]: SQL status: SELECT 200 in 0.0 seconds
[0m17:09:55.418815 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:09:55.422475 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:09:55.426848 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:09:55.427607 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m17:09:55.428206 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m17:09:55.428786 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m17:09:55.429912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:55.430643 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:55.436268 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:55.468386 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m17:09:55.468917 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m17:09:55.471129 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m17:09:55.471532 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:09:55.472286 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:09:55.472884 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:09:55.473625 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m17:09:55.474133 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m17:09:55.474604 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m17:09:55.476266 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.481534 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m17:09:55.482341 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m17:09:55.483058 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.483550 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.485851 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m17:09:55.486409 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:55.488845 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m17:09:55.489307 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m17:09:55.490822 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 17:09:55.387422 => 17:09:55.490626
[0m17:09:55.491357 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m17:09:55.492076 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m17:09:55.492644 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:55.493695 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cb8f60110>]}
[0m17:09:55.494228 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:55.495659 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 17:09:55.353852 => 17:09:55.495495
[0m17:09:55.496347 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 1000[0m in 0.18s]
[0m17:09:55.497758 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 17:09:55.331009 => 17:09:55.497590
[0m17:09:55.498243 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m17:09:55.498898 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m17:09:55.499321 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m17:09:55.500420 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cb8fc8c90>]}
[0m17:09:55.501455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cb8f97b90>]}
[0m17:09:55.502253 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 4[0m in 0.18s]
[0m17:09:55.502884 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 200[0m in 0.19s]
[0m17:09:55.503488 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m17:09:55.504012 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m17:09:55.504530 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m17:09:55.505399 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m17:09:55.506314 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m17:09:55.506810 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m17:09:55.509655 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m17:09:55.510346 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 17:09:55.507118 => 17:09:55.510151
[0m17:09:55.510773 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m17:09:55.514767 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m17:09:55.515375 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:09:55.515797 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m17:09:55.516170 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:09:55.520597 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.521103 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:09:55.521518 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m17:09:55.526691 [debug] [Thread-4  ]: SQL status: SELECT 491 in 0.0 seconds
[0m17:09:55.529795 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:09:55.530498 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m17:09:55.531421 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:55.534272 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m17:09:55.534858 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:09:55.535377 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m17:09:55.536757 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.540059 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m17:09:55.540501 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m17:09:55.541094 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:55.542332 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 17:09:55.511110 => 17:09:55.542185
[0m17:09:55.542739 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m17:09:55.543459 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cb8efd2d0>]}
[0m17:09:55.544098 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 491[0m in 0.04s]
[0m17:09:55.544637 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m17:09:55.545388 [debug] [Thread-3  ]: Began running node model.finbest.fact_client_balance
[0m17:09:55.546002 [info ] [Thread-3  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m17:09:55.546630 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.finbest.stg_transactions, now model.finbest.fact_client_balance)
[0m17:09:55.547055 [debug] [Thread-3  ]: Began compiling node model.finbest.fact_client_balance
[0m17:09:55.580411 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m17:09:55.581228 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (compile): 17:09:55.547366 => 17:09:55.581005
[0m17:09:55.581648 [debug] [Thread-3  ]: Began executing node model.finbest.fact_client_balance
[0m17:09:55.585391 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m17:09:55.586013 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:09:55.586420 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: BEGIN
[0m17:09:55.586807 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:09:55.591211 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.591730 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:09:55.592160 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m17:09:55.596975 [debug] [Thread-3  ]: SQL status: SELECT 491 in 0.0 seconds
[0m17:09:55.600101 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:09:55.600582 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m17:09:55.601171 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:55.603030 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m17:09:55.603444 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:09:55.603847 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: COMMIT
[0m17:09:55.604885 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.607352 [debug] [Thread-3  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m17:09:55.607852 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m17:09:55.608495 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:09:55.609807 [debug] [Thread-3  ]: Timing info for model.finbest.fact_client_balance (execute): 17:09:55.581987 => 17:09:55.609640
[0m17:09:55.610234 [debug] [Thread-3  ]: On model.finbest.fact_client_balance: Close
[0m17:09:55.610946 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e4b3c-6477-46a9-ad4a-5eb73b13479d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cb8f02190>]}
[0m17:09:55.611608 [info ] [Thread-3  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 491[0m in 0.06s]
[0m17:09:55.612217 [debug] [Thread-3  ]: Finished running node model.finbest.fact_client_balance
[0m17:09:55.713358 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:55.714749 [debug] [MainThread]: On master: BEGIN
[0m17:09:55.715780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:55.728655 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:55.730164 [debug] [MainThread]: On master: COMMIT
[0m17:09:55.731373 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:55.732404 [debug] [MainThread]: On master: COMMIT
[0m17:09:55.733721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:55.734843 [debug] [MainThread]: On master: Close
[0m17:09:55.736540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:55.737394 [debug] [MainThread]: Connection 'model.finbest.stg_clients' was properly closed.
[0m17:09:55.738170 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m17:09:55.738962 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m17:09:55.739746 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m17:09:55.740972 [info ] [MainThread]: 
[0m17:09:55.741719 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m17:09:55.743535 [debug] [MainThread]: Command end result
[0m17:09:55.748120 [info ] [MainThread]: 
[0m17:09:55.748586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:55.748956 [info ] [MainThread]: 
[0m17:09:55.749332 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:09:55.749865 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:55.749774 after 0.65 seconds
[0m17:09:55.750250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcc7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcc76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754cbdcc7fd0>]}
[0m17:09:55.750658 [debug] [MainThread]: Flushing usage events
[0m21:40:01.575105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5895a77070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58964c9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58964c91c0>]}


============================== 21:40:01.591218 | b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0 ==============================
[0m21:40:01.591218 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:40:01.591662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt_project', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:40:01.645513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5893b944f0>]}
[0m21:40:01.663316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5893b26be0>]}
[0m21:40:01.664209 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m21:40:01.673193 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:40:01.699615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:01.700028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:01.705205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d589218c3a0>]}
[0m21:40:01.711246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d589353e550>]}
[0m21:40:01.711802 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:40:01.712107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d589353e520>]}
[0m21:40:01.713293 [info ] [MainThread]: 
[0m21:40:01.713905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:01.715087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest'
[0m21:40:01.724609 [debug] [ThreadPool]: Using postgres connection "list_finbest"
[0m21:40:01.725067 [debug] [ThreadPool]: On list_finbest: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest"} */

    select distinct nspname from pg_namespace
  
[0m21:40:01.725404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:01.739161 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m21:40:01.740387 [debug] [ThreadPool]: On list_finbest: Close
[0m21:40:01.741909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_finbest_mart'
[0m21:40:01.747141 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m21:40:01.747538 [debug] [ThreadPool]: On list_finbest_mart: BEGIN
[0m21:40:01.747850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:01.752472 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:40:01.752894 [debug] [ThreadPool]: Using postgres connection "list_finbest_mart"
[0m21:40:01.753208 [debug] [ThreadPool]: On list_finbest_mart: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "list_finbest_mart"} */
select
      'finbest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'finbest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
[0m21:40:01.763677 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m21:40:01.765195 [debug] [ThreadPool]: On list_finbest_mart: ROLLBACK
[0m21:40:01.765769 [debug] [ThreadPool]: On list_finbest_mart: Close
[0m21:40:01.770758 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.771196 [debug] [MainThread]: On master: BEGIN
[0m21:40:01.771643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:01.776189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:40:01.776605 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.776968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:40:01.785754 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:40:01.786915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58921fed90>]}
[0m21:40:01.787366 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:01.787846 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.788227 [debug] [MainThread]: On master: BEGIN
[0m21:40:01.788726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:40:01.789073 [debug] [MainThread]: On master: COMMIT
[0m21:40:01.789378 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:01.789674 [debug] [MainThread]: On master: COMMIT
[0m21:40:01.790000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:40:01.790300 [debug] [MainThread]: On master: Close
[0m21:40:01.790871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:40:01.791189 [info ] [MainThread]: 
[0m21:40:01.802491 [debug] [Thread-1  ]: Began running node model.finbest.stg_clients
[0m21:40:01.803015 [debug] [Thread-2  ]: Began running node model.finbest.stg_rates
[0m21:40:01.803534 [debug] [Thread-3  ]: Began running node model.finbest.stg_transactions
[0m21:40:01.803944 [info ] [Thread-1  ]: 1 of 5 START sql table model mart.stg_clients .................................. [RUN]
[0m21:40:01.804563 [info ] [Thread-2  ]: 2 of 5 START sql table model mart.stg_rates .................................... [RUN]
[0m21:40:01.805072 [info ] [Thread-3  ]: 3 of 5 START sql table model mart.stg_transactions ............................. [RUN]
[0m21:40:01.805802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_finbest_mart, now model.finbest.stg_clients)
[0m21:40:01.806538 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_finbest, now model.finbest.stg_rates)
[0m21:40:01.807239 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.finbest.stg_transactions'
[0m21:40:01.807707 [debug] [Thread-1  ]: Began compiling node model.finbest.stg_clients
[0m21:40:01.808102 [debug] [Thread-2  ]: Began compiling node model.finbest.stg_rates
[0m21:40:01.808466 [debug] [Thread-3  ]: Began compiling node model.finbest.stg_transactions
[0m21:40:01.814534 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.stg_clients"
[0m21:40:01.815951 [debug] [Thread-2  ]: Writing injected SQL for node "model.finbest.stg_rates"
[0m21:40:01.817627 [debug] [Thread-3  ]: Writing injected SQL for node "model.finbest.stg_transactions"
[0m21:40:01.818482 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (compile): 21:40:01.808751 => 21:40:01.818279
[0m21:40:01.818948 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (compile): 21:40:01.814765 => 21:40:01.818785
[0m21:40:01.819346 [debug] [Thread-1  ]: Began executing node model.finbest.stg_clients
[0m21:40:01.819782 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (compile): 21:40:01.816480 => 21:40:01.819607
[0m21:40:01.820248 [debug] [Thread-2  ]: Began executing node model.finbest.stg_rates
[0m21:40:01.836019 [debug] [Thread-3  ]: Began executing node model.finbest.stg_transactions
[0m21:40:01.869218 [debug] [Thread-2  ]: Writing runtime sql for node "model.finbest.stg_rates"
[0m21:40:01.874302 [debug] [Thread-3  ]: Writing runtime sql for node "model.finbest.stg_transactions"
[0m21:40:01.866713 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.stg_clients"
[0m21:40:01.875642 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m21:40:01.876193 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m21:40:01.876686 [debug] [Thread-2  ]: On model.finbest.stg_rates: BEGIN
[0m21:40:01.877099 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m21:40:01.877472 [debug] [Thread-3  ]: On model.finbest.stg_transactions: BEGIN
[0m21:40:01.877850 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:40:01.878220 [debug] [Thread-1  ]: On model.finbest.stg_clients: BEGIN
[0m21:40:01.878581 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:40:01.879090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:01.883588 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:40:01.884204 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m21:40:01.884705 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */

  
    

  create  table "finbest"."mart"."stg_rates__dbt_tmp"
  
  
    as
  
  (
    select * from staging.currency_rates
  );
  
[0m21:40:01.885135 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m21:40:01.885455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:40:01.885999 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m21:40:01.886406 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m21:40:01.886820 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */

  
    

  create  table "finbest"."mart"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_transactions
  );
  
[0m21:40:01.887308 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */

  
    

  create  table "finbest"."mart"."stg_clients__dbt_tmp"
  
  
    as
  
  (
    select * from raw.masked_clients
  );
  
[0m21:40:01.904956 [debug] [Thread-2  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:40:01.911998 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m21:40:01.912523 [debug] [Thread-1  ]: SQL status: SELECT 1200 in 0.0 seconds
[0m21:40:01.912944 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates" rename to "stg_rates__dbt_backup"
[0m21:40:01.915845 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m21:40:01.916301 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients" rename to "stg_clients__dbt_backup"
[0m21:40:01.917121 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:01.917417 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:01.920712 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m21:40:01.923947 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m21:40:01.924766 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
alter table "finbest"."mart"."stg_rates__dbt_tmp" rename to "stg_rates"
[0m21:40:01.925312 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
alter table "finbest"."mart"."stg_clients__dbt_tmp" rename to "stg_clients"
[0m21:40:01.926101 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:01.926508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:01.937246 [debug] [Thread-3  ]: SQL status: SELECT 4652 in 0.0 seconds
[0m21:40:01.947204 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m21:40:01.949376 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m21:40:01.953138 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m21:40:01.953860 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m21:40:01.954374 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m21:40:01.954840 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m21:40:01.955301 [debug] [Thread-2  ]: On model.finbest.stg_rates: COMMIT
[0m21:40:01.955820 [debug] [Thread-1  ]: On model.finbest.stg_clients: COMMIT
[0m21:40:01.956775 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:01.960346 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m21:40:01.960945 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m21:40:01.961526 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:40:01.961924 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
alter table "finbest"."mart"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:40:01.966423 [debug] [Thread-2  ]: Using postgres connection "model.finbest.stg_rates"
[0m21:40:01.968862 [debug] [Thread-1  ]: Using postgres connection "model.finbest.stg_clients"
[0m21:40:01.969365 [debug] [Thread-2  ]: On model.finbest.stg_rates: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_rates"} */
drop table if exists "finbest"."mart"."stg_rates__dbt_backup" cascade
[0m21:40:01.969789 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:01.970152 [debug] [Thread-1  ]: On model.finbest.stg_clients: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_clients"} */
drop table if exists "finbest"."mart"."stg_clients__dbt_backup" cascade
[0m21:40:01.973503 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m21:40:01.974345 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m21:40:01.974870 [debug] [Thread-3  ]: On model.finbest.stg_transactions: COMMIT
[0m21:40:01.975375 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:40:01.976760 [debug] [Thread-2  ]: Timing info for model.finbest.stg_rates (execute): 21:40:01.846666 => 21:40:01.976589
[0m21:40:01.977153 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m21:40:01.977565 [debug] [Thread-2  ]: On model.finbest.stg_rates: Close
[0m21:40:01.977944 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:40:01.980282 [debug] [Thread-3  ]: Using postgres connection "model.finbest.stg_transactions"
[0m21:40:01.981909 [debug] [Thread-1  ]: Timing info for model.finbest.stg_clients (execute): 21:40:01.820627 => 21:40:01.981737
[0m21:40:01.982744 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5891034070>]}
[0m21:40:01.983201 [debug] [Thread-3  ]: On model.finbest.stg_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.stg_transactions"} */
drop table if exists "finbest"."mart"."stg_transactions__dbt_backup" cascade
[0m21:40:01.983725 [debug] [Thread-1  ]: On model.finbest.stg_clients: Close
[0m21:40:01.984303 [info ] [Thread-2  ]: 2 of 5 OK created sql table model mart.stg_rates ............................... [[32mSELECT 16[0m in 0.18s]
[0m21:40:01.984988 [debug] [Thread-2  ]: Finished running node model.finbest.stg_rates
[0m21:40:01.985604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5891018130>]}
[0m21:40:01.986623 [info ] [Thread-1  ]: 1 of 5 OK created sql table model mart.stg_clients ............................. [[32mSELECT 1200[0m in 0.18s]
[0m21:40:01.987622 [debug] [Thread-1  ]: Finished running node model.finbest.stg_clients
[0m21:40:01.988096 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:40:01.990191 [debug] [Thread-3  ]: Timing info for model.finbest.stg_transactions (execute): 21:40:01.869705 => 21:40:01.989989
[0m21:40:01.990731 [debug] [Thread-3  ]: On model.finbest.stg_transactions: Close
[0m21:40:01.991472 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58910100d0>]}
[0m21:40:01.992044 [info ] [Thread-3  ]: 3 of 5 OK created sql table model mart.stg_transactions ........................ [[32mSELECT 4652[0m in 0.18s]
[0m21:40:01.992552 [debug] [Thread-3  ]: Finished running node model.finbest.stg_transactions
[0m21:40:01.993244 [debug] [Thread-4  ]: Began running node model.finbest.int_daily_transactions
[0m21:40:01.993834 [info ] [Thread-4  ]: 4 of 5 START sql table model mart.int_daily_transactions ....................... [RUN]
[0m21:40:01.994535 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.finbest.int_daily_transactions'
[0m21:40:01.994917 [debug] [Thread-4  ]: Began compiling node model.finbest.int_daily_transactions
[0m21:40:01.997530 [debug] [Thread-4  ]: Writing injected SQL for node "model.finbest.int_daily_transactions"
[0m21:40:01.998207 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (compile): 21:40:01.995188 => 21:40:01.998008
[0m21:40:01.998590 [debug] [Thread-4  ]: Began executing node model.finbest.int_daily_transactions
[0m21:40:02.002231 [debug] [Thread-4  ]: Writing runtime sql for node "model.finbest.int_daily_transactions"
[0m21:40:02.002898 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m21:40:02.003318 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: BEGIN
[0m21:40:02.003805 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:40:02.008751 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m21:40:02.009310 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m21:40:02.009742 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */

  
    

  create  table "finbest"."mart"."int_daily_transactions__dbt_tmp"
  
  
    as
  
  (
    with t as (
  select date(datetime) as dt, client_id, currency,
         sum(case when transaction_type='deposit' then amount end) as inflow,
         sum(case when transaction_type='withdrawal' then amount end) as outflow,
         count(*) as tx_cnt
  from "finbest"."mart"."stg_transactions"
  group by 1,2,3)
select *, inflow-outflow as net_flow from t
  );
  
[0m21:40:02.021817 [debug] [Thread-4  ]: SQL status: SELECT 3509 in 0.0 seconds
[0m21:40:02.025585 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m21:40:02.026086 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions" rename to "int_daily_transactions__dbt_backup"
[0m21:40:02.027113 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:02.029684 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m21:40:02.030151 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
alter table "finbest"."mart"."int_daily_transactions__dbt_tmp" rename to "int_daily_transactions"
[0m21:40:02.030826 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:02.032715 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m21:40:02.033127 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m21:40:02.033497 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: COMMIT
[0m21:40:02.034847 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m21:40:02.038518 [debug] [Thread-4  ]: Using postgres connection "model.finbest.int_daily_transactions"
[0m21:40:02.039131 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.int_daily_transactions"} */
drop table if exists "finbest"."mart"."int_daily_transactions__dbt_backup" cascade
[0m21:40:02.041894 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:40:02.043266 [debug] [Thread-4  ]: Timing info for model.finbest.int_daily_transactions (execute): 21:40:01.998856 => 21:40:02.043116
[0m21:40:02.043708 [debug] [Thread-4  ]: On model.finbest.int_daily_transactions: Close
[0m21:40:02.044374 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58910df790>]}
[0m21:40:02.045013 [info ] [Thread-4  ]: 4 of 5 OK created sql table model mart.int_daily_transactions .................. [[32mSELECT 3509[0m in 0.05s]
[0m21:40:02.045575 [debug] [Thread-4  ]: Finished running node model.finbest.int_daily_transactions
[0m21:40:02.046423 [debug] [Thread-1  ]: Began running node model.finbest.fact_client_balance
[0m21:40:02.047011 [info ] [Thread-1  ]: 5 of 5 START sql table model mart.fact_client_balance .......................... [RUN]
[0m21:40:02.047565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.finbest.stg_clients, now model.finbest.fact_client_balance)
[0m21:40:02.047916 [debug] [Thread-1  ]: Began compiling node model.finbest.fact_client_balance
[0m21:40:02.050283 [debug] [Thread-1  ]: Writing injected SQL for node "model.finbest.fact_client_balance"
[0m21:40:02.051114 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (compile): 21:40:02.048162 => 21:40:02.050868
[0m21:40:02.051529 [debug] [Thread-1  ]: Began executing node model.finbest.fact_client_balance
[0m21:40:02.055402 [debug] [Thread-1  ]: Writing runtime sql for node "model.finbest.fact_client_balance"
[0m21:40:02.056352 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m21:40:02.056835 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: BEGIN
[0m21:40:02.057165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:02.061747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:40:02.062225 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m21:40:02.062594 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */

  
    

  create  table "finbest"."mart"."fact_client_balance__dbt_tmp"
  
  
    as
  
  (
    select dt as date, client_id, currency,
       sum(net_flow) over (partition by client_id,currency
                           order by dt
                           rows between unbounded preceding and 1 preceding) as opening_balance,
       sum(net_flow) over (partition by client_id,currency
                           order by dt) as closing_balance,
       inflow,outflow,tx_cnt as transaction_count
from "finbest"."mart"."int_daily_transactions"
  );
  
[0m21:40:02.078234 [debug] [Thread-1  ]: SQL status: SELECT 3509 in 0.0 seconds
[0m21:40:02.081248 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m21:40:02.081670 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance" rename to "fact_client_balance__dbt_backup"
[0m21:40:02.082357 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:02.085327 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m21:40:02.085726 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
alter table "finbest"."mart"."fact_client_balance__dbt_tmp" rename to "fact_client_balance"
[0m21:40:02.086300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:40:02.088155 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m21:40:02.088545 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m21:40:02.088903 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: COMMIT
[0m21:40:02.090365 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:40:02.092776 [debug] [Thread-1  ]: Using postgres connection "model.finbest.fact_client_balance"
[0m21:40:02.093158 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "finbest", "target_name": "dev", "node_id": "model.finbest.fact_client_balance"} */
drop table if exists "finbest"."mart"."fact_client_balance__dbt_backup" cascade
[0m21:40:02.095120 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:40:02.096437 [debug] [Thread-1  ]: Timing info for model.finbest.fact_client_balance (execute): 21:40:02.051799 => 21:40:02.096273
[0m21:40:02.096819 [debug] [Thread-1  ]: On model.finbest.fact_client_balance: Close
[0m21:40:02.097452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78ff990-b2ea-4d8d-97f5-4c0c0ae106f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d589100d550>]}
[0m21:40:02.098020 [info ] [Thread-1  ]: 5 of 5 OK created sql table model mart.fact_client_balance ..................... [[32mSELECT 3509[0m in 0.05s]
[0m21:40:02.098523 [debug] [Thread-1  ]: Finished running node model.finbest.fact_client_balance
[0m21:40:02.099714 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:02.100187 [debug] [MainThread]: On master: BEGIN
[0m21:40:02.100584 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:02.106210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:40:02.106716 [debug] [MainThread]: On master: COMMIT
[0m21:40:02.107066 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:02.107408 [debug] [MainThread]: On master: COMMIT
[0m21:40:02.107815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:40:02.108145 [debug] [MainThread]: On master: Close
[0m21:40:02.108728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:02.109041 [debug] [MainThread]: Connection 'model.finbest.stg_rates' was properly closed.
[0m21:40:02.109333 [debug] [MainThread]: Connection 'model.finbest.fact_client_balance' was properly closed.
[0m21:40:02.109624 [debug] [MainThread]: Connection 'model.finbest.stg_transactions' was properly closed.
[0m21:40:02.109909 [debug] [MainThread]: Connection 'model.finbest.int_daily_transactions' was properly closed.
[0m21:40:02.110254 [info ] [MainThread]: 
[0m21:40:02.110548 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m21:40:02.111604 [debug] [MainThread]: Command end result
[0m21:40:02.116453 [info ] [MainThread]: 
[0m21:40:02.116904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:02.117212 [info ] [MainThread]: 
[0m21:40:02.117582 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:40:02.118232 [debug] [MainThread]: Command `dbt run` succeeded at 21:40:02.118141 after 0.55 seconds
[0m21:40:02.118640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5895a77070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5893b26be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5891131640>]}
[0m21:40:02.119071 [debug] [MainThread]: Flushing usage events
